{"ast":null,"code":"import { css, cx } from '@emotion/css';\nimport React, { useCallback, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { useStyles2 } from '../../themes';\nimport { getFocusStyles } from '../../themes/mixins';\nimport { trimFileName } from '../../utils/file';\nimport { getButtonStyles } from '../Button';\nimport { Icon } from '../index';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport const FileUpload = ({\n  onFileUpload,\n  className,\n  children = 'Upload file',\n  accept = '*',\n  size = 'md'\n}) => {\n  const style = useStyles2(getStyles(size));\n  const [fileName, setFileName] = useState('');\n  const id = uuidv4();\n  const onChange = useCallback(event => {\n    var _event$currentTarget, _event$currentTarget$;\n\n    const file = (_event$currentTarget = event.currentTarget) === null || _event$currentTarget === void 0 ? void 0 : (_event$currentTarget$ = _event$currentTarget.files) === null || _event$currentTarget$ === void 0 ? void 0 : _event$currentTarget$[0];\n\n    if (file) {\n      var _file$name;\n\n      setFileName((_file$name = file.name) !== null && _file$name !== void 0 ? _file$name : '');\n    }\n\n    onFileUpload(event);\n  }, [onFileUpload]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(\"input\", {\n      type: \"file\",\n      id: id,\n      className: style.fileUpload,\n      onChange: onChange,\n      multiple: false,\n      accept: accept,\n      \"data-testid\": selectors.components.FileUpload.inputField\n    }), /*#__PURE__*/_jsxs(\"label\", {\n      role: \"button\",\n      htmlFor: id,\n      className: cx(style.labelWrapper, className),\n      children: [/*#__PURE__*/_jsx(Icon, {\n        name: \"upload\",\n        className: style.icon\n      }), children]\n    }), fileName && /*#__PURE__*/_jsx(\"span\", {\n      \"aria-label\": \"File name\",\n      className: style.fileName,\n      \"data-testid\": selectors.components.FileUpload.fileNameSpan,\n      children: trimFileName(fileName)\n    })]\n  });\n};\n\nconst getStyles = size => theme => {\n  const buttonStyles = getButtonStyles({\n    theme,\n    variant: 'primary',\n    size,\n    iconOnly: false\n  });\n  const focusStyle = getFocusStyles(theme);\n  return {\n    fileUpload: css({\n      height: '0.1px',\n      opacity: '0',\n      overflow: 'hidden',\n      position: 'absolute',\n      width: '0.1px',\n      zIndex: -1,\n      '&:focus + label': focusStyle,\n      '&:focus-visible + label': focusStyle\n    }),\n    labelWrapper: buttonStyles.button,\n    icon: buttonStyles.icon,\n    fileName: css({\n      marginLeft: theme.spacing(0.5)\n    })\n  };\n};","map":{"version":3,"names":["css","cx","React","useCallback","useState","v4","uuidv4","selectors","useStyles2","getFocusStyles","trimFileName","getButtonStyles","Icon","FileUpload","onFileUpload","className","children","accept","size","style","getStyles","fileName","setFileName","id","onChange","event","file","currentTarget","files","name","fileUpload","components","inputField","labelWrapper","icon","fileNameSpan","theme","buttonStyles","variant","iconOnly","focusStyle","height","opacity","overflow","position","width","zIndex","button","marginLeft","spacing"],"sources":["/home/soula/grafana/packages/grafana-ui/src/components/FileUpload/FileUpload.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport React, { FC, FormEvent, useCallback, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\n\nimport { useStyles2 } from '../../themes';\nimport { getFocusStyles } from '../../themes/mixins';\nimport { ComponentSize } from '../../types/size';\nimport { trimFileName } from '../../utils/file';\nimport { getButtonStyles } from '../Button';\nimport { Icon } from '../index';\n\nexport interface Props {\n  /** Callback function to handle uploaded file  */\n  onFileUpload: (event: FormEvent<HTMLInputElement>) => void;\n  /** Accepted file extensions */\n  accept?: string;\n  /** Overwrite or add to style */\n  className?: string;\n  /** Button size */\n  size?: ComponentSize;\n}\n\nexport const FileUpload: FC<Props> = ({\n  onFileUpload,\n  className,\n  children = 'Upload file',\n  accept = '*',\n  size = 'md',\n}) => {\n  const style = useStyles2(getStyles(size));\n  const [fileName, setFileName] = useState('');\n  const id = uuidv4();\n\n  const onChange = useCallback(\n    (event: FormEvent<HTMLInputElement>) => {\n      const file = event.currentTarget?.files?.[0];\n      if (file) {\n        setFileName(file.name ?? '');\n      }\n      onFileUpload(event);\n    },\n    [onFileUpload]\n  );\n\n  return (\n    <>\n      <input\n        type=\"file\"\n        id={id}\n        className={style.fileUpload}\n        onChange={onChange}\n        multiple={false}\n        accept={accept}\n        data-testid={selectors.components.FileUpload.inputField}\n      />\n      <label role=\"button\" htmlFor={id} className={cx(style.labelWrapper, className)}>\n        <Icon name=\"upload\" className={style.icon} />\n        {children}\n      </label>\n\n      {fileName && (\n        <span\n          aria-label=\"File name\"\n          className={style.fileName}\n          data-testid={selectors.components.FileUpload.fileNameSpan}\n        >\n          {trimFileName(fileName)}\n        </span>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (size: ComponentSize) => (theme: GrafanaTheme2) => {\n  const buttonStyles = getButtonStyles({ theme, variant: 'primary', size, iconOnly: false });\n  const focusStyle = getFocusStyles(theme);\n\n  return {\n    fileUpload: css({\n      height: '0.1px',\n      opacity: '0',\n      overflow: 'hidden',\n      position: 'absolute',\n      width: '0.1px',\n      zIndex: -1,\n      '&:focus + label': focusStyle,\n      '&:focus-visible + label': focusStyle,\n    }),\n    labelWrapper: buttonStyles.button,\n    icon: buttonStyles.icon,\n    fileName: css({\n      marginLeft: theme.spacing(0.5),\n    }),\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}