{"ast":null,"code":"import React, { useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport { Button, useStyles2 } from '@grafana/ui';\nimport { ActionIcon } from '../../../rules/ActionIcon';\nimport { OptionField } from './OptionField';\nimport { getReceiverFormFieldStyles } from './styles';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const SubformField = ({\n  option,\n  pathPrefix,\n  errors,\n  defaultValue,\n  readOnly = false\n}) => {\n  var _option$subformOption;\n\n  const styles = useStyles2(getReceiverFormFieldStyles);\n  const name = `${pathPrefix}${option.propertyName}`;\n  const {\n    watch\n  } = useFormContext();\n\n  const _watchValue = watch(name);\n\n  const value = _watchValue === undefined ? defaultValue : _watchValue;\n  const [show, setShow] = useState(!!value);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.wrapper,\n    \"data-testid\": `${name}.container`,\n    children: [/*#__PURE__*/_jsx(\"h6\", {\n      children: option.label\n    }), option.description && /*#__PURE__*/_jsx(\"p\", {\n      className: styles.description,\n      children: option.description\n    }), show && /*#__PURE__*/_jsxs(_Fragment, {\n      children: [!readOnly && /*#__PURE__*/_jsx(ActionIcon, {\n        \"data-testid\": `${name}.delete-button`,\n        icon: \"trash-alt\",\n        tooltip: \"delete\",\n        onClick: () => setShow(false),\n        className: styles.deleteIcon\n      }), ((_option$subformOption = option.subformOptions) !== null && _option$subformOption !== void 0 ? _option$subformOption : []).map(subOption => {\n        return /*#__PURE__*/_jsx(OptionField, {\n          readOnly: readOnly,\n          defaultValue: defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue[subOption.propertyName],\n          option: subOption,\n          pathPrefix: `${name}.`,\n          error: errors === null || errors === void 0 ? void 0 : errors[subOption.propertyName]\n        }, subOption.propertyName);\n      })]\n    }), !show && !readOnly && /*#__PURE__*/_jsx(Button, {\n      className: styles.addButton,\n      type: \"button\",\n      variant: \"secondary\",\n      icon: \"plus\",\n      size: \"sm\",\n      onClick: () => setShow(true),\n      \"data-testid\": `${name}.add-button`,\n      children: \"Add\"\n    })]\n  });\n};","map":{"version":3,"names":["React","useState","useFormContext","Button","useStyles2","ActionIcon","OptionField","getReceiverFormFieldStyles","SubformField","option","pathPrefix","errors","defaultValue","readOnly","styles","name","propertyName","watch","_watchValue","value","undefined","show","setShow","wrapper","label","description","deleteIcon","subformOptions","map","subOption","addButton"],"sources":["/home/soula/grafana/public/app/features/alerting/unified/components/receivers/form/fields/SubformField.tsx"],"sourcesContent":["import React, { FC, useState } from 'react';\nimport { FieldError, DeepMap, useFormContext } from 'react-hook-form';\n\nimport { Button, useStyles2 } from '@grafana/ui';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\nimport { OptionField } from './OptionField';\nimport { getReceiverFormFieldStyles } from './styles';\n\ninterface Props {\n  defaultValue: any;\n  option: NotificationChannelOption;\n  pathPrefix: string;\n  errors?: DeepMap<any, FieldError>;\n  readOnly?: boolean;\n}\n\nexport const SubformField: FC<Props> = ({ option, pathPrefix, errors, defaultValue, readOnly = false }) => {\n  const styles = useStyles2(getReceiverFormFieldStyles);\n  const name = `${pathPrefix}${option.propertyName}`;\n  const { watch } = useFormContext();\n  const _watchValue = watch(name);\n  const value = _watchValue === undefined ? defaultValue : _watchValue;\n\n  const [show, setShow] = useState(!!value);\n\n  return (\n    <div className={styles.wrapper} data-testid={`${name}.container`}>\n      <h6>{option.label}</h6>\n      {option.description && <p className={styles.description}>{option.description}</p>}\n      {show && (\n        <>\n          {!readOnly && (\n            <ActionIcon\n              data-testid={`${name}.delete-button`}\n              icon=\"trash-alt\"\n              tooltip=\"delete\"\n              onClick={() => setShow(false)}\n              className={styles.deleteIcon}\n            />\n          )}\n          {(option.subformOptions ?? []).map((subOption) => {\n            return (\n              <OptionField\n                readOnly={readOnly}\n                defaultValue={defaultValue?.[subOption.propertyName]}\n                key={subOption.propertyName}\n                option={subOption}\n                pathPrefix={`${name}.`}\n                error={errors?.[subOption.propertyName]}\n              />\n            );\n          })}\n        </>\n      )}\n      {!show && !readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => setShow(true)}\n          data-testid={`${name}.add-button`}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n"],"mappings":"AAAA,OAAOA,KAAP,IAAoBC,QAApB,QAAoC,OAApC;AACA,SAA8BC,cAA9B,QAAoD,iBAApD;AAEA,SAASC,MAAT,EAAiBC,UAAjB,QAAmC,aAAnC;AAGA,SAASC,UAAT,QAA2B,2BAA3B;AAEA,SAASC,WAAT,QAA4B,eAA5B;AACA,SAASC,0BAAT,QAA2C,UAA3C;;;;AAUA,OAAO,MAAMC,YAAuB,GAAG,CAAC;EAAEC,MAAF;EAAUC,UAAV;EAAsBC,MAAtB;EAA8BC,YAA9B;EAA4CC,QAAQ,GAAG;AAAvD,CAAD,KAAoE;EAAA;;EACzG,MAAMC,MAAM,GAAGV,UAAU,CAACG,0BAAD,CAAzB;EACA,MAAMQ,IAAI,GAAI,GAAEL,UAAW,GAAED,MAAM,CAACO,YAAa,EAAjD;EACA,MAAM;IAAEC;EAAF,IAAYf,cAAc,EAAhC;;EACA,MAAMgB,WAAW,GAAGD,KAAK,CAACF,IAAD,CAAzB;;EACA,MAAMI,KAAK,GAAGD,WAAW,KAAKE,SAAhB,GAA4BR,YAA5B,GAA2CM,WAAzD;EAEA,MAAM,CAACG,IAAD,EAAOC,OAAP,IAAkBrB,QAAQ,CAAC,CAAC,CAACkB,KAAH,CAAhC;EAEA,oBACE;IAAK,SAAS,EAAEL,MAAM,CAACS,OAAvB;IAAgC,eAAc,GAAER,IAAK,YAArD;IAAA,wBACE;MAAA,UAAKN,MAAM,CAACe;IAAZ,EADF,EAEGf,MAAM,CAACgB,WAAP,iBAAsB;MAAG,SAAS,EAAEX,MAAM,CAACW,WAArB;MAAA,UAAmChB,MAAM,CAACgB;IAA1C,EAFzB,EAGGJ,IAAI,iBACH;MAAA,WACG,CAACR,QAAD,iBACC,KAAC,UAAD;QACE,eAAc,GAAEE,IAAK,gBADvB;QAEE,IAAI,EAAC,WAFP;QAGE,OAAO,EAAC,QAHV;QAIE,OAAO,EAAE,MAAMO,OAAO,CAAC,KAAD,CAJxB;QAKE,SAAS,EAAER,MAAM,CAACY;MALpB,EAFJ,EAUG,0BAACjB,MAAM,CAACkB,cAAR,yEAA0B,EAA1B,EAA8BC,GAA9B,CAAmCC,SAAD,IAAe;QAChD,oBACE,KAAC,WAAD;UACE,QAAQ,EAAEhB,QADZ;UAEE,YAAY,EAAED,YAAF,aAAEA,YAAF,uBAAEA,YAAY,CAAGiB,SAAS,CAACb,YAAb,CAF5B;UAIE,MAAM,EAAEa,SAJV;UAKE,UAAU,EAAG,GAAEd,IAAK,GALtB;UAME,KAAK,EAAEJ,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAGkB,SAAS,CAACb,YAAb;QANf,GAGOa,SAAS,CAACb,YAHjB,CADF;MAUD,CAXA,CAVH;IAAA,EAJJ,EA4BG,CAACK,IAAD,IAAS,CAACR,QAAV,iBACC,KAAC,MAAD;MACE,SAAS,EAAEC,MAAM,CAACgB,SADpB;MAEE,IAAI,EAAC,QAFP;MAGE,OAAO,EAAC,WAHV;MAIE,IAAI,EAAC,MAJP;MAKE,IAAI,EAAC,IALP;MAME,OAAO,EAAE,MAAMR,OAAO,CAAC,IAAD,CANxB;MAOE,eAAc,GAAEP,IAAK,aAPvB;MAAA;IAAA,EA7BJ;EAAA,EADF;AA4CD,CArDM"},"metadata":{},"sourceType":"module"}