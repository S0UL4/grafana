{"ast":null,"code":"popoverSrv.$inject = [\"$compile\", \"$rootScope\", \"$timeout\"];\nimport { extend } from 'lodash'; // @ts-ignore\n\nimport Drop from 'tether-drop';\nimport coreModule from 'app/angular/core_module';\n/** @ngInject */\n\nfunction popoverSrv($compile, $rootScope, $timeout) {\n  let openDrop = null;\n\n  this.close = () => {\n    if (openDrop) {\n      openDrop.close();\n    }\n  };\n\n  this.show = options => {\n    if (openDrop) {\n      openDrop.close();\n      openDrop = null;\n    }\n\n    const scope = extend($rootScope.$new(true), options.model);\n    let drop;\n\n    const cleanUp = () => {\n      setTimeout(() => {\n        scope.$destroy();\n\n        if (drop.tether) {\n          drop.destroy();\n        }\n\n        if (options.onClose) {\n          options.onClose();\n        }\n      });\n      openDrop = null;\n    };\n\n    scope.dismiss = () => {\n      drop.close();\n    };\n\n    const contentElement = document.createElement('div');\n    contentElement.innerHTML = options.template;\n    $compile(contentElement)(scope);\n    $timeout(() => {\n      drop = new Drop({\n        target: options.element,\n        content: contentElement,\n        position: options.position,\n        classes: options.classNames || 'drop-popover',\n        openOn: options.openOn,\n        hoverCloseDelay: 200,\n        tetherOptions: {\n          constraints: [{\n            to: 'scrollParent',\n            attachment: 'together'\n          }]\n        }\n      });\n      drop.on('close', () => {\n        cleanUp();\n      });\n      openDrop = drop;\n      openDrop.open();\n    }, 100); // return close function\n\n    return () => {\n      if (drop) {\n        drop.close();\n      }\n    };\n  };\n}\n\ncoreModule.service('popoverSrv', popoverSrv);","map":{"version":3,"names":["extend","Drop","coreModule","popoverSrv","$compile","$rootScope","$timeout","openDrop","close","show","options","scope","$new","model","drop","cleanUp","setTimeout","$destroy","tether","destroy","onClose","dismiss","contentElement","document","createElement","innerHTML","template","target","element","content","position","classes","classNames","openOn","hoverCloseDelay","tetherOptions","constraints","to","attachment","on","open","service"],"sources":["/home/soula/grafana/public/app/angular/services/popover_srv.ts"],"sourcesContent":["import { extend } from 'lodash';\n// @ts-ignore\nimport Drop from 'tether-drop';\n\nimport { GrafanaRootScope } from 'app/angular/GrafanaCtrl';\nimport coreModule from 'app/angular/core_module';\n\n/** @ngInject */\nfunction popoverSrv(this: any, $compile: any, $rootScope: GrafanaRootScope, $timeout: any) {\n  let openDrop: any = null;\n\n  this.close = () => {\n    if (openDrop) {\n      openDrop.close();\n    }\n  };\n\n  this.show = (options: any) => {\n    if (openDrop) {\n      openDrop.close();\n      openDrop = null;\n    }\n\n    const scope = extend($rootScope.$new(true), options.model);\n    let drop: any;\n\n    const cleanUp = () => {\n      setTimeout(() => {\n        scope.$destroy();\n\n        if (drop.tether) {\n          drop.destroy();\n        }\n\n        if (options.onClose) {\n          options.onClose();\n        }\n      });\n\n      openDrop = null;\n    };\n\n    scope.dismiss = () => {\n      drop.close();\n    };\n\n    const contentElement = document.createElement('div');\n    contentElement.innerHTML = options.template;\n\n    $compile(contentElement)(scope);\n\n    $timeout(() => {\n      drop = new Drop({\n        target: options.element,\n        content: contentElement,\n        position: options.position,\n        classes: options.classNames || 'drop-popover',\n        openOn: options.openOn,\n        hoverCloseDelay: 200,\n        tetherOptions: {\n          constraints: [{ to: 'scrollParent', attachment: 'together' }],\n        },\n      });\n\n      drop.on('close', () => {\n        cleanUp();\n      });\n\n      openDrop = drop;\n      openDrop.open();\n    }, 100);\n\n    // return close function\n    return () => {\n      if (drop) {\n        drop.close();\n      }\n    };\n  };\n}\n\ncoreModule.service('popoverSrv', popoverSrv);\n"],"mappings":";AAAA,SAASA,MAAT,QAAuB,QAAvB,C,CACA;;AACA,OAAOC,IAAP,MAAiB,aAAjB;AAGA,OAAOC,UAAP,MAAuB,yBAAvB;AAEA;;AACA,SAASC,UAAT,CAA+BC,QAA/B,EAA8CC,UAA9C,EAA4EC,QAA5E,EAA2F;EACzF,IAAIC,QAAa,GAAG,IAApB;;EAEA,KAAKC,KAAL,GAAa,MAAM;IACjB,IAAID,QAAJ,EAAc;MACZA,QAAQ,CAACC,KAAT;IACD;EACF,CAJD;;EAMA,KAAKC,IAAL,GAAaC,OAAD,IAAkB;IAC5B,IAAIH,QAAJ,EAAc;MACZA,QAAQ,CAACC,KAAT;MACAD,QAAQ,GAAG,IAAX;IACD;;IAED,MAAMI,KAAK,GAAGX,MAAM,CAACK,UAAU,CAACO,IAAX,CAAgB,IAAhB,CAAD,EAAwBF,OAAO,CAACG,KAAhC,CAApB;IACA,IAAIC,IAAJ;;IAEA,MAAMC,OAAO,GAAG,MAAM;MACpBC,UAAU,CAAC,MAAM;QACfL,KAAK,CAACM,QAAN;;QAEA,IAAIH,IAAI,CAACI,MAAT,EAAiB;UACfJ,IAAI,CAACK,OAAL;QACD;;QAED,IAAIT,OAAO,CAACU,OAAZ,EAAqB;UACnBV,OAAO,CAACU,OAAR;QACD;MACF,CAVS,CAAV;MAYAb,QAAQ,GAAG,IAAX;IACD,CAdD;;IAgBAI,KAAK,CAACU,OAAN,GAAgB,MAAM;MACpBP,IAAI,CAACN,KAAL;IACD,CAFD;;IAIA,MAAMc,cAAc,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAvB;IACAF,cAAc,CAACG,SAAf,GAA2Bf,OAAO,CAACgB,QAAnC;IAEAtB,QAAQ,CAACkB,cAAD,CAAR,CAAyBX,KAAzB;IAEAL,QAAQ,CAAC,MAAM;MACbQ,IAAI,GAAG,IAAIb,IAAJ,CAAS;QACd0B,MAAM,EAAEjB,OAAO,CAACkB,OADF;QAEdC,OAAO,EAAEP,cAFK;QAGdQ,QAAQ,EAAEpB,OAAO,CAACoB,QAHJ;QAIdC,OAAO,EAAErB,OAAO,CAACsB,UAAR,IAAsB,cAJjB;QAKdC,MAAM,EAAEvB,OAAO,CAACuB,MALF;QAMdC,eAAe,EAAE,GANH;QAOdC,aAAa,EAAE;UACbC,WAAW,EAAE,CAAC;YAAEC,EAAE,EAAE,cAAN;YAAsBC,UAAU,EAAE;UAAlC,CAAD;QADA;MAPD,CAAT,CAAP;MAYAxB,IAAI,CAACyB,EAAL,CAAQ,OAAR,EAAiB,MAAM;QACrBxB,OAAO;MACR,CAFD;MAIAR,QAAQ,GAAGO,IAAX;MACAP,QAAQ,CAACiC,IAAT;IACD,CAnBO,EAmBL,GAnBK,CAAR,CAlC4B,CAuD5B;;IACA,OAAO,MAAM;MACX,IAAI1B,IAAJ,EAAU;QACRA,IAAI,CAACN,KAAL;MACD;IACF,CAJD;EAKD,CA7DD;AA8DD;;AAEDN,UAAU,CAACuC,OAAX,CAAmB,YAAnB,EAAiCtC,UAAjC"},"metadata":{},"sourceType":"module"}