{"ast":null,"code":"var _h, _div, _p, _p2;\n\nimport { css } from '@emotion/css';\nimport pluralize from 'pluralize';\nimport React, { useMemo } from 'react';\nimport { LoadingPlaceholder, Pagination, useStyles2 } from '@grafana/ui';\nimport { DEFAULT_PER_PAGE_PAGINATION } from '../../../../../core/constants';\nimport { usePagination } from '../../hooks/usePagination';\nimport { useUnifiedAlertingSelector } from '../../hooks/useUnifiedAlertingSelector';\nimport { getPaginationStyles } from '../../styles/pagination';\nimport { getRulesDataSources, getRulesSourceUid } from '../../utils/datasource';\nimport { RulesGroup } from './RulesGroup';\nimport { useCombinedGroupNamespace } from './useCombinedGroupNamespace';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const CloudRules = ({\n  namespaces,\n  expandAll\n}) => {\n  const styles = useStyles2(getStyles);\n  const rules = useUnifiedAlertingSelector(state => state.promRules);\n  const rulesDataSources = useMemo(getRulesDataSources, []);\n  const groupsWithNamespaces = useCombinedGroupNamespace(namespaces);\n  const dataSourcesLoading = useMemo(() => rulesDataSources.filter(ds => {\n    var _rules$ds$name;\n\n    return (_rules$ds$name = rules[ds.name]) === null || _rules$ds$name === void 0 ? void 0 : _rules$ds$name.loading;\n  }), [rules, rulesDataSources]);\n  const {\n    numberOfPages,\n    onPageChange,\n    page,\n    pageItems\n  } = usePagination(groupsWithNamespaces, 1, DEFAULT_PER_PAGE_PAGINATION);\n  return /*#__PURE__*/_jsxs(\"section\", {\n    className: styles.wrapper,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: styles.sectionHeader,\n      children: [_h || (_h = /*#__PURE__*/_jsx(\"h5\", {\n        children: \"Mimir / Cortex / Loki\"\n      })), dataSourcesLoading.length ? /*#__PURE__*/_jsx(LoadingPlaceholder, {\n        className: styles.loader,\n        text: `Loading rules from ${dataSourcesLoading.length} ${pluralize('source', dataSourcesLoading.length)}`\n      }) : _div || (_div = /*#__PURE__*/_jsx(\"div\", {}))]\n    }), pageItems.map(({\n      group,\n      namespace\n    }) => {\n      return /*#__PURE__*/_jsx(RulesGroup, {\n        group: group,\n        namespace: namespace,\n        expandAll: expandAll\n      }, `${getRulesSourceUid(namespace.rulesSource)}-${namespace.name}-${group.name}`);\n    }), (namespaces === null || namespaces === void 0 ? void 0 : namespaces.length) === 0 && !!rulesDataSources.length && (_p || (_p = /*#__PURE__*/_jsx(\"p\", {\n      children: \"No rules found.\"\n    }))), !rulesDataSources.length && (_p2 || (_p2 = /*#__PURE__*/_jsx(\"p\", {\n      children: \"There are no Prometheus or Loki data sources configured.\"\n    }))), /*#__PURE__*/_jsx(Pagination, {\n      className: styles.pagination,\n      currentPage: page,\n      numberOfPages: numberOfPages,\n      onNavigate: onPageChange,\n      hideWhenSinglePage: true\n    })]\n  });\n};\n\nconst getStyles = theme => ({\n  loader: css`\n    margin-bottom: 0;\n  `,\n  sectionHeader: css`\n    display: flex;\n    justify-content: space-between;\n  `,\n  wrapper: css`\n    margin-bottom: ${theme.spacing(4)};\n  `,\n  pagination: getPaginationStyles(theme)\n});","map":{"version":3,"names":["css","pluralize","React","useMemo","LoadingPlaceholder","Pagination","useStyles2","DEFAULT_PER_PAGE_PAGINATION","usePagination","useUnifiedAlertingSelector","getPaginationStyles","getRulesDataSources","getRulesSourceUid","RulesGroup","useCombinedGroupNamespace","CloudRules","namespaces","expandAll","styles","getStyles","rules","state","promRules","rulesDataSources","groupsWithNamespaces","dataSourcesLoading","filter","ds","name","loading","numberOfPages","onPageChange","page","pageItems","wrapper","sectionHeader","length","loader","map","group","namespace","rulesSource","pagination","theme","spacing"],"sources":["/home/soula/grafana/public/app/features/alerting/unified/components/rules/CloudRules.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport pluralize from 'pluralize';\nimport React, { FC, useMemo } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { LoadingPlaceholder, Pagination, useStyles2 } from '@grafana/ui';\nimport { CombinedRuleNamespace } from 'app/types/unified-alerting';\n\nimport { DEFAULT_PER_PAGE_PAGINATION } from '../../../../../core/constants';\nimport { usePagination } from '../../hooks/usePagination';\nimport { useUnifiedAlertingSelector } from '../../hooks/useUnifiedAlertingSelector';\nimport { getPaginationStyles } from '../../styles/pagination';\nimport { getRulesDataSources, getRulesSourceUid } from '../../utils/datasource';\n\nimport { RulesGroup } from './RulesGroup';\nimport { useCombinedGroupNamespace } from './useCombinedGroupNamespace';\n\ninterface Props {\n  namespaces: CombinedRuleNamespace[];\n  expandAll: boolean;\n}\n\nexport const CloudRules: FC<Props> = ({ namespaces, expandAll }) => {\n  const styles = useStyles2(getStyles);\n\n  const rules = useUnifiedAlertingSelector((state) => state.promRules);\n  const rulesDataSources = useMemo(getRulesDataSources, []);\n  const groupsWithNamespaces = useCombinedGroupNamespace(namespaces);\n\n  const dataSourcesLoading = useMemo(\n    () => rulesDataSources.filter((ds) => rules[ds.name]?.loading),\n    [rules, rulesDataSources]\n  );\n\n  const { numberOfPages, onPageChange, page, pageItems } = usePagination(\n    groupsWithNamespaces,\n    1,\n    DEFAULT_PER_PAGE_PAGINATION\n  );\n\n  return (\n    <section className={styles.wrapper}>\n      <div className={styles.sectionHeader}>\n        <h5>Mimir / Cortex / Loki</h5>\n        {dataSourcesLoading.length ? (\n          <LoadingPlaceholder\n            className={styles.loader}\n            text={`Loading rules from ${dataSourcesLoading.length} ${pluralize('source', dataSourcesLoading.length)}`}\n          />\n        ) : (\n          <div />\n        )}\n      </div>\n\n      {pageItems.map(({ group, namespace }) => {\n        return (\n          <RulesGroup\n            group={group}\n            key={`${getRulesSourceUid(namespace.rulesSource)}-${namespace.name}-${group.name}`}\n            namespace={namespace}\n            expandAll={expandAll}\n          />\n        );\n      })}\n      {namespaces?.length === 0 && !!rulesDataSources.length && <p>No rules found.</p>}\n      {!rulesDataSources.length && <p>There are no Prometheus or Loki data sources configured.</p>}\n      <Pagination\n        className={styles.pagination}\n        currentPage={page}\n        numberOfPages={numberOfPages}\n        onNavigate={onPageChange}\n        hideWhenSinglePage\n      />\n    </section>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  loader: css`\n    margin-bottom: 0;\n  `,\n  sectionHeader: css`\n    display: flex;\n    justify-content: space-between;\n  `,\n  wrapper: css`\n    margin-bottom: ${theme.spacing(4)};\n  `,\n  pagination: getPaginationStyles(theme),\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}