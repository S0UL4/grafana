{"ast":null,"code":"var _Button, _FileDropzoneCustomCh;\n\nimport { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport SVG from 'react-inlinesvg';\nimport { FileDropzone, useStyles2, Button, Field } from '@grafana/ui';\nimport { MediaType } from '../types';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function FileDropzoneCustomChildren({\n  secondaryText = 'Drag and drop here or browse'\n}) {\n  const styles = useStyles2(getStyles);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.iconWrapper,\n    children: [/*#__PURE__*/_jsx(\"small\", {\n      className: styles.small,\n      children: secondaryText\n    }), _Button || (_Button = /*#__PURE__*/_jsx(Button, {\n      type: \"button\",\n      icon: \"upload\",\n      children: \"Upload\"\n    }))]\n  });\n}\nexport const FileUploader = ({\n  mediaType,\n  setFormData,\n  setUpload,\n  error\n}) => {\n  const styles = useStyles2(getStyles);\n  const [dropped, setDropped] = useState(false);\n  const [file, setFile] = useState('');\n\n  const Preview = () => /*#__PURE__*/_jsx(Field, {\n    label: \"Preview\",\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.iconPreview,\n      children: [mediaType === MediaType.Icon && /*#__PURE__*/_jsx(SVG, {\n        src: file,\n        className: styles.img\n      }), mediaType === MediaType.Image && /*#__PURE__*/_jsx(\"img\", {\n        src: file,\n        className: styles.img\n      })]\n    })\n  });\n\n  const onFileRemove = file => {\n    fetch(`/api/storage/delete/upload/${file.file.name}`, {\n      method: 'DELETE'\n    }).catch(error => console.error('cannot delete file', error));\n  };\n\n  const acceptableFiles = mediaType === 'icon' ? {\n    'image/*': ['.svg', '.xml']\n  } : {\n    'image/*': ['.jpeg', '.png', '.gif', '.webp']\n  };\n  return /*#__PURE__*/_jsx(FileDropzone, {\n    readAs: \"readAsBinaryString\",\n    onFileRemove: onFileRemove,\n    options: {\n      accept: acceptableFiles,\n      multiple: false,\n      onDrop: acceptedFiles => {\n        let formData = new FormData();\n        formData.append('file', acceptedFiles[0]);\n        setFile(URL.createObjectURL(acceptedFiles[0]));\n        setDropped(true);\n        setFormData(formData);\n        setUpload(true);\n      }\n    },\n    children: error.message !== '' && dropped ? /*#__PURE__*/_jsx(\"p\", {\n      children: error.message\n    }) : dropped ? /*#__PURE__*/_jsx(Preview, {}) : _FileDropzoneCustomCh || (_FileDropzoneCustomCh = /*#__PURE__*/_jsx(FileDropzoneCustomChildren, {}))\n  });\n};\n\nfunction getStyles(theme, isDragActive) {\n  return {\n    container: css`\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n    `,\n    dropzone: css`\n      display: flex;\n      flex: 1;\n      flex-direction: column;\n      align-items: center;\n      padding: ${theme.spacing(6)};\n      border-radius: 2px;\n      border: 2px dashed ${theme.colors.border.medium};\n      background-color: ${isDragActive ? theme.colors.background.secondary : theme.colors.background.primary};\n      cursor: pointer;\n    `,\n    iconWrapper: css`\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n    `,\n    acceptMargin: css`\n      margin: ${theme.spacing(2, 0, 1)};\n    `,\n    small: css`\n      color: ${theme.colors.text.secondary};\n      margin-bottom: ${theme.spacing(2)};\n    `,\n    iconContainer: css`\n      display: flex;\n      flex-direction: column;\n      width: 80%;\n      align-items: center;\n      align-self: center;\n    `,\n    iconPreview: css`\n      width: 238px;\n      height: 198px;\n      border: 1px solid ${theme.colors.border.medium};\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `,\n    img: css`\n      width: 147px;\n      height: 147px;\n      fill: ${theme.colors.text.primary};\n    `\n  };\n}","map":{"version":3,"names":["css","React","useState","SVG","FileDropzone","useStyles2","Button","Field","MediaType","FileDropzoneCustomChildren","secondaryText","styles","getStyles","iconWrapper","small","FileUploader","mediaType","setFormData","setUpload","error","dropped","setDropped","file","setFile","Preview","iconPreview","Icon","img","Image","onFileRemove","fetch","name","method","catch","console","acceptableFiles","accept","multiple","onDrop","acceptedFiles","formData","FormData","append","URL","createObjectURL","message","theme","isDragActive","container","dropzone","spacing","colors","border","medium","background","secondary","primary","acceptMargin","text","iconContainer"],"sources":["/home/soula/grafana/public/app/features/dimensions/editors/FileUploader.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { Dispatch, SetStateAction, useState } from 'react';\nimport SVG from 'react-inlinesvg';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { FileDropzone, useStyles2, Button, DropzoneFile, Field } from '@grafana/ui';\n\nimport { MediaType } from '../types';\ninterface Props {\n  setFormData: Dispatch<SetStateAction<FormData>>;\n  mediaType: MediaType;\n  setUpload: Dispatch<SetStateAction<boolean>>;\n  newValue: string;\n  error: ErrorResponse;\n}\ninterface ErrorResponse {\n  message: string;\n}\nexport function FileDropzoneCustomChildren({ secondaryText = 'Drag and drop here or browse' }) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.iconWrapper}>\n      <small className={styles.small}>{secondaryText}</small>\n      <Button type=\"button\" icon=\"upload\">\n        Upload\n      </Button>\n    </div>\n  );\n}\nexport const FileUploader = ({ mediaType, setFormData, setUpload, error }: Props) => {\n  const styles = useStyles2(getStyles);\n  const [dropped, setDropped] = useState<boolean>(false);\n  const [file, setFile] = useState<string>('');\n\n  const Preview = () => (\n    <Field label=\"Preview\">\n      <div className={styles.iconPreview}>\n        {mediaType === MediaType.Icon && <SVG src={file} className={styles.img} />}\n        {mediaType === MediaType.Image && <img src={file} className={styles.img} />}\n      </div>\n    </Field>\n  );\n\n  const onFileRemove = (file: DropzoneFile) => {\n    fetch(`/api/storage/delete/upload/${file.file.name}`, {\n      method: 'DELETE',\n    }).catch((error) => console.error('cannot delete file', error));\n  };\n\n  const acceptableFiles =\n    mediaType === 'icon' ? { 'image/*': ['.svg', '.xml'] } : { 'image/*': ['.jpeg', '.png', '.gif', '.webp'] };\n  return (\n    <FileDropzone\n      readAs=\"readAsBinaryString\"\n      onFileRemove={onFileRemove}\n      options={{\n        accept: acceptableFiles,\n        multiple: false,\n        onDrop: (acceptedFiles: File[]) => {\n          let formData = new FormData();\n          formData.append('file', acceptedFiles[0]);\n          setFile(URL.createObjectURL(acceptedFiles[0]));\n          setDropped(true);\n          setFormData(formData);\n          setUpload(true);\n        },\n      }}\n    >\n      {error.message !== '' && dropped ? (\n        <p>{error.message}</p>\n      ) : dropped ? (\n        <Preview />\n      ) : (\n        <FileDropzoneCustomChildren />\n      )}\n    </FileDropzone>\n  );\n};\n\nfunction getStyles(theme: GrafanaTheme2, isDragActive?: boolean) {\n  return {\n    container: css`\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n    `,\n    dropzone: css`\n      display: flex;\n      flex: 1;\n      flex-direction: column;\n      align-items: center;\n      padding: ${theme.spacing(6)};\n      border-radius: 2px;\n      border: 2px dashed ${theme.colors.border.medium};\n      background-color: ${isDragActive ? theme.colors.background.secondary : theme.colors.background.primary};\n      cursor: pointer;\n    `,\n    iconWrapper: css`\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n    `,\n    acceptMargin: css`\n      margin: ${theme.spacing(2, 0, 1)};\n    `,\n    small: css`\n      color: ${theme.colors.text.secondary};\n      margin-bottom: ${theme.spacing(2)};\n    `,\n    iconContainer: css`\n      display: flex;\n      flex-direction: column;\n      width: 80%;\n      align-items: center;\n      align-self: center;\n    `,\n    iconPreview: css`\n      width: 238px;\n      height: 198px;\n      border: 1px solid ${theme.colors.border.medium};\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `,\n    img: css`\n      width: 147px;\n      height: 147px;\n      fill: ${theme.colors.text.primary};\n    `,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}