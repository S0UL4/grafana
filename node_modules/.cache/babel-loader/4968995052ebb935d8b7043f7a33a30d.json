{"ast":null,"code":"import angular from 'angular';\nimport $ from 'jquery';\nimport { isFunction } from 'lodash';\nimport coreModule from './core_module';\ncoreModule.directive('bsTypeahead', ['$parse', function ($parse) {\n  return {\n    restrict: 'A',\n    require: '?ngModel',\n    link: function postLink(scope, element, attrs, controller) {\n      var getter = $parse(attrs.bsTypeahead),\n          value = getter(scope);\n      scope.$watch(attrs.bsTypeahead, function (newValue, oldValue) {\n        if (newValue !== oldValue) {\n          value = newValue;\n        }\n      });\n      element.attr('data-provide', 'typeahead');\n      element.typeahead({\n        source: function () {\n          return angular.isFunction(value) ? value.apply(null, arguments) : value;\n        },\n        minLength: attrs.minLength || 1,\n        items: attrs.item,\n        updater: function (value) {\n          if (controller) {\n            scope.$apply(function () {\n              controller.$setViewValue(value);\n            });\n          }\n\n          scope.$emit('typeahead-updated', value);\n          return value;\n        }\n      });\n      var typeahead = element.data('typeahead');\n\n      typeahead.lookup = function () {\n        var items;\n        this.query = this.$element.val() || '';\n\n        if (this.query.length < this.options.minLength) {\n          return this.shown ? this.hide() : this;\n        }\n\n        items = isFunction(this.source) ? this.source(this.query, $.proxy(this.process, this)) : this.source;\n        return items ? this.process(items) : this;\n      };\n\n      if (!!attrs.matchAll) {\n        typeahead.matcher = function () {\n          return true;\n        };\n      }\n\n      if (attrs.minLength === '0') {\n        setTimeout(function () {\n          element.on('focus', function () {\n            element.val().length === 0 && setTimeout(element.typeahead.bind(element, 'lookup'), 200);\n          });\n        });\n      }\n    }\n  };\n}]);","map":{"version":3,"names":["angular","$","isFunction","coreModule","directive","$parse","restrict","require","link","postLink","scope","element","attrs","controller","getter","bsTypeahead","value","$watch","newValue","oldValue","attr","typeahead","source","apply","arguments","minLength","items","item","updater","$apply","$setViewValue","$emit","data","lookup","query","$element","val","length","options","shown","hide","proxy","process","matchAll","matcher","setTimeout","on","bind"],"sources":["/home/soula/grafana/public/app/angular/bsTypeahead.ts"],"sourcesContent":["import angular from 'angular';\nimport $ from 'jquery';\nimport { isFunction } from 'lodash';\n\nimport coreModule from './core_module';\n\ncoreModule.directive('bsTypeahead', [\n  '$parse',\n  function ($parse: any) {\n    return {\n      restrict: 'A',\n      require: '?ngModel',\n      link: function postLink(scope: any, element: any, attrs: any, controller: any) {\n        var getter = $parse(attrs.bsTypeahead),\n          value = getter(scope);\n        scope.$watch(attrs.bsTypeahead, function (newValue: any, oldValue: any) {\n          if (newValue !== oldValue) {\n            value = newValue;\n          }\n        });\n        element.attr('data-provide', 'typeahead');\n        element.typeahead({\n          source: function () {\n            return angular.isFunction(value) ? value.apply(null, arguments) : value;\n          },\n          minLength: attrs.minLength || 1,\n          items: attrs.item,\n          updater: function (value: any) {\n            if (controller) {\n              scope.$apply(function () {\n                controller.$setViewValue(value);\n              });\n            }\n            scope.$emit('typeahead-updated', value);\n            return value;\n          },\n        });\n        var typeahead = element.data('typeahead');\n        typeahead.lookup = function () {\n          var items;\n          this.query = this.$element.val() || '';\n          if (this.query.length < this.options.minLength) {\n            return this.shown ? this.hide() : this;\n          }\n          items = isFunction(this.source) ? this.source(this.query, $.proxy(this.process, this)) : this.source;\n          return items ? this.process(items) : this;\n        };\n        if (!!attrs.matchAll) {\n          typeahead.matcher = function () {\n            return true;\n          };\n        }\n        if (attrs.minLength === '0') {\n          setTimeout(function () {\n            element.on('focus', function () {\n              element.val().length === 0 && setTimeout(element.typeahead.bind(element, 'lookup'), 200);\n            });\n          });\n        }\n      },\n    };\n  },\n]);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}