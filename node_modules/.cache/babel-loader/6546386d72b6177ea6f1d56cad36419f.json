{"ast":null,"code":"var _td, _span, _span2;\n\nimport { css } from '@emotion/css';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { MappingType } from '@grafana/data';\nimport { useStyles2, VerticalGroup, Icon, ColorPicker, Button, Modal } from '@grafana/ui';\nimport { MediaType, ResourceFolderName, ResourcePickerSize } from '../../types';\nimport { ResourcePicker } from '../ResourcePicker';\nimport { buildEditRowModels, editModelToSaveModel, ValueMappingsEditorModal } from './ValueMappingsEditorModal';\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport const ValueMappingsEditor = /*#__PURE__*/React.memo(props => {\n  var _item$settings;\n\n  const {\n    value,\n    onChange,\n    item\n  } = props;\n  const styles = useStyles2(getStyles);\n  const showIconPicker = (_item$settings = item.settings) === null || _item$settings === void 0 ? void 0 : _item$settings.icon;\n  const [isEditorOpen, setIsEditorOpen] = useState(false);\n  const onCloseEditor = useCallback(() => {\n    setIsEditorOpen(false);\n  }, [setIsEditorOpen]);\n  const rows = useMemo(() => buildEditRowModels(value), [value]);\n  const onChangeColor = useCallback((color, index) => {\n    rows[index].result.color = color;\n    onChange(editModelToSaveModel(rows));\n  }, [rows, onChange]);\n  const onChangeIcon = useCallback((icon, index) => {\n    rows[index].result.icon = icon;\n    onChange(editModelToSaveModel(rows));\n  }, [rows, onChange]);\n  return /*#__PURE__*/_jsxs(VerticalGroup, {\n    children: [/*#__PURE__*/_jsx(\"table\", {\n      className: styles.compactTable,\n      children: /*#__PURE__*/_jsx(\"tbody\", {\n        children: rows.map((row, rowIndex) => /*#__PURE__*/_jsxs(\"tr\", {\n          children: [/*#__PURE__*/_jsxs(\"td\", {\n            children: [row.type === MappingType.ValueToText && row.key, row.type === MappingType.RangeToText && /*#__PURE__*/_jsxs(\"span\", {\n              children: [\"[\", row.from, \" - \", row.to, \"]\"]\n            }), row.type === MappingType.RegexToText && row.pattern, row.type === MappingType.SpecialValue && row.specialMatch]\n          }), _td || (_td = /*#__PURE__*/_jsx(\"td\", {\n            children: /*#__PURE__*/_jsx(Icon, {\n              name: \"arrow-right\"\n            })\n          })), /*#__PURE__*/_jsx(\"td\", {\n            children: row.result.text\n          }), row.result.color && /*#__PURE__*/_jsx(\"td\", {\n            children: /*#__PURE__*/_jsx(ColorPicker, {\n              color: row.result.color,\n              onChange: color => onChangeColor(color, rowIndex),\n              enableNamedColors: true\n            })\n          }), showIconPicker && row.result.icon && /*#__PURE__*/_jsx(\"td\", {\n            \"data-testid\": \"iconPicker\",\n            children: /*#__PURE__*/_jsx(ResourcePicker, {\n              onChange: icon => onChangeIcon(icon, rowIndex),\n              value: row.result.icon,\n              size: ResourcePickerSize.SMALL,\n              folderName: ResourceFolderName.Icon,\n              mediaType: MediaType.Icon,\n              color: row.result.color\n            })\n          })]\n        }, rowIndex.toString()))\n      })\n    }), /*#__PURE__*/_jsxs(Button, {\n      variant: \"secondary\",\n      size: \"sm\",\n      fullWidth: true,\n      onClick: () => setIsEditorOpen(true),\n      children: [rows.length > 0 && (_span || (_span = /*#__PURE__*/_jsx(\"span\", {\n        children: \"Edit value mappings\"\n      }))), rows.length === 0 && (_span2 || (_span2 = /*#__PURE__*/_jsx(\"span\", {\n        children: \"Add value mappings\"\n      })))]\n    }), /*#__PURE__*/_jsx(Modal, {\n      isOpen: isEditorOpen,\n      title: \"Value mappings\",\n      onDismiss: onCloseEditor,\n      className: styles.modal,\n      closeOnBackdropClick: false,\n      children: /*#__PURE__*/_jsx(ValueMappingsEditorModal, {\n        value: value,\n        onChange: onChange,\n        onClose: onCloseEditor,\n        showIconPicker: showIconPicker\n      })\n    })]\n  });\n});\nValueMappingsEditor.displayName = 'ValueMappingsEditor';\nexport const getStyles = theme => ({\n  modal: css({\n    width: '980px'\n  }),\n  compactTable: css({\n    width: '100%',\n    'tbody td': {\n      padding: theme.spacing(0.5)\n    }\n  })\n});","map":{"version":3,"names":["css","React","useCallback","useMemo","useState","MappingType","useStyles2","VerticalGroup","Icon","ColorPicker","Button","Modal","MediaType","ResourceFolderName","ResourcePickerSize","ResourcePicker","buildEditRowModels","editModelToSaveModel","ValueMappingsEditorModal","ValueMappingsEditor","memo","props","value","onChange","item","styles","getStyles","showIconPicker","settings","icon","isEditorOpen","setIsEditorOpen","onCloseEditor","rows","onChangeColor","color","index","result","onChangeIcon","compactTable","map","row","rowIndex","type","ValueToText","key","RangeToText","from","to","RegexToText","pattern","SpecialValue","specialMatch","text","SMALL","toString","length","modal","displayName","theme","width","padding","spacing"],"sources":["/home/soula/grafana/public/app/features/dimensions/editors/ValueMappingsEditor/ValueMappingsEditor.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { useCallback, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, MappingType, StandardEditorProps, ValueMapping } from '@grafana/data';\nimport { useStyles2, VerticalGroup, Icon, ColorPicker, Button, Modal } from '@grafana/ui';\n\nimport { MediaType, ResourceFolderName, ResourcePickerSize } from '../../types';\nimport { ResourcePicker } from '../ResourcePicker';\n\nimport { buildEditRowModels, editModelToSaveModel, ValueMappingsEditorModal } from './ValueMappingsEditorModal';\n\nexport interface Props extends StandardEditorProps<ValueMapping[], any, any> {\n  showIcon?: boolean;\n}\n\nexport const ValueMappingsEditor = React.memo((props: Props) => {\n  const { value, onChange, item } = props;\n\n  const styles = useStyles2(getStyles);\n  const showIconPicker = item.settings?.icon;\n  const [isEditorOpen, setIsEditorOpen] = useState(false);\n  const onCloseEditor = useCallback(() => {\n    setIsEditorOpen(false);\n  }, [setIsEditorOpen]);\n\n  const rows = useMemo(() => buildEditRowModels(value), [value]);\n\n  const onChangeColor = useCallback(\n    (color: string, index: number) => {\n      rows[index].result.color = color;\n      onChange(editModelToSaveModel(rows));\n    },\n    [rows, onChange]\n  );\n\n  const onChangeIcon = useCallback(\n    (icon: string | undefined, index: number) => {\n      rows[index].result.icon = icon;\n      onChange(editModelToSaveModel(rows));\n    },\n    [rows, onChange]\n  );\n\n  return (\n    <VerticalGroup>\n      <table className={styles.compactTable}>\n        <tbody>\n          {rows.map((row, rowIndex) => (\n            <tr key={rowIndex.toString()}>\n              <td>\n                {row.type === MappingType.ValueToText && row.key}\n                {row.type === MappingType.RangeToText && (\n                  <span>\n                    [{row.from} - {row.to}]\n                  </span>\n                )}\n                {row.type === MappingType.RegexToText && row.pattern}\n                {row.type === MappingType.SpecialValue && row.specialMatch}\n              </td>\n              <td>\n                <Icon name=\"arrow-right\" />\n              </td>\n              <td>{row.result.text}</td>\n              {row.result.color && (\n                <td>\n                  <ColorPicker\n                    color={row.result.color}\n                    onChange={(color) => onChangeColor(color, rowIndex)}\n                    enableNamedColors={true}\n                  />\n                </td>\n              )}\n              {showIconPicker && row.result.icon && (\n                <td data-testid=\"iconPicker\">\n                  <ResourcePicker\n                    onChange={(icon) => onChangeIcon(icon, rowIndex)}\n                    value={row.result.icon}\n                    size={ResourcePickerSize.SMALL}\n                    folderName={ResourceFolderName.Icon}\n                    mediaType={MediaType.Icon}\n                    color={row.result.color}\n                  />\n                </td>\n              )}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      <Button variant=\"secondary\" size=\"sm\" fullWidth onClick={() => setIsEditorOpen(true)}>\n        {rows.length > 0 && <span>Edit value mappings</span>}\n        {rows.length === 0 && <span>Add value mappings</span>}\n      </Button>\n      <Modal\n        isOpen={isEditorOpen}\n        title=\"Value mappings\"\n        onDismiss={onCloseEditor}\n        className={styles.modal}\n        closeOnBackdropClick={false}\n      >\n        <ValueMappingsEditorModal\n          value={value}\n          onChange={onChange}\n          onClose={onCloseEditor}\n          showIconPicker={showIconPicker}\n        />\n      </Modal>\n    </VerticalGroup>\n  );\n});\n\nValueMappingsEditor.displayName = 'ValueMappingsEditor';\n\nexport const getStyles = (theme: GrafanaTheme2) => ({\n  modal: css({\n    width: '980px',\n  }),\n  compactTable: css({\n    width: '100%',\n    'tbody td': {\n      padding: theme.spacing(0.5),\n    },\n  }),\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}