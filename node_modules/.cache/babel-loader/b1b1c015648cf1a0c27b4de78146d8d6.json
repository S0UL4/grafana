{"ast":null,"code":"function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { debounce, find, indexOf, map, isObject, escape, unescape } from 'lodash';\nimport coreModule from '../../core_module';\nimport { promiseToDigest } from '../../promiseToDigest';\n\nfunction typeaheadMatcher(item) {\n  let str = this.query;\n\n  if (str === '') {\n    return true;\n  }\n\n  if (str[0] === '/') {\n    str = str.substring(1);\n  }\n\n  if (str[str.length - 1] === '/') {\n    str = str.substring(0, str.length - 1);\n  }\n\n  return item.toLowerCase().match(str.toLowerCase());\n}\n\nexport class FormDropdownCtrl {\n  /** @ngInject */\n  constructor($scope, $element, $sce, templateSrv) {\n    _defineProperty(this, \"inputElement\", void 0);\n\n    _defineProperty(this, \"linkElement\", void 0);\n\n    _defineProperty(this, \"model\", void 0);\n\n    _defineProperty(this, \"display\", void 0);\n\n    _defineProperty(this, \"text\", void 0);\n\n    _defineProperty(this, \"options\", void 0);\n\n    _defineProperty(this, \"cssClass\", void 0);\n\n    _defineProperty(this, \"cssClasses\", void 0);\n\n    _defineProperty(this, \"allowCustom\", void 0);\n\n    _defineProperty(this, \"labelMode\", void 0);\n\n    _defineProperty(this, \"linkMode\", void 0);\n\n    _defineProperty(this, \"cancelBlur\", void 0);\n\n    _defineProperty(this, \"onChange\", void 0);\n\n    _defineProperty(this, \"getOptions\", void 0);\n\n    _defineProperty(this, \"optionCache\", void 0);\n\n    _defineProperty(this, \"lookupText\", void 0);\n\n    _defineProperty(this, \"placeholder\", void 0);\n\n    _defineProperty(this, \"startOpen\", void 0);\n\n    _defineProperty(this, \"debounce\", void 0);\n\n    this.$scope = $scope;\n    this.$sce = $sce;\n    this.templateSrv = templateSrv;\n    this.inputElement = $element.find('input').first();\n    this.linkElement = $element.find('a').first();\n    this.linkMode = true;\n    this.cancelBlur = null;\n    this.labelMode = false;\n    this.lookupText = false;\n    this.debounce = false; // listen to model changes\n\n    $scope.$watch('ctrl.model', this.modelChanged.bind(this));\n  }\n\n  $onInit() {\n    if (this.labelMode) {\n      this.cssClasses = 'gf-form-label ' + this.cssClass;\n    } else {\n      this.cssClasses = 'gf-form-input gf-form-input--dropdown ' + this.cssClass;\n    }\n\n    if (this.placeholder) {\n      this.inputElement.attr('placeholder', this.placeholder);\n    }\n\n    this.inputElement.attr('data-provide', 'typeahead');\n    this.inputElement.typeahead({\n      source: this.typeaheadSource.bind(this),\n      minLength: 0,\n      items: 10000,\n      updater: this.typeaheadUpdater.bind(this),\n      matcher: typeaheadMatcher\n    }); // modify typeahead lookup\n    // this = typeahead\n\n    const typeahead = this.inputElement.data('typeahead');\n\n    typeahead.lookup = function () {\n      this.query = this.$element.val() || '';\n      this.source(this.query, this.process.bind(this));\n    };\n\n    if (this.debounce) {\n      typeahead.lookup = debounce(typeahead.lookup, 500, {\n        leading: true\n      });\n    }\n\n    this.linkElement.keydown(evt => {\n      // trigger typeahead on down arrow or enter key\n      if (evt.keyCode === 40 || evt.keyCode === 13) {\n        this.linkElement.click();\n      }\n    });\n    this.inputElement.keydown(evt => {\n      if (evt.keyCode === 13) {\n        setTimeout(() => {\n          this.inputElement.blur();\n        }, 300);\n      }\n    });\n    this.inputElement.blur(this.inputBlur.bind(this));\n\n    if (this.startOpen) {\n      setTimeout(this.open.bind(this), 0);\n    }\n  }\n\n  getOptionsInternal(query) {\n    return promiseToDigest(this.$scope)(Promise.resolve(this.getOptions({\n      $query: query\n    })));\n  }\n\n  isPromiseLike(obj) {\n    return obj && typeof obj.then === 'function';\n  }\n\n  modelChanged() {\n    if (isObject(this.model)) {\n      this.updateDisplay(this.model.text);\n    } else {\n      // if we have text use it\n      if (this.lookupText) {\n        this.getOptionsInternal('').then(options => {\n          const item = find(options, {\n            value: this.model\n          });\n          this.updateDisplay(item ? item.text : this.model);\n        });\n      } else {\n        this.updateDisplay(this.model);\n      }\n    }\n  }\n\n  typeaheadSource(query, callback) {\n    this.getOptionsInternal(query).then(options => {\n      this.optionCache = options; // extract texts\n\n      const optionTexts = map(options, op => {\n        return escape(op.text);\n      }); // add custom values\n\n      if (this.allowCustom && this.text !== '') {\n        if (indexOf(optionTexts, this.text) === -1) {\n          optionTexts.unshift(this.text);\n        }\n      }\n\n      callback(optionTexts);\n    });\n  }\n\n  typeaheadUpdater(text) {\n    if (text === this.text) {\n      clearTimeout(this.cancelBlur);\n      this.inputElement.focus();\n      return text;\n    }\n\n    this.inputElement.val(text);\n    this.switchToLink(true);\n    return text;\n  }\n\n  switchToLink(fromClick) {\n    if (this.linkMode && !fromClick) {\n      return;\n    }\n\n    clearTimeout(this.cancelBlur);\n    this.cancelBlur = null;\n    this.linkMode = true;\n    this.inputElement.hide();\n    this.linkElement.show();\n    this.updateValue(this.inputElement.val());\n  }\n\n  inputBlur() {\n    // happens long before the click event on the typeahead options\n    // need to have long delay because the blur\n    this.cancelBlur = setTimeout(this.switchToLink.bind(this), 200);\n  }\n\n  updateValue(text) {\n    text = unescape(text);\n\n    if (text === '' || this.text === text) {\n      return;\n    }\n\n    this.$scope.$apply(() => {\n      const option = find(this.optionCache, {\n        text: text\n      });\n\n      if (option) {\n        if (isObject(this.model)) {\n          this.model = option;\n        } else {\n          this.model = option.value;\n        }\n\n        this.text = option.text;\n      } else if (this.allowCustom) {\n        if (isObject(this.model)) {\n          this.model.text = this.model.value = text;\n        } else {\n          this.model = text;\n        }\n\n        this.text = text;\n      } // needs to call this after digest so\n      // property is synced with outerscope\n\n\n      this.$scope.$$postDigest(() => {\n        this.$scope.$apply(() => {\n          this.onChange({\n            $option: option\n          });\n        });\n      });\n    });\n  }\n\n  updateDisplay(text) {\n    this.text = text;\n    this.display = this.$sce.trustAsHtml(this.templateSrv.highlightVariablesAsHtml(text));\n  }\n\n  open() {\n    this.inputElement.css('width', Math.max(this.linkElement.width(), 80) + 16 + 'px');\n    this.inputElement.show();\n    this.inputElement.focus();\n    this.linkElement.hide();\n    this.linkMode = false;\n    const typeahead = this.inputElement.data('typeahead');\n\n    if (typeahead) {\n      this.inputElement.val('');\n      typeahead.lookup();\n    }\n  }\n\n}\nFormDropdownCtrl.$inject = [\"$scope\", \"$element\", \"$sce\", \"templateSrv\"];\nconst template = `\n<input type=\"text\"\n  data-provide=\"typeahead\"\n  class=\"gf-form-input\"\n  spellcheck=\"false\"\n  style=\"display:none\">\n</input>\n<a ng-class=\"ctrl.cssClasses\"\n   tabindex=\"1\"\n   ng-click=\"ctrl.open()\"\n   give-focus=\"ctrl.focus\"\n   ng-bind-html=\"ctrl.display || '&nbsp;'\">\n</a>\n`;\nexport function formDropdownDirective() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: FormDropdownCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      model: '=',\n      getOptions: '&',\n      onChange: '&',\n      cssClass: '@',\n      allowCustom: '@',\n      labelMode: '@',\n      lookupText: '@',\n      placeholder: '@',\n      startOpen: '@',\n      debounce: '@'\n    }\n  };\n}\ncoreModule.directive('gfFormDropdown', formDropdownDirective);","map":{"version":3,"names":["debounce","find","indexOf","map","isObject","escape","unescape","coreModule","promiseToDigest","typeaheadMatcher","item","str","query","substring","length","toLowerCase","match","FormDropdownCtrl","constructor","$scope","$element","$sce","templateSrv","inputElement","first","linkElement","linkMode","cancelBlur","labelMode","lookupText","$watch","modelChanged","bind","$onInit","cssClasses","cssClass","placeholder","attr","typeahead","source","typeaheadSource","minLength","items","updater","typeaheadUpdater","matcher","data","lookup","val","process","leading","keydown","evt","keyCode","click","setTimeout","blur","inputBlur","startOpen","open","getOptionsInternal","Promise","resolve","getOptions","$query","isPromiseLike","obj","then","model","updateDisplay","text","options","value","callback","optionCache","optionTexts","op","allowCustom","unshift","clearTimeout","focus","switchToLink","fromClick","hide","show","updateValue","$apply","option","$$postDigest","onChange","$option","display","trustAsHtml","highlightVariablesAsHtml","css","Math","max","width","template","formDropdownDirective","restrict","controller","bindToController","controllerAs","scope","directive"],"sources":["/home/soula/grafana/public/app/angular/components/form_dropdown/form_dropdown.ts"],"sourcesContent":["import { ISCEService } from 'angular';\nimport { debounce, find, indexOf, map, isObject, escape, unescape } from 'lodash';\n\nimport coreModule from '../../core_module';\nimport { promiseToDigest } from '../../promiseToDigest';\n\nfunction typeaheadMatcher(this: any, item: string) {\n  let str = this.query;\n  if (str === '') {\n    return true;\n  }\n  if (str[0] === '/') {\n    str = str.substring(1);\n  }\n  if (str[str.length - 1] === '/') {\n    str = str.substring(0, str.length - 1);\n  }\n  return item.toLowerCase().match(str.toLowerCase());\n}\n\nexport class FormDropdownCtrl {\n  inputElement: JQLite;\n  linkElement: JQLite;\n  model: any;\n  display: any;\n  text: any;\n  options: any;\n  cssClass: any;\n  cssClasses: any;\n  allowCustom: any;\n  labelMode: boolean;\n  linkMode: boolean;\n  cancelBlur: any;\n  onChange: any;\n  getOptions: any;\n  optionCache: any;\n  lookupText: boolean;\n  placeholder: any;\n  startOpen: any;\n  debounce: boolean;\n\n  /** @ngInject */\n  constructor(private $scope: any, $element: JQLite, private $sce: ISCEService, private templateSrv: any) {\n    this.inputElement = $element.find('input').first();\n    this.linkElement = $element.find('a').first();\n    this.linkMode = true;\n    this.cancelBlur = null;\n    this.labelMode = false;\n    this.lookupText = false;\n    this.debounce = false;\n\n    // listen to model changes\n    $scope.$watch('ctrl.model', this.modelChanged.bind(this));\n  }\n\n  $onInit() {\n    if (this.labelMode) {\n      this.cssClasses = 'gf-form-label ' + this.cssClass;\n    } else {\n      this.cssClasses = 'gf-form-input gf-form-input--dropdown ' + this.cssClass;\n    }\n\n    if (this.placeholder) {\n      this.inputElement.attr('placeholder', this.placeholder);\n    }\n\n    this.inputElement.attr('data-provide', 'typeahead');\n    this.inputElement.typeahead({\n      source: this.typeaheadSource.bind(this),\n      minLength: 0,\n      items: 10000,\n      updater: this.typeaheadUpdater.bind(this),\n      matcher: typeaheadMatcher,\n    });\n\n    // modify typeahead lookup\n    // this = typeahead\n    const typeahead = this.inputElement.data('typeahead');\n    typeahead.lookup = function () {\n      this.query = this.$element.val() || '';\n      this.source(this.query, this.process.bind(this));\n    };\n\n    if (this.debounce) {\n      typeahead.lookup = debounce(typeahead.lookup, 500, { leading: true });\n    }\n\n    this.linkElement.keydown((evt) => {\n      // trigger typeahead on down arrow or enter key\n      if (evt.keyCode === 40 || evt.keyCode === 13) {\n        this.linkElement.click();\n      }\n    });\n\n    this.inputElement.keydown((evt) => {\n      if (evt.keyCode === 13) {\n        setTimeout(() => {\n          this.inputElement.blur();\n        }, 300);\n      }\n    });\n\n    this.inputElement.blur(this.inputBlur.bind(this));\n\n    if (this.startOpen) {\n      setTimeout(this.open.bind(this), 0);\n    }\n  }\n\n  getOptionsInternal(query: string) {\n    return promiseToDigest(this.$scope)(Promise.resolve(this.getOptions({ $query: query })));\n  }\n\n  isPromiseLike(obj: any) {\n    return obj && typeof obj.then === 'function';\n  }\n\n  modelChanged() {\n    if (isObject(this.model)) {\n      this.updateDisplay((this.model as any).text);\n    } else {\n      // if we have text use it\n      if (this.lookupText) {\n        this.getOptionsInternal('').then((options: any) => {\n          const item: any = find(options, { value: this.model });\n          this.updateDisplay(item ? item.text : this.model);\n        });\n      } else {\n        this.updateDisplay(this.model);\n      }\n    }\n  }\n\n  typeaheadSource(query: string, callback: (res: any) => void) {\n    this.getOptionsInternal(query).then((options: any) => {\n      this.optionCache = options;\n\n      // extract texts\n      const optionTexts = map(options, (op: any) => {\n        return escape(op.text);\n      });\n\n      // add custom values\n      if (this.allowCustom && this.text !== '') {\n        if (indexOf(optionTexts, this.text) === -1) {\n          optionTexts.unshift(this.text);\n        }\n      }\n\n      callback(optionTexts);\n    });\n  }\n\n  typeaheadUpdater(text: string) {\n    if (text === this.text) {\n      clearTimeout(this.cancelBlur);\n      this.inputElement.focus();\n      return text;\n    }\n\n    this.inputElement.val(text);\n    this.switchToLink(true);\n    return text;\n  }\n\n  switchToLink(fromClick: boolean) {\n    if (this.linkMode && !fromClick) {\n      return;\n    }\n\n    clearTimeout(this.cancelBlur);\n    this.cancelBlur = null;\n    this.linkMode = true;\n    this.inputElement.hide();\n    this.linkElement.show();\n    this.updateValue(this.inputElement.val() as string);\n  }\n\n  inputBlur() {\n    // happens long before the click event on the typeahead options\n    // need to have long delay because the blur\n    this.cancelBlur = setTimeout(this.switchToLink.bind(this), 200);\n  }\n\n  updateValue(text: string) {\n    text = unescape(text);\n\n    if (text === '' || this.text === text) {\n      return;\n    }\n\n    this.$scope.$apply(() => {\n      const option: any = find(this.optionCache, { text: text });\n\n      if (option) {\n        if (isObject(this.model)) {\n          this.model = option;\n        } else {\n          this.model = option.value;\n        }\n        this.text = option.text;\n      } else if (this.allowCustom) {\n        if (isObject(this.model)) {\n          (this.model as any).text = (this.model as any).value = text;\n        } else {\n          this.model = text;\n        }\n        this.text = text;\n      }\n\n      // needs to call this after digest so\n      // property is synced with outerscope\n      this.$scope.$$postDigest(() => {\n        this.$scope.$apply(() => {\n          this.onChange({ $option: option });\n        });\n      });\n    });\n  }\n\n  updateDisplay(text: string) {\n    this.text = text;\n    this.display = this.$sce.trustAsHtml(this.templateSrv.highlightVariablesAsHtml(text));\n  }\n\n  open() {\n    this.inputElement.css('width', Math.max(this.linkElement.width()!, 80) + 16 + 'px');\n\n    this.inputElement.show();\n    this.inputElement.focus();\n\n    this.linkElement.hide();\n    this.linkMode = false;\n\n    const typeahead = this.inputElement.data('typeahead');\n    if (typeahead) {\n      this.inputElement.val('');\n      typeahead.lookup();\n    }\n  }\n}\n\nconst template = `\n<input type=\"text\"\n  data-provide=\"typeahead\"\n  class=\"gf-form-input\"\n  spellcheck=\"false\"\n  style=\"display:none\">\n</input>\n<a ng-class=\"ctrl.cssClasses\"\n   tabindex=\"1\"\n   ng-click=\"ctrl.open()\"\n   give-focus=\"ctrl.focus\"\n   ng-bind-html=\"ctrl.display || '&nbsp;'\">\n</a>\n`;\n\nexport function formDropdownDirective() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: FormDropdownCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      model: '=',\n      getOptions: '&',\n      onChange: '&',\n      cssClass: '@',\n      allowCustom: '@',\n      labelMode: '@',\n      lookupText: '@',\n      placeholder: '@',\n      startOpen: '@',\n      debounce: '@',\n    },\n  };\n}\n\ncoreModule.directive('gfFormDropdown', formDropdownDirective);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}