{"ast":null,"code":"import { createAction } from '@reduxjs/toolkit';\nimport { LoadingState } from '@grafana/data';\nexport const initialLibraryPanelsViewState = {\n  loadingState: LoadingState.Loading,\n  libraryPanels: [],\n  totalCount: 0,\n  perPage: 40,\n  page: 1,\n  numberOfPages: 0,\n  currentPanelId: undefined\n};\nexport const initSearch = createAction('libraryPanels/view/initSearch');\nexport const searchCompleted = createAction('libraryPanels/view/searchCompleted');\nexport const changePage = createAction('libraryPanels/view/changePage');\nexport const libraryPanelsViewReducer = (state, action) => {\n  if (initSearch.match(action)) {\n    return Object.assign({}, state, {\n      loadingState: LoadingState.Loading\n    });\n  }\n\n  if (searchCompleted.match(action)) {\n    const {\n      libraryPanels,\n      page,\n      perPage,\n      totalCount\n    } = action.payload;\n    const numberOfPages = Math.ceil(totalCount / perPage);\n    return Object.assign({}, state, {\n      libraryPanels,\n      perPage,\n      totalCount,\n      loadingState: LoadingState.Done,\n      numberOfPages,\n      page: page > numberOfPages ? page - 1 : page\n    });\n  }\n\n  if (changePage.match(action)) {\n    return Object.assign({}, state, {\n      page: action.payload.page\n    });\n  }\n\n  return state;\n};","map":{"version":3,"names":["createAction","LoadingState","initialLibraryPanelsViewState","loadingState","Loading","libraryPanels","totalCount","perPage","page","numberOfPages","currentPanelId","undefined","initSearch","searchCompleted","changePage","libraryPanelsViewReducer","state","action","match","payload","Math","ceil","Done"],"sources":["/home/soula/grafana/public/app/features/library-panels/components/LibraryPanelsView/reducer.ts"],"sourcesContent":["import { createAction } from '@reduxjs/toolkit';\nimport { AnyAction } from 'redux';\n\nimport { LoadingState } from '@grafana/data';\n\nimport { LibraryElementDTO } from '../../types';\n\nexport interface LibraryPanelsViewState {\n  loadingState: LoadingState;\n  libraryPanels: LibraryElementDTO[];\n  totalCount: number;\n  perPage: number;\n  page: number;\n  numberOfPages: number;\n  currentPanelId?: string;\n}\n\nexport const initialLibraryPanelsViewState: LibraryPanelsViewState = {\n  loadingState: LoadingState.Loading,\n  libraryPanels: [],\n  totalCount: 0,\n  perPage: 40,\n  page: 1,\n  numberOfPages: 0,\n  currentPanelId: undefined,\n};\n\nexport const initSearch = createAction('libraryPanels/view/initSearch');\nexport const searchCompleted = createAction<\n  Omit<LibraryPanelsViewState, 'currentPanelId' | 'searchString' | 'loadingState' | 'numberOfPages'>\n>('libraryPanels/view/searchCompleted');\n\nexport const changePage = createAction<Pick<LibraryPanelsViewState, 'page'>>('libraryPanels/view/changePage');\n\nexport const libraryPanelsViewReducer = (state: LibraryPanelsViewState, action: AnyAction) => {\n  if (initSearch.match(action)) {\n    return { ...state, loadingState: LoadingState.Loading };\n  }\n\n  if (searchCompleted.match(action)) {\n    const { libraryPanels, page, perPage, totalCount } = action.payload;\n    const numberOfPages = Math.ceil(totalCount / perPage);\n    return {\n      ...state,\n      libraryPanels,\n      perPage,\n      totalCount,\n      loadingState: LoadingState.Done,\n      numberOfPages,\n      page: page > numberOfPages ? page - 1 : page,\n    };\n  }\n\n  if (changePage.match(action)) {\n    return { ...state, page: action.payload.page };\n  }\n\n  return state;\n};\n"],"mappings":"AAAA,SAASA,YAAT,QAA6B,kBAA7B;AAGA,SAASC,YAAT,QAA6B,eAA7B;AAcA,OAAO,MAAMC,6BAAqD,GAAG;EACnEC,YAAY,EAAEF,YAAY,CAACG,OADwC;EAEnEC,aAAa,EAAE,EAFoD;EAGnEC,UAAU,EAAE,CAHuD;EAInEC,OAAO,EAAE,EAJ0D;EAKnEC,IAAI,EAAE,CAL6D;EAMnEC,aAAa,EAAE,CANoD;EAOnEC,cAAc,EAAEC;AAPmD,CAA9D;AAUP,OAAO,MAAMC,UAAU,GAAGZ,YAAY,CAAC,+BAAD,CAA/B;AACP,OAAO,MAAMa,eAAe,GAAGb,YAAY,CAEzC,oCAFyC,CAApC;AAIP,OAAO,MAAMc,UAAU,GAAGd,YAAY,CAAuC,+BAAvC,CAA/B;AAEP,OAAO,MAAMe,wBAAwB,GAAG,CAACC,KAAD,EAAgCC,MAAhC,KAAsD;EAC5F,IAAIL,UAAU,CAACM,KAAX,CAAiBD,MAAjB,CAAJ,EAA8B;IAC5B,yBAAYD,KAAZ;MAAmBb,YAAY,EAAEF,YAAY,CAACG;IAA9C;EACD;;EAED,IAAIS,eAAe,CAACK,KAAhB,CAAsBD,MAAtB,CAAJ,EAAmC;IACjC,MAAM;MAAEZ,aAAF;MAAiBG,IAAjB;MAAuBD,OAAvB;MAAgCD;IAAhC,IAA+CW,MAAM,CAACE,OAA5D;IACA,MAAMV,aAAa,GAAGW,IAAI,CAACC,IAAL,CAAUf,UAAU,GAAGC,OAAvB,CAAtB;IACA,yBACKS,KADL;MAEEX,aAFF;MAGEE,OAHF;MAIED,UAJF;MAKEH,YAAY,EAAEF,YAAY,CAACqB,IAL7B;MAMEb,aANF;MAOED,IAAI,EAAEA,IAAI,GAAGC,aAAP,GAAuBD,IAAI,GAAG,CAA9B,GAAkCA;IAP1C;EASD;;EAED,IAAIM,UAAU,CAACI,KAAX,CAAiBD,MAAjB,CAAJ,EAA8B;IAC5B,yBAAYD,KAAZ;MAAmBR,IAAI,EAAES,MAAM,CAACE,OAAP,CAAeX;IAAxC;EACD;;EAED,OAAOQ,KAAP;AACD,CAxBM"},"metadata":{},"sourceType":"module"}