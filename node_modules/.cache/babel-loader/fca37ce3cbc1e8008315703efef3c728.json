{"ast":null,"code":"var _div, _InlineEditBody;\n\nimport { css } from '@emotion/css';\nimport React, { useRef, useState } from 'react';\nimport Draggable from 'react-draggable';\nimport { Resizable } from 'react-resizable';\nimport { IconButton, Portal, useStyles2 } from '@grafana/ui';\nimport store from 'app/core/store';\nimport { InlineEditBody } from './InlineEditBody';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nconst OFFSET_X = 70;\nexport const InlineEdit = ({\n  onClose\n}) => {\n  const btnInlineEdit = document.querySelector('[data-btninlineedit]').getBoundingClientRect();\n  const ref = useRef(null);\n  const styles = useStyles2(getStyles);\n  const inlineEditKey = 'inlineEditPanel';\n  const defaultMeasurements = {\n    width: 350,\n    height: 400\n  };\n  const defaultX = btnInlineEdit.x + OFFSET_X;\n  const defaultY = btnInlineEdit.y - defaultMeasurements.height;\n  const savedPlacement = store.getObject(inlineEditKey, {\n    x: defaultX,\n    y: defaultY,\n    w: defaultMeasurements.width,\n    h: defaultMeasurements.height\n  });\n  const [measurements, setMeasurements] = useState({\n    width: savedPlacement.w,\n    height: savedPlacement.h\n  });\n  const [placement, setPlacement] = useState({\n    x: savedPlacement.x,\n    y: savedPlacement.y\n  });\n\n  const onDragStop = (event, dragElement) => {\n    let x = dragElement.x < 0 ? 0 : dragElement.x;\n    let y = dragElement.y < 0 ? 0 : dragElement.y;\n    setPlacement({\n      x: x,\n      y: y\n    });\n    saveToStore(x, y, measurements.width, measurements.height);\n  };\n\n  const onResizeStop = (event, data) => {\n    const {\n      size\n    } = data;\n    setMeasurements({\n      width: size.width,\n      height: size.height\n    });\n    saveToStore(placement.x, placement.y, size.width, size.height);\n  };\n\n  const saveToStore = (x, y, width, height) => {\n    store.setObject(inlineEditKey, {\n      x: x,\n      y: y,\n      w: width,\n      h: height\n    });\n  };\n\n  return /*#__PURE__*/_jsx(Portal, {\n    children: /*#__PURE__*/_jsx(\"div\", {\n      className: styles.draggableWrapper,\n      children: /*#__PURE__*/_jsx(Draggable, {\n        handle: \"strong\",\n        onStop: onDragStop,\n        position: {\n          x: placement.x,\n          y: placement.y\n        },\n        children: /*#__PURE__*/_jsx(Resizable, {\n          height: measurements.height,\n          width: measurements.width,\n          onResize: onResizeStop,\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: styles.inlineEditorContainer,\n            style: {\n              height: `${measurements.height}px`,\n              width: `${measurements.width}px`\n            },\n            ref: ref,\n            children: [/*#__PURE__*/_jsxs(\"strong\", {\n              className: styles.inlineEditorHeader,\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: styles.placeholder\n              }), _div || (_div = /*#__PURE__*/_jsx(\"div\", {\n                children: \"Canvas Inline Editor\"\n              })), /*#__PURE__*/_jsx(IconButton, {\n                name: \"times\",\n                size: \"xl\",\n                className: styles.inlineEditorClose,\n                onClick: onClose\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: styles.inlineEditorContentWrapper,\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: styles.inlineEditorContent,\n                children: _InlineEditBody || (_InlineEditBody = /*#__PURE__*/_jsx(InlineEditBody, {}))\n              })\n            })]\n          })\n        })\n      })\n    })\n  });\n};\n\nconst getStyles = theme => ({\n  inlineEditorContainer: css`\n    display: flex;\n    flex-direction: column;\n    background: ${theme.v1.colors.panelBg};\n    box-shadow: 5px 5px 20px -5px #000000;\n    z-index: 1000;\n    opacity: 1;\n  `,\n  draggableWrapper: css`\n    width: 0;\n    height: 0;\n  `,\n  inlineEditorHeader: css`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: ${theme.colors.background.canvas};\n    border: 1px solid ${theme.colors.border.weak};\n    height: 40px;\n    cursor: move;\n  `,\n  inlineEditorContent: css`\n    white-space: pre-wrap;\n    padding: 10px;\n  `,\n  inlineEditorClose: css`\n    margin-left: auto;\n  `,\n  placeholder: css`\n    width: 24px;\n    height: 24px;\n    visibility: hidden;\n    margin-right: auto;\n  `,\n  inlineEditorContentWrapper: css`\n    overflow: scroll;\n  `\n});","map":{"version":3,"names":["css","React","useRef","useState","Draggable","Resizable","IconButton","Portal","useStyles2","store","InlineEditBody","OFFSET_X","InlineEdit","onClose","btnInlineEdit","document","querySelector","getBoundingClientRect","ref","styles","getStyles","inlineEditKey","defaultMeasurements","width","height","defaultX","x","defaultY","y","savedPlacement","getObject","w","h","measurements","setMeasurements","placement","setPlacement","onDragStop","event","dragElement","saveToStore","onResizeStop","data","size","setObject","draggableWrapper","inlineEditorContainer","inlineEditorHeader","placeholder","inlineEditorClose","inlineEditorContentWrapper","inlineEditorContent","theme","v1","colors","panelBg","background","canvas","border","weak"],"sources":["/home/soula/grafana/public/app/plugins/panel/canvas/InlineEdit.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { SyntheticEvent, useRef, useState } from 'react';\nimport Draggable from 'react-draggable';\nimport { Resizable, ResizeCallbackData } from 'react-resizable';\n\nimport { Dimensions2D, GrafanaTheme2 } from '@grafana/data';\nimport { IconButton, Portal, useStyles2 } from '@grafana/ui';\nimport store from 'app/core/store';\n\nimport { InlineEditBody } from './InlineEditBody';\n\ntype Props = {\n  onClose?: () => void;\n};\n\nconst OFFSET_X = 70;\n\nexport const InlineEdit = ({ onClose }: Props) => {\n  const btnInlineEdit = document.querySelector('[data-btninlineedit]')!.getBoundingClientRect();\n  const ref = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const inlineEditKey = 'inlineEditPanel';\n\n  const defaultMeasurements = { width: 350, height: 400 };\n  const defaultX = btnInlineEdit.x + OFFSET_X;\n  const defaultY = btnInlineEdit.y - defaultMeasurements.height;\n\n  const savedPlacement = store.getObject(inlineEditKey, {\n    x: defaultX,\n    y: defaultY,\n    w: defaultMeasurements.width,\n    h: defaultMeasurements.height,\n  });\n  const [measurements, setMeasurements] = useState<Dimensions2D>({ width: savedPlacement.w, height: savedPlacement.h });\n  const [placement, setPlacement] = useState({ x: savedPlacement.x, y: savedPlacement.y });\n\n  const onDragStop = (event: any, dragElement: any) => {\n    let x = dragElement.x < 0 ? 0 : dragElement.x;\n    let y = dragElement.y < 0 ? 0 : dragElement.y;\n\n    setPlacement({ x: x, y: y });\n    saveToStore(x, y, measurements.width, measurements.height);\n  };\n\n  const onResizeStop = (event: SyntheticEvent<Element, Event>, data: ResizeCallbackData) => {\n    const { size } = data;\n    setMeasurements({ width: size.width, height: size.height });\n    saveToStore(placement.x, placement.y, size.width, size.height);\n  };\n\n  const saveToStore = (x: number, y: number, width: number, height: number) => {\n    store.setObject(inlineEditKey, { x: x, y: y, w: width, h: height });\n  };\n\n  return (\n    <Portal>\n      <div className={styles.draggableWrapper}>\n        <Draggable handle=\"strong\" onStop={onDragStop} position={{ x: placement.x, y: placement.y }}>\n          <Resizable height={measurements.height} width={measurements.width} onResize={onResizeStop}>\n            <div\n              className={styles.inlineEditorContainer}\n              style={{ height: `${measurements.height}px`, width: `${measurements.width}px` }}\n              ref={ref}\n            >\n              <strong className={styles.inlineEditorHeader}>\n                <div className={styles.placeholder} />\n                <div>Canvas Inline Editor</div>\n                <IconButton name=\"times\" size=\"xl\" className={styles.inlineEditorClose} onClick={onClose} />\n              </strong>\n              <div className={styles.inlineEditorContentWrapper}>\n                <div className={styles.inlineEditorContent}>\n                  <InlineEditBody />\n                </div>\n              </div>\n            </div>\n          </Resizable>\n        </Draggable>\n      </div>\n    </Portal>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  inlineEditorContainer: css`\n    display: flex;\n    flex-direction: column;\n    background: ${theme.v1.colors.panelBg};\n    box-shadow: 5px 5px 20px -5px #000000;\n    z-index: 1000;\n    opacity: 1;\n  `,\n  draggableWrapper: css`\n    width: 0;\n    height: 0;\n  `,\n  inlineEditorHeader: css`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: ${theme.colors.background.canvas};\n    border: 1px solid ${theme.colors.border.weak};\n    height: 40px;\n    cursor: move;\n  `,\n  inlineEditorContent: css`\n    white-space: pre-wrap;\n    padding: 10px;\n  `,\n  inlineEditorClose: css`\n    margin-left: auto;\n  `,\n  placeholder: css`\n    width: 24px;\n    height: 24px;\n    visibility: hidden;\n    margin-right: auto;\n  `,\n  inlineEditorContentWrapper: css`\n    overflow: scroll;\n  `,\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}