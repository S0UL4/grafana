{"ast":null,"code":"import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { useStyles2, MenuGroup, MenuItem, Icon, ContextMenu } from '@grafana/ui';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nconst renderMenuItems = (links, styles, closeMenu) => {\n  var _links$logLinks, _links$metricLinks, _links$traceLinks;\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [!!((_links$logLinks = links.logLinks) !== null && _links$logLinks !== void 0 && _links$logLinks.length) ? /*#__PURE__*/_jsx(MenuGroup, {\n      label: \"Logs\",\n      children: links.logLinks.map((link, i) => /*#__PURE__*/_jsx(MenuItem, {\n        label: \"Logs for this span\",\n        onClick: link.onClick ? event => {\n          event === null || event === void 0 ? void 0 : event.preventDefault();\n          link.onClick(event);\n          closeMenu();\n        } : undefined,\n        url: link.href,\n        className: styles.menuItem\n      }, i))\n    }) : null, !!((_links$metricLinks = links.metricLinks) !== null && _links$metricLinks !== void 0 && _links$metricLinks.length) ? /*#__PURE__*/_jsx(MenuGroup, {\n      label: \"Metrics\",\n      children: links.metricLinks.map((link, i) => {\n        var _link$title;\n\n        return /*#__PURE__*/_jsx(MenuItem, {\n          label: (_link$title = link.title) !== null && _link$title !== void 0 ? _link$title : 'Metrics for this span',\n          onClick: link.onClick ? event => {\n            event === null || event === void 0 ? void 0 : event.preventDefault();\n            link.onClick(event);\n            closeMenu();\n          } : undefined,\n          url: link.href,\n          className: styles.menuItem\n        }, i);\n      })\n    }) : null, !!((_links$traceLinks = links.traceLinks) !== null && _links$traceLinks !== void 0 && _links$traceLinks.length) ? /*#__PURE__*/_jsx(MenuGroup, {\n      label: \"Traces\",\n      children: links.traceLinks.map((link, i) => {\n        var _link$title2;\n\n        return /*#__PURE__*/_jsx(MenuItem, {\n          label: (_link$title2 = link.title) !== null && _link$title2 !== void 0 ? _link$title2 : 'View linked span',\n          onClick: link.onClick ? event => {\n            event === null || event === void 0 ? void 0 : event.preventDefault();\n            link.onClick(event);\n            closeMenu();\n          } : undefined,\n          url: link.href,\n          className: styles.menuItem\n        }, i);\n      })\n    }) : null]\n  });\n};\n\nexport const SpanLinksMenu = ({\n  links\n}) => {\n  const styles = useStyles2(getStyles);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({\n    x: 0,\n    y: 0\n  });\n\n  const closeMenu = () => setIsMenuOpen(false);\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    \"data-testid\": \"SpanLinksMenu\",\n    children: [/*#__PURE__*/_jsx(\"button\", {\n      onClick: e => {\n        setIsMenuOpen(true);\n        setMenuPosition({\n          x: e.pageX,\n          y: e.pageY\n        });\n      },\n      className: styles.button,\n      children: /*#__PURE__*/_jsx(Icon, {\n        name: \"link\",\n        className: styles.button\n      })\n    }), isMenuOpen ? /*#__PURE__*/_jsx(ContextMenu, {\n      onClose: () => setIsMenuOpen(false),\n      renderMenuItems: () => renderMenuItems(links, styles, closeMenu),\n      focusOnOpen: true,\n      x: menuPosition.x,\n      y: menuPosition.y\n    }) : null]\n  });\n};\n\nconst getStyles = () => {\n  return {\n    button: css`\n      background: transparent;\n      border: none;\n      padding: 0;\n      margin: 0 3px 0 0;\n    `,\n    menuItem: css`\n      max-width: 60ch;\n      overflow: hidden;\n    `\n  };\n};","map":{"version":3,"names":["css","React","useState","useStyles2","MenuGroup","MenuItem","Icon","ContextMenu","renderMenuItems","links","styles","closeMenu","logLinks","length","map","link","i","onClick","event","preventDefault","undefined","href","menuItem","metricLinks","title","traceLinks","SpanLinksMenu","getStyles","isMenuOpen","setIsMenuOpen","menuPosition","setMenuPosition","x","y","e","pageX","pageY","button"],"sources":["/home/soula/grafana/packages/jaeger-ui-components/src/TraceTimelineViewer/SpanLinks.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { useState } from 'react';\n\nimport { useStyles2, MenuGroup, MenuItem, Icon, ContextMenu } from '@grafana/ui';\n\nimport { SpanLinks } from '../types/links';\n\ninterface SpanLinksProps {\n  links: SpanLinks;\n}\n\nconst renderMenuItems = (links: SpanLinks, styles: ReturnType<typeof getStyles>, closeMenu: () => void) => {\n  return (\n    <>\n      {!!links.logLinks?.length ? (\n        <MenuGroup label=\"Logs\">\n          {links.logLinks.map((link, i) => (\n            <MenuItem\n              key={i}\n              label=\"Logs for this span\"\n              onClick={\n                link.onClick\n                  ? (event) => {\n                      event?.preventDefault();\n                      link.onClick!(event);\n                      closeMenu();\n                    }\n                  : undefined\n              }\n              url={link.href}\n              className={styles.menuItem}\n            />\n          ))}\n        </MenuGroup>\n      ) : null}\n      {!!links.metricLinks?.length ? (\n        <MenuGroup label=\"Metrics\">\n          {links.metricLinks.map((link, i) => (\n            <MenuItem\n              key={i}\n              label={link.title ?? 'Metrics for this span'}\n              onClick={\n                link.onClick\n                  ? (event) => {\n                      event?.preventDefault();\n                      link.onClick!(event);\n                      closeMenu();\n                    }\n                  : undefined\n              }\n              url={link.href}\n              className={styles.menuItem}\n            />\n          ))}\n        </MenuGroup>\n      ) : null}\n      {!!links.traceLinks?.length ? (\n        <MenuGroup label=\"Traces\">\n          {links.traceLinks.map((link, i) => (\n            <MenuItem\n              key={i}\n              label={link.title ?? 'View linked span'}\n              onClick={\n                link.onClick\n                  ? (event) => {\n                      event?.preventDefault();\n                      link.onClick!(event);\n                      closeMenu();\n                    }\n                  : undefined\n              }\n              url={link.href}\n              className={styles.menuItem}\n            />\n          ))}\n        </MenuGroup>\n      ) : null}\n    </>\n  );\n};\n\nexport const SpanLinksMenu = ({ links }: SpanLinksProps) => {\n  const styles = useStyles2(getStyles);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({ x: 0, y: 0 });\n\n  const closeMenu = () => setIsMenuOpen(false);\n\n  return (\n    <div data-testid=\"SpanLinksMenu\">\n      <button\n        onClick={(e) => {\n          setIsMenuOpen(true);\n          setMenuPosition({\n            x: e.pageX,\n            y: e.pageY,\n          });\n        }}\n        className={styles.button}\n      >\n        <Icon name=\"link\" className={styles.button} />\n      </button>\n\n      {isMenuOpen ? (\n        <ContextMenu\n          onClose={() => setIsMenuOpen(false)}\n          renderMenuItems={() => renderMenuItems(links, styles, closeMenu)}\n          focusOnOpen={true}\n          x={menuPosition.x}\n          y={menuPosition.y}\n        />\n      ) : null}\n    </div>\n  );\n};\n\nconst getStyles = () => {\n  return {\n    button: css`\n      background: transparent;\n      border: none;\n      padding: 0;\n      margin: 0 3px 0 0;\n    `,\n    menuItem: css`\n      max-width: 60ch;\n      overflow: hidden;\n    `,\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}