{"ast":null,"code":"var _Icon;\n\nimport { css } from '@emotion/css';\nimport React from 'react';\nimport { Draggable } from 'react-beautiful-dnd';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { reportInteraction } from '@grafana/runtime';\nimport { Button, Icon, IconButton, useStyles2, useTheme2 } from '@grafana/ui';\nimport { hasOptions, isAdHoc, isQuery } from '../guard';\nimport { VariableUsagesButton } from '../inspect/VariableUsagesButton';\nimport { getVariableUsages } from '../inspect/utils';\nimport { toKeyedVariableIdentifier } from '../utils';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function VariableEditorListRow({\n  index,\n  variable,\n  usageTree,\n  usagesNetwork,\n  onEdit: propsOnEdit,\n  onDuplicate: propsOnDuplicate,\n  onDelete: propsOnDelete\n}) {\n  var _VariableCheckIndicat;\n\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const definition = getDefinition(variable);\n  const usages = getVariableUsages(variable.id, usageTree);\n  const passed = usages > 0 || isAdHoc(variable);\n  const identifier = toKeyedVariableIdentifier(variable);\n  return /*#__PURE__*/_jsx(Draggable, {\n    draggableId: JSON.stringify(identifier),\n    index: index,\n    children: (provided, snapshot) => /*#__PURE__*/_jsxs(\"tr\", Object.assign({\n      ref: provided.innerRef\n    }, provided.draggableProps, {\n      style: Object.assign({\n        userSelect: snapshot.isDragging ? 'none' : 'auto',\n        background: snapshot.isDragging ? theme.colors.background.secondary : undefined\n      }, provided.draggableProps.style),\n      children: [/*#__PURE__*/_jsx(\"td\", {\n        className: styles.column,\n        children: /*#__PURE__*/_jsx(Button, {\n          size: \"xs\",\n          fill: \"text\",\n          onClick: event => {\n            event.preventDefault();\n            propsOnEdit(identifier);\n          },\n          className: styles.nameLink,\n          \"aria-label\": selectors.pages.Dashboard.Settings.Variables.List.tableRowNameFields(variable.name),\n          children: variable.name\n        })\n      }), /*#__PURE__*/_jsx(\"td\", {\n        className: styles.definitionColumn,\n        onClick: event => {\n          event.preventDefault();\n          propsOnEdit(identifier);\n        },\n        \"aria-label\": selectors.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(variable.name),\n        children: definition\n      }), /*#__PURE__*/_jsx(\"td\", {\n        className: styles.column,\n        children: _VariableCheckIndicat || (_VariableCheckIndicat = /*#__PURE__*/_jsx(VariableCheckIndicator, {\n          passed: passed\n        }))\n      }), /*#__PURE__*/_jsx(\"td\", {\n        className: styles.column,\n        children: /*#__PURE__*/_jsx(VariableUsagesButton, {\n          id: variable.id,\n          isAdhoc: isAdHoc(variable),\n          usages: usagesNetwork\n        })\n      }), /*#__PURE__*/_jsx(\"td\", {\n        className: styles.column,\n        children: /*#__PURE__*/_jsx(IconButton, {\n          onClick: event => {\n            event.preventDefault();\n            reportInteraction('Duplicate variable');\n            propsOnDuplicate(identifier);\n          },\n          name: \"copy\",\n          title: \"Duplicate variable\",\n          \"aria-label\": selectors.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(variable.name)\n        })\n      }), /*#__PURE__*/_jsx(\"td\", {\n        className: styles.column,\n        children: /*#__PURE__*/_jsx(IconButton, {\n          onClick: event => {\n            event.preventDefault();\n            reportInteraction('Delete variable');\n            propsOnDelete(identifier);\n          },\n          name: \"trash-alt\",\n          title: \"Remove variable\",\n          \"aria-label\": selectors.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(variable.name)\n        })\n      }), /*#__PURE__*/_jsx(\"td\", {\n        className: styles.column,\n        children: /*#__PURE__*/_jsx(\"div\", Object.assign({}, provided.dragHandleProps, {\n          className: styles.dragHandle,\n          children: _Icon || (_Icon = /*#__PURE__*/_jsx(Icon, {\n            name: \"draggabledots\",\n            size: \"lg\"\n          }))\n        }))\n      })]\n    }))\n  });\n}\n\nfunction getDefinition(model) {\n  let definition = '';\n\n  if (isQuery(model)) {\n    if (model.definition) {\n      definition = model.definition;\n    } else if (typeof model.query === 'string') {\n      definition = model.query;\n    }\n  } else if (hasOptions(model)) {\n    definition = model.query;\n  }\n\n  return definition;\n}\n\nfunction VariableCheckIndicator({\n  passed\n}) {\n  const styles = useStyles2(getStyles);\n\n  if (passed) {\n    return /*#__PURE__*/_jsx(Icon, {\n      name: \"check\",\n      className: styles.iconPassed,\n      title: \"This variable is referenced by other variables or dashboard.\"\n    });\n  }\n\n  return /*#__PURE__*/_jsx(Icon, {\n    name: \"exclamation-triangle\",\n    className: styles.iconFailed,\n    title: \"This variable is not referenced by any variable or dashboard.\"\n  });\n}\n\nfunction getStyles(theme) {\n  return {\n    dragHandle: css`\n      cursor: grab;\n    `,\n    column: css`\n      width: 1%;\n    `,\n    nameLink: css`\n      cursor: pointer;\n      color: ${theme.colors.primary.text};\n    `,\n    definitionColumn: css`\n      width: 100%;\n      max-width: 200px;\n      cursor: pointer;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      -o-text-overflow: ellipsis;\n      white-space: nowrap;\n    `,\n    iconPassed: css`\n      color: ${theme.v1.palette.greenBase};\n    `,\n    iconFailed: css`\n      color: ${theme.v1.palette.orange};\n    `\n  };\n}","map":{"version":3,"names":["css","React","Draggable","selectors","reportInteraction","Button","Icon","IconButton","useStyles2","useTheme2","hasOptions","isAdHoc","isQuery","VariableUsagesButton","getVariableUsages","toKeyedVariableIdentifier","VariableEditorListRow","index","variable","usageTree","usagesNetwork","onEdit","propsOnEdit","onDuplicate","propsOnDuplicate","onDelete","propsOnDelete","theme","styles","getStyles","definition","getDefinition","usages","id","passed","identifier","JSON","stringify","provided","snapshot","innerRef","draggableProps","userSelect","isDragging","background","colors","secondary","undefined","style","column","event","preventDefault","nameLink","pages","Dashboard","Settings","Variables","List","tableRowNameFields","name","definitionColumn","tableRowDefinitionFields","tableRowDuplicateButtons","tableRowRemoveButtons","dragHandleProps","dragHandle","model","query","VariableCheckIndicator","iconPassed","iconFailed","primary","text","v1","palette","greenBase","orange"],"sources":["/home/soula/grafana/public/app/features/variables/editor/VariableEditorListRow.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { ReactElement } from 'react';\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { reportInteraction } from '@grafana/runtime';\nimport { Button, Icon, IconButton, useStyles2, useTheme2 } from '@grafana/ui';\n\nimport { hasOptions, isAdHoc, isQuery } from '../guard';\nimport { VariableUsagesButton } from '../inspect/VariableUsagesButton';\nimport { getVariableUsages, UsagesToNetwork, VariableUsageTree } from '../inspect/utils';\nimport { KeyedVariableIdentifier } from '../state/types';\nimport { VariableModel } from '../types';\nimport { toKeyedVariableIdentifier } from '../utils';\n\nexport interface VariableEditorListRowProps {\n  index: number;\n  variable: VariableModel;\n  usageTree: VariableUsageTree[];\n  usagesNetwork: UsagesToNetwork[];\n  onEdit: (identifier: KeyedVariableIdentifier) => void;\n  onDuplicate: (identifier: KeyedVariableIdentifier) => void;\n  onDelete: (identifier: KeyedVariableIdentifier) => void;\n}\n\nexport function VariableEditorListRow({\n  index,\n  variable,\n  usageTree,\n  usagesNetwork,\n  onEdit: propsOnEdit,\n  onDuplicate: propsOnDuplicate,\n  onDelete: propsOnDelete,\n}: VariableEditorListRowProps): ReactElement {\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const definition = getDefinition(variable);\n  const usages = getVariableUsages(variable.id, usageTree);\n  const passed = usages > 0 || isAdHoc(variable);\n  const identifier = toKeyedVariableIdentifier(variable);\n\n  return (\n    <Draggable draggableId={JSON.stringify(identifier)} index={index}>\n      {(provided, snapshot) => (\n        <tr\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n          style={{\n            userSelect: snapshot.isDragging ? 'none' : 'auto',\n            background: snapshot.isDragging ? theme.colors.background.secondary : undefined,\n            ...provided.draggableProps.style,\n          }}\n        >\n          <td className={styles.column}>\n            <Button\n              size=\"xs\"\n              fill=\"text\"\n              onClick={(event) => {\n                event.preventDefault();\n                propsOnEdit(identifier);\n              }}\n              className={styles.nameLink}\n              aria-label={selectors.pages.Dashboard.Settings.Variables.List.tableRowNameFields(variable.name)}\n            >\n              {variable.name}\n            </Button>\n          </td>\n          <td\n            className={styles.definitionColumn}\n            onClick={(event) => {\n              event.preventDefault();\n              propsOnEdit(identifier);\n            }}\n            aria-label={selectors.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(variable.name)}\n          >\n            {definition}\n          </td>\n\n          <td className={styles.column}>\n            <VariableCheckIndicator passed={passed} />\n          </td>\n\n          <td className={styles.column}>\n            <VariableUsagesButton id={variable.id} isAdhoc={isAdHoc(variable)} usages={usagesNetwork} />\n          </td>\n\n          <td className={styles.column}>\n            <IconButton\n              onClick={(event) => {\n                event.preventDefault();\n                reportInteraction('Duplicate variable');\n                propsOnDuplicate(identifier);\n              }}\n              name=\"copy\"\n              title=\"Duplicate variable\"\n              aria-label={selectors.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(variable.name)}\n            />\n          </td>\n\n          <td className={styles.column}>\n            <IconButton\n              onClick={(event) => {\n                event.preventDefault();\n                reportInteraction('Delete variable');\n                propsOnDelete(identifier);\n              }}\n              name=\"trash-alt\"\n              title=\"Remove variable\"\n              aria-label={selectors.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(variable.name)}\n            />\n          </td>\n          <td className={styles.column}>\n            <div {...provided.dragHandleProps} className={styles.dragHandle}>\n              <Icon name=\"draggabledots\" size=\"lg\" />\n            </div>\n          </td>\n        </tr>\n      )}\n    </Draggable>\n  );\n}\n\nfunction getDefinition(model: VariableModel): string {\n  let definition = '';\n  if (isQuery(model)) {\n    if (model.definition) {\n      definition = model.definition;\n    } else if (typeof model.query === 'string') {\n      definition = model.query;\n    }\n  } else if (hasOptions(model)) {\n    definition = model.query;\n  }\n\n  return definition;\n}\n\ninterface VariableCheckIndicatorProps {\n  passed: boolean;\n}\n\nfunction VariableCheckIndicator({ passed }: VariableCheckIndicatorProps): ReactElement {\n  const styles = useStyles2(getStyles);\n  if (passed) {\n    return (\n      <Icon\n        name=\"check\"\n        className={styles.iconPassed}\n        title=\"This variable is referenced by other variables or dashboard.\"\n      />\n    );\n  }\n\n  return (\n    <Icon\n      name=\"exclamation-triangle\"\n      className={styles.iconFailed}\n      title=\"This variable is not referenced by any variable or dashboard.\"\n    />\n  );\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    dragHandle: css`\n      cursor: grab;\n    `,\n    column: css`\n      width: 1%;\n    `,\n    nameLink: css`\n      cursor: pointer;\n      color: ${theme.colors.primary.text};\n    `,\n    definitionColumn: css`\n      width: 100%;\n      max-width: 200px;\n      cursor: pointer;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      -o-text-overflow: ellipsis;\n      white-space: nowrap;\n    `,\n    iconPassed: css`\n      color: ${theme.v1.palette.greenBase};\n    `,\n    iconFailed: css`\n      color: ${theme.v1.palette.orange};\n    `,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}