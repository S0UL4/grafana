{"ast":null,"code":"import { useEffect, useMemo, useState } from 'react';\nexport function useAsyncState(asyncFn, setError, dependencies) {\n  // Use the lazy initial state functionality of useState to assign a random ID to the API call\n  // to track where errors come from. See useLastError.\n  const [errorSource] = useState(() => Math.random());\n  const [value, setValue] = useState();\n  const finalValue = useMemo(() => value !== null && value !== void 0 ? value : [], [value]);\n  useEffect(() => {\n    asyncFn().then(results => {\n      setValue(results);\n      setError(errorSource, undefined);\n    }).catch(err => {\n      setError(errorSource, err);\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n  return finalValue;\n}","map":{"version":3,"names":["useEffect","useMemo","useState","useAsyncState","asyncFn","setError","dependencies","errorSource","Math","random","value","setValue","finalValue","then","results","undefined","catch","err"],"sources":["/home/soula/grafana/public/app/plugins/datasource/grafana-azure-monitor-datasource/utils/useAsyncState.ts"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\n\nexport function useAsyncState<T>(asyncFn: () => Promise<T>, setError: Function, dependencies: unknown[]) {\n  // Use the lazy initial state functionality of useState to assign a random ID to the API call\n  // to track where errors come from. See useLastError.\n  const [errorSource] = useState(() => Math.random());\n  const [value, setValue] = useState<T>();\n\n  const finalValue = useMemo(() => value ?? [], [value]);\n\n  useEffect(() => {\n    asyncFn()\n      .then((results) => {\n        setValue(results);\n        setError(errorSource, undefined);\n      })\n      .catch((err) => {\n        setError(errorSource, err);\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n\n  return finalValue;\n}\n"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,OAApB,EAA6BC,QAA7B,QAA6C,OAA7C;AAEA,OAAO,SAASC,aAAT,CAA0BC,OAA1B,EAAqDC,QAArD,EAAyEC,YAAzE,EAAkG;EACvG;EACA;EACA,MAAM,CAACC,WAAD,IAAgBL,QAAQ,CAAC,MAAMM,IAAI,CAACC,MAAL,EAAP,CAA9B;EACA,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBT,QAAQ,EAAlC;EAEA,MAAMU,UAAU,GAAGX,OAAO,CAAC,MAAMS,KAAN,aAAMA,KAAN,cAAMA,KAAN,GAAe,EAAhB,EAAoB,CAACA,KAAD,CAApB,CAA1B;EAEAV,SAAS,CAAC,MAAM;IACdI,OAAO,GACJS,IADH,CACSC,OAAD,IAAa;MACjBH,QAAQ,CAACG,OAAD,CAAR;MACAT,QAAQ,CAACE,WAAD,EAAcQ,SAAd,CAAR;IACD,CAJH,EAKGC,KALH,CAKUC,GAAD,IAAS;MACdZ,QAAQ,CAACE,WAAD,EAAcU,GAAd,CAAR;IACD,CAPH,EADc,CASd;EACD,CAVQ,EAUNX,YAVM,CAAT;EAYA,OAAOM,UAAP;AACD"},"metadata":{},"sourceType":"module"}