{"ast":null,"code":"import { css, cx } from '@emotion/css';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { Button, ClickOutsideWrapper, HorizontalGroup, IconButton, Label, VerticalGroup } from '..';\nimport { stylesFactory, useStyles, useTheme2 } from '../../themes';\nimport { FilterList } from './FilterList';\nimport { calculateUniqueFieldValues, getFilteredOptions, valuesToOptions } from './utils';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const FilterPopup = ({\n  column: {\n    preFilteredRows,\n    filterValue,\n    setFilter\n  },\n  onClose,\n  field\n}) => {\n  const theme = useTheme2();\n  const uniqueValues = useMemo(() => calculateUniqueFieldValues(preFilteredRows, field), [preFilteredRows, field]);\n  const options = useMemo(() => valuesToOptions(uniqueValues), [uniqueValues]);\n  const filteredOptions = useMemo(() => getFilteredOptions(options, filterValue), [options, filterValue]);\n  const [values, setValues] = useState(filteredOptions);\n  const [matchCase, setMatchCase] = useState(false);\n  const onCancel = useCallback(event => onClose(), [onClose]);\n  const onFilter = useCallback(event => {\n    const filtered = values.length ? values : undefined;\n    setFilter(filtered);\n    onClose();\n  }, [setFilter, values, onClose]);\n  const onClearFilter = useCallback(event => {\n    setFilter(undefined);\n    onClose();\n  }, [setFilter, onClose]);\n  const clearFilterVisible = useMemo(() => filterValue !== undefined, [filterValue]);\n  const styles = useStyles(getStyles);\n  return /*#__PURE__*/_jsx(ClickOutsideWrapper, {\n    onClick: onCancel,\n    useCapture: true,\n    children: /*#__PURE__*/_jsx(\"div\", {\n      className: cx(styles.filterContainer),\n      onClick: stopPropagation,\n      children: /*#__PURE__*/_jsxs(VerticalGroup, {\n        spacing: \"lg\",\n        children: [/*#__PURE__*/_jsxs(VerticalGroup, {\n          spacing: \"xs\",\n          children: [/*#__PURE__*/_jsxs(HorizontalGroup, {\n            justify: \"space-between\",\n            align: \"center\",\n            children: [/*#__PURE__*/_jsx(Label, {\n              className: styles.label,\n              children: \"Filter by values:\"\n            }), /*#__PURE__*/_jsx(IconButton, {\n              name: \"text-fields\",\n              tooltip: \"Match case\",\n              style: {\n                color: matchCase ? theme.colors.text.link : theme.colors.text.disabled\n              },\n              onClick: () => {\n                setMatchCase(s => !s);\n              }\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: cx(styles.listDivider)\n          }), /*#__PURE__*/_jsx(FilterList, {\n            onChange: setValues,\n            values: values,\n            options: options,\n            caseSensitive: matchCase\n          })]\n        }), /*#__PURE__*/_jsxs(HorizontalGroup, {\n          spacing: \"lg\",\n          children: [/*#__PURE__*/_jsxs(HorizontalGroup, {\n            children: [/*#__PURE__*/_jsx(Button, {\n              size: \"sm\",\n              onClick: onFilter,\n              children: \"Ok\"\n            }), /*#__PURE__*/_jsx(Button, {\n              size: \"sm\",\n              variant: \"secondary\",\n              onClick: onCancel,\n              children: \"Cancel\"\n            })]\n          }), clearFilterVisible && /*#__PURE__*/_jsx(HorizontalGroup, {\n            children: /*#__PURE__*/_jsx(Button, {\n              fill: \"text\",\n              size: \"sm\",\n              onClick: onClearFilter,\n              children: \"Clear filter\"\n            })\n          })]\n        })]\n      })\n    })\n  });\n};\nconst getStyles = stylesFactory(theme => ({\n  filterContainer: css`\n    label: filterContainer;\n    width: 100%;\n    min-width: 250px;\n    height: 100%;\n    max-height: 400px;\n    background-color: ${theme.colors.bg1};\n    border: ${theme.border.width.sm} solid ${theme.colors.border2};\n    padding: ${theme.spacing.md};\n    margin: ${theme.spacing.sm} 0;\n    box-shadow: 0px 0px 20px ${theme.colors.dropdownShadow};\n    border-radius: ${theme.spacing.xs};\n  `,\n  listDivider: css`\n    label: listDivider;\n    width: 100%;\n    border-top: ${theme.border.width.sm} solid ${theme.colors.border2};\n    padding: ${theme.spacing.xs} ${theme.spacing.md};\n  `,\n  label: css`\n    margin-bottom: 0;\n  `\n}));\n\nconst stopPropagation = event => {\n  event.stopPropagation();\n};","map":{"version":3,"names":["css","cx","React","useCallback","useMemo","useState","Button","ClickOutsideWrapper","HorizontalGroup","IconButton","Label","VerticalGroup","stylesFactory","useStyles","useTheme2","FilterList","calculateUniqueFieldValues","getFilteredOptions","valuesToOptions","FilterPopup","column","preFilteredRows","filterValue","setFilter","onClose","field","theme","uniqueValues","options","filteredOptions","values","setValues","matchCase","setMatchCase","onCancel","event","onFilter","filtered","length","undefined","onClearFilter","clearFilterVisible","styles","getStyles","filterContainer","stopPropagation","label","color","colors","text","link","disabled","s","listDivider","bg1","border","width","sm","border2","spacing","md","dropdownShadow","xs"],"sources":["/home/soula/grafana/packages/grafana-ui/src/components/Table/FilterPopup.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { Field, GrafanaTheme, SelectableValue } from '@grafana/data';\n\nimport { Button, ClickOutsideWrapper, HorizontalGroup, IconButton, Label, VerticalGroup } from '..';\nimport { stylesFactory, useStyles, useTheme2 } from '../../themes';\n\nimport { FilterList } from './FilterList';\nimport { TableStyles } from './styles';\nimport { calculateUniqueFieldValues, getFilteredOptions, valuesToOptions } from './utils';\n\ninterface Props {\n  column: any;\n  tableStyles: TableStyles;\n  onClose: () => void;\n  field?: Field;\n}\n\nexport const FilterPopup: FC<Props> = ({ column: { preFilteredRows, filterValue, setFilter }, onClose, field }) => {\n  const theme = useTheme2();\n  const uniqueValues = useMemo(() => calculateUniqueFieldValues(preFilteredRows, field), [preFilteredRows, field]);\n  const options = useMemo(() => valuesToOptions(uniqueValues), [uniqueValues]);\n  const filteredOptions = useMemo(() => getFilteredOptions(options, filterValue), [options, filterValue]);\n  const [values, setValues] = useState<SelectableValue[]>(filteredOptions);\n  const [matchCase, setMatchCase] = useState(false);\n\n  const onCancel = useCallback((event?: React.MouseEvent) => onClose(), [onClose]);\n\n  const onFilter = useCallback(\n    (event: React.MouseEvent) => {\n      const filtered = values.length ? values : undefined;\n\n      setFilter(filtered);\n      onClose();\n    },\n    [setFilter, values, onClose]\n  );\n\n  const onClearFilter = useCallback(\n    (event: React.MouseEvent) => {\n      setFilter(undefined);\n      onClose();\n    },\n    [setFilter, onClose]\n  );\n\n  const clearFilterVisible = useMemo(() => filterValue !== undefined, [filterValue]);\n  const styles = useStyles(getStyles);\n\n  return (\n    <ClickOutsideWrapper onClick={onCancel} useCapture={true}>\n      <div className={cx(styles.filterContainer)} onClick={stopPropagation}>\n        <VerticalGroup spacing=\"lg\">\n          <VerticalGroup spacing=\"xs\">\n            <HorizontalGroup justify=\"space-between\" align=\"center\">\n              <Label className={styles.label}>Filter by values:</Label>\n              <IconButton\n                name=\"text-fields\"\n                tooltip=\"Match case\"\n                style={{ color: matchCase ? theme.colors.text.link : theme.colors.text.disabled }}\n                onClick={() => {\n                  setMatchCase((s) => !s);\n                }}\n              />\n            </HorizontalGroup>\n            <div className={cx(styles.listDivider)} />\n            <FilterList onChange={setValues} values={values} options={options} caseSensitive={matchCase} />\n          </VerticalGroup>\n          <HorizontalGroup spacing=\"lg\">\n            <HorizontalGroup>\n              <Button size=\"sm\" onClick={onFilter}>\n                Ok\n              </Button>\n              <Button size=\"sm\" variant=\"secondary\" onClick={onCancel}>\n                Cancel\n              </Button>\n            </HorizontalGroup>\n            {clearFilterVisible && (\n              <HorizontalGroup>\n                <Button fill=\"text\" size=\"sm\" onClick={onClearFilter}>\n                  Clear filter\n                </Button>\n              </HorizontalGroup>\n            )}\n          </HorizontalGroup>\n        </VerticalGroup>\n      </div>\n    </ClickOutsideWrapper>\n  );\n};\n\nconst getStyles = stylesFactory((theme: GrafanaTheme) => ({\n  filterContainer: css`\n    label: filterContainer;\n    width: 100%;\n    min-width: 250px;\n    height: 100%;\n    max-height: 400px;\n    background-color: ${theme.colors.bg1};\n    border: ${theme.border.width.sm} solid ${theme.colors.border2};\n    padding: ${theme.spacing.md};\n    margin: ${theme.spacing.sm} 0;\n    box-shadow: 0px 0px 20px ${theme.colors.dropdownShadow};\n    border-radius: ${theme.spacing.xs};\n  `,\n  listDivider: css`\n    label: listDivider;\n    width: 100%;\n    border-top: ${theme.border.width.sm} solid ${theme.colors.border2};\n    padding: ${theme.spacing.xs} ${theme.spacing.md};\n  `,\n  label: css`\n    margin-bottom: 0;\n  `,\n}));\n\nconst stopPropagation = (event: React.MouseEvent) => {\n  event.stopPropagation();\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}