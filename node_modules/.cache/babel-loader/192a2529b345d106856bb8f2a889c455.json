{"ast":null,"code":"import { css } from '@emotion/css';\nimport React from 'react';\nimport { useMeasure } from 'react-use';\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { getFocusStyles } from '../../themes/mixins';\nimport { CustomScrollbar } from '../CustomScrollbar/CustomScrollbar';\n/**\n * @beta\n */\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\n/**\n * @beta\n */\nexport const VizLayout = ({\n  width,\n  height,\n  legend,\n  children\n}) => {\n  var _size, _size2;\n\n  const styles = useStyles2(getVizStyles);\n  const containerStyle = {\n    display: 'flex',\n    width: `${width}px`,\n    height: `${height}px`\n  };\n  const [legendRef, legendMeasure] = useMeasure();\n\n  if (!legend) {\n    return /*#__PURE__*/_jsx(\"div\", {\n      tabIndex: 0,\n      style: containerStyle,\n      className: styles.viz,\n      children: children(width, height)\n    });\n  }\n\n  const {\n    placement,\n    maxHeight = '35%',\n    maxWidth = '60%'\n  } = legend.props;\n  let size = null;\n  const legendStyle = {};\n\n  switch (placement) {\n    case 'bottom':\n      containerStyle.flexDirection = 'column';\n      legendStyle.maxHeight = maxHeight;\n\n      if (legendMeasure) {\n        size = {\n          width,\n          height: height - legendMeasure.height\n        };\n      }\n\n      break;\n\n    case 'right':\n      containerStyle.flexDirection = 'row';\n      legendStyle.maxWidth = maxWidth;\n\n      if (legendMeasure) {\n        size = {\n          width: width - legendMeasure.width,\n          height\n        };\n      }\n\n      if (legend.props.width) {\n        legendStyle.width = legend.props.width;\n        size = {\n          width: width - legend.props.width,\n          height\n        };\n      }\n\n      break;\n  } // This happens when position is switched from bottom to right\n  // Then we preserve old with for one render cycle until legend is measured in it's new position\n\n\n  if (((_size = size) === null || _size === void 0 ? void 0 : _size.width) === 0) {\n    size.width = width;\n  }\n\n  if (((_size2 = size) === null || _size2 === void 0 ? void 0 : _size2.height) === 0) {\n    size.height = height;\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    style: containerStyle,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      tabIndex: 0,\n      className: styles.viz,\n      children: size && children(size.width, size.height)\n    }), /*#__PURE__*/_jsx(\"div\", {\n      style: legendStyle,\n      ref: legendRef,\n      children: /*#__PURE__*/_jsx(CustomScrollbar, {\n        hideHorizontalTrack: true,\n        children: legend\n      })\n    })]\n  });\n};\nexport const getVizStyles = theme => {\n  return {\n    viz: css({\n      flexGrow: 2,\n      borderRadius: theme.shape.borderRadius(1),\n      '&:focus-visible': getFocusStyles(theme)\n    })\n  };\n};\n\n/**\n * @beta\n */\nexport const VizLayoutLegend = ({\n  children\n}) => {\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: children\n  });\n};\nVizLayout.Legend = VizLayoutLegend;","map":{"version":3,"names":["css","React","useMeasure","useStyles2","getFocusStyles","CustomScrollbar","VizLayout","width","height","legend","children","styles","getVizStyles","containerStyle","display","legendRef","legendMeasure","viz","placement","maxHeight","maxWidth","props","size","legendStyle","flexDirection","theme","flexGrow","borderRadius","shape","VizLayoutLegend","Legend"],"sources":["/home/soula/grafana/packages/grafana-ui/src/components/VizLayout/VizLayout.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { FC, CSSProperties, ComponentType } from 'react';\nimport { useMeasure } from 'react-use';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { LegendPlacement } from '@grafana/schema';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { getFocusStyles } from '../../themes/mixins';\nimport { CustomScrollbar } from '../CustomScrollbar/CustomScrollbar';\n\n/**\n * @beta\n */\nexport interface VizLayoutProps {\n  width: number;\n  height: number;\n  legend?: React.ReactElement<VizLayoutLegendProps> | null;\n  children: (width: number, height: number) => React.ReactNode;\n}\n\n/**\n * @beta\n */\nexport interface VizLayoutComponentType extends FC<VizLayoutProps> {\n  Legend: ComponentType<VizLayoutLegendProps>;\n}\n\n/**\n * @beta\n */\nexport const VizLayout: VizLayoutComponentType = ({ width, height, legend, children }) => {\n  const styles = useStyles2(getVizStyles);\n  const containerStyle: CSSProperties = {\n    display: 'flex',\n    width: `${width}px`,\n    height: `${height}px`,\n  };\n  const [legendRef, legendMeasure] = useMeasure<HTMLDivElement>();\n\n  if (!legend) {\n    return (\n      <div tabIndex={0} style={containerStyle} className={styles.viz}>\n        {children(width, height)}\n      </div>\n    );\n  }\n\n  const { placement, maxHeight = '35%', maxWidth = '60%' } = legend.props;\n\n  let size: VizSize | null = null;\n\n  const legendStyle: CSSProperties = {};\n\n  switch (placement) {\n    case 'bottom':\n      containerStyle.flexDirection = 'column';\n      legendStyle.maxHeight = maxHeight;\n\n      if (legendMeasure) {\n        size = { width, height: height - legendMeasure.height };\n      }\n      break;\n    case 'right':\n      containerStyle.flexDirection = 'row';\n      legendStyle.maxWidth = maxWidth;\n\n      if (legendMeasure) {\n        size = { width: width - legendMeasure.width, height };\n      }\n\n      if (legend.props.width) {\n        legendStyle.width = legend.props.width;\n        size = { width: width - legend.props.width, height };\n      }\n      break;\n  }\n\n  // This happens when position is switched from bottom to right\n  // Then we preserve old with for one render cycle until legend is measured in it's new position\n  if (size?.width === 0) {\n    size.width = width;\n  }\n\n  if (size?.height === 0) {\n    size.height = height;\n  }\n\n  return (\n    <div style={containerStyle}>\n      <div tabIndex={0} className={styles.viz}>\n        {size && children(size.width, size.height)}\n      </div>\n      <div style={legendStyle} ref={legendRef}>\n        <CustomScrollbar hideHorizontalTrack>{legend}</CustomScrollbar>\n      </div>\n    </div>\n  );\n};\n\nexport const getVizStyles = (theme: GrafanaTheme2) => {\n  return {\n    viz: css({\n      flexGrow: 2,\n      borderRadius: theme.shape.borderRadius(1),\n      '&:focus-visible': getFocusStyles(theme),\n    }),\n  };\n};\ninterface VizSize {\n  width: number;\n  height: number;\n}\n\n/**\n * @beta\n */\nexport interface VizLayoutLegendProps {\n  placement: LegendPlacement;\n  children: React.ReactNode;\n  maxHeight?: string;\n  maxWidth?: string;\n  width?: number;\n}\n\n/**\n * @beta\n */\nexport const VizLayoutLegend: FC<VizLayoutLegendProps> = ({ children }) => {\n  return <>{children}</>;\n};\n\nVizLayout.Legend = VizLayoutLegend;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}