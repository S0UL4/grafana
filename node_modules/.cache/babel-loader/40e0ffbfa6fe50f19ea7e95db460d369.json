{"ast":null,"code":"var _div, _thead;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { PureComponent } from 'react';\nimport { Button, CollapsableSection, FileUpload } from '@grafana/ui';\nimport { getBackendSrv } from 'app/core/services/backend_srv';\nimport { getThumbnailURL } from 'app/features/search/components/SearchCard';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport class PreviewSettings extends PureComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {});\n\n    _defineProperty(this, \"doUpload\", (evt, isLight) => {\n      const file = (evt === null || evt === void 0 ? void 0 : evt.files) && evt.files[0];\n\n      if (!file) {\n        console.log('NOPE!', evt);\n        return;\n      }\n\n      const url = getThumbnailURL(this.props.uid, isLight);\n      const formData = new FormData();\n      formData.append('file', file);\n      fetch(url, {\n        method: 'POST',\n        body: formData\n      }).then(response => response.json()).then(result => {\n        console.log('Success:', result);\n        location.reload(); //HACK\n      }).catch(error => {\n        console.error('Error:', error);\n      });\n    });\n\n    _defineProperty(this, \"markAsStale\", isLight => async () => {\n      return getBackendSrv().put(getThumbnailURL(this.props.uid, isLight), {\n        state: 'stale'\n      });\n    });\n  }\n\n  render() {\n    const {\n      uid\n    } = this.props;\n    const imgstyle = {\n      maxWidth: 300,\n      maxHeight: 300\n    };\n    return /*#__PURE__*/_jsxs(CollapsableSection, {\n      label: \"Preview settings\",\n      isOpen: true,\n      children: [_div || (_div = /*#__PURE__*/_jsx(\"div\", {\n        children: \"DUMMY UI just so we have an upload button!\"\n      })), /*#__PURE__*/_jsxs(\"table\", {\n        cellSpacing: \"4\",\n        children: [_thead || (_thead = /*#__PURE__*/_jsx(\"thead\", {\n          children: /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"[DARK]\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: \"[LIGHT]\"\n            })]\n          })\n        })), /*#__PURE__*/_jsxs(\"tbody\", {\n          children: [/*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"button\",\n                variant: \"primary\",\n                onClick: this.markAsStale(false),\n                fill: \"outline\",\n                children: \"Mark as stale\"\n              })\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"button\",\n                variant: \"primary\",\n                onClick: this.markAsStale(true),\n                fill: \"outline\",\n                children: \"Mark as stale\"\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: getThumbnailURL(uid, false),\n                style: imgstyle\n              })\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: getThumbnailURL(uid, true),\n                style: imgstyle\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(FileUpload, {\n                accept: \"image/png, image/webp\",\n                onFileUpload: ({\n                  currentTarget\n                }) => this.doUpload(currentTarget, false),\n                children: \"Upload dark\"\n              })\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(FileUpload, {\n                accept: \"image/png, image/webp\",\n                onFileUpload: ({\n                  currentTarget\n                }) => this.doUpload(currentTarget, true),\n                children: \"Upload light\"\n              })\n            })]\n          })]\n        })]\n      })]\n    });\n  }\n\n}","map":{"version":3,"names":["React","PureComponent","Button","CollapsableSection","FileUpload","getBackendSrv","getThumbnailURL","PreviewSettings","evt","isLight","file","files","console","log","url","props","uid","formData","FormData","append","fetch","method","body","then","response","json","result","location","reload","catch","error","put","state","render","imgstyle","maxWidth","maxHeight","markAsStale","currentTarget","doUpload"],"sources":["/home/soula/grafana/public/app/features/dashboard/components/DashboardSettings/PreviewSettings.tsx"],"sourcesContent":["import React, { PureComponent } from 'react';\n\nimport { Button, CollapsableSection, FileUpload } from '@grafana/ui';\nimport { getBackendSrv } from 'app/core/services/backend_srv';\nimport { getThumbnailURL } from 'app/features/search/components/SearchCard';\n\ninterface Props {\n  uid: string;\n}\n\ninterface State {}\n\nexport class PreviewSettings extends PureComponent<Props, State> {\n  state: State = {};\n\n  doUpload = (evt: EventTarget & HTMLInputElement, isLight?: boolean) => {\n    const file = evt?.files && evt.files[0];\n    if (!file) {\n      console.log('NOPE!', evt);\n      return;\n    }\n\n    const url = getThumbnailURL(this.props.uid, isLight);\n    const formData = new FormData();\n    formData.append('file', file);\n\n    fetch(url, {\n      method: 'POST',\n      body: formData,\n    })\n      .then((response) => response.json())\n      .then((result) => {\n        console.log('Success:', result);\n        location.reload(); //HACK\n      })\n      .catch((error) => {\n        console.error('Error:', error);\n      });\n  };\n\n  markAsStale = (isLight: boolean) => async () => {\n    return getBackendSrv().put(getThumbnailURL(this.props.uid, isLight), { state: 'stale' });\n  };\n\n  render() {\n    const { uid } = this.props;\n    const imgstyle = { maxWidth: 300, maxHeight: 300 };\n    return (\n      <CollapsableSection label=\"Preview settings\" isOpen={true}>\n        <div>DUMMY UI just so we have an upload button!</div>\n        <table cellSpacing=\"4\">\n          <thead>\n            <tr>\n              <td>[DARK]</td>\n              <td>[LIGHT]</td>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>\n                <Button type=\"button\" variant=\"primary\" onClick={this.markAsStale(false)} fill=\"outline\">\n                  Mark as stale\n                </Button>\n              </td>\n              <td>\n                <Button type=\"button\" variant=\"primary\" onClick={this.markAsStale(true)} fill=\"outline\">\n                  Mark as stale\n                </Button>\n              </td>\n            </tr>\n            <tr>\n              <td>\n                <img src={getThumbnailURL(uid, false)} style={imgstyle} />\n              </td>\n              <td>\n                <img src={getThumbnailURL(uid, true)} style={imgstyle} />\n              </td>\n            </tr>\n            <tr>\n              <td>\n                <FileUpload\n                  accept=\"image/png, image/webp\"\n                  onFileUpload={({ currentTarget }) => this.doUpload(currentTarget, false)}\n                >\n                  Upload dark\n                </FileUpload>\n              </td>\n              <td>\n                <FileUpload\n                  accept=\"image/png, image/webp\"\n                  onFileUpload={({ currentTarget }) => this.doUpload(currentTarget, true)}\n                >\n                  Upload light\n                </FileUpload>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </CollapsableSection>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}