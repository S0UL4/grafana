{"ast":null,"code":"import React, { useCallback } from 'react';\nimport { DataTransformerID, standardTransformers } from '@grafana/data';\nimport { ReduceTransformerMode } from '@grafana/data/src/transformations/transformers/reduce';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { LegacyForms, Select, StatsPicker } from '@grafana/ui'; // TODO:  Minimal implementation, needs some <3\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport const ReduceTransformerEditor = ({\n  options,\n  onChange\n}) => {\n  const modes = [{\n    label: 'Series to rows',\n    value: ReduceTransformerMode.SeriesToRows,\n    description: 'Create a table with one row for each series value'\n  }, {\n    label: 'Reduce fields',\n    value: ReduceTransformerMode.ReduceFields,\n    description: 'Collapse each field into a single value'\n  }];\n  const onSelectMode = useCallback(value => {\n    const mode = value.value;\n    onChange(Object.assign({}, options, {\n      mode,\n      includeTimeField: mode === ReduceTransformerMode.ReduceFields ? !!options.includeTimeField : false\n    }));\n  }, [onChange, options]);\n  const onToggleTime = useCallback(() => {\n    onChange(Object.assign({}, options, {\n      includeTimeField: !options.includeTimeField\n    }));\n  }, [onChange, options]);\n  const onToggleLabels = useCallback(() => {\n    onChange(Object.assign({}, options, {\n      labelsToFields: !options.labelsToFields\n    }));\n  }, [onChange, options]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"gf-form gf-form--grow\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"gf-form-label width-8\",\n          \"aria-label\": selectors.components.Transforms.Reduce.modeLabel,\n          children: \"Mode\"\n        }), /*#__PURE__*/_jsx(Select, {\n          options: modes,\n          value: modes.find(v => v.value === options.mode) || modes[0],\n          onChange: onSelectMode,\n          className: \"flex-grow-1\"\n        })]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"gf-form-inline\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"gf-form gf-form--grow\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"gf-form-label width-8\",\n          \"aria-label\": selectors.components.Transforms.Reduce.calculationsLabel,\n          children: \"Calculations\"\n        }), /*#__PURE__*/_jsx(StatsPicker, {\n          className: \"flex-grow-1\",\n          placeholder: \"Choose Stat\",\n          allowMultiple: true,\n          stats: options.reducers || [],\n          onChange: stats => {\n            onChange(Object.assign({}, options, {\n              reducers: stats\n            }));\n          }\n        })]\n      })\n    }), options.mode === ReduceTransformerMode.ReduceFields && /*#__PURE__*/_jsx(\"div\", {\n      className: \"gf-form-inline\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"gf-form\",\n        children: /*#__PURE__*/_jsx(LegacyForms.Switch, {\n          label: \"Include time\",\n          labelClass: \"width-8\",\n          checked: !!options.includeTimeField,\n          onChange: onToggleTime\n        })\n      })\n    }), options.mode !== ReduceTransformerMode.ReduceFields && /*#__PURE__*/_jsx(\"div\", {\n      className: \"gf-form-inline\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"gf-form\",\n        children: /*#__PURE__*/_jsx(LegacyForms.Switch, {\n          label: \"Labels to fields\",\n          labelClass: \"width-8\",\n          checked: !!options.labelsToFields,\n          onChange: onToggleLabels\n        })\n      })\n    })]\n  });\n};\nexport const reduceTransformRegistryItem = {\n  id: DataTransformerID.reduce,\n  editor: ReduceTransformerEditor,\n  transformation: standardTransformers.reduceTransformer,\n  name: standardTransformers.reduceTransformer.name,\n  description: standardTransformers.reduceTransformer.description\n};","map":{"version":3,"names":["React","useCallback","DataTransformerID","standardTransformers","ReduceTransformerMode","selectors","LegacyForms","Select","StatsPicker","ReduceTransformerEditor","options","onChange","modes","label","value","SeriesToRows","description","ReduceFields","onSelectMode","mode","includeTimeField","onToggleTime","onToggleLabels","labelsToFields","components","Transforms","Reduce","modeLabel","find","v","calculationsLabel","reducers","stats","reduceTransformRegistryItem","id","reduce","editor","transformation","reduceTransformer","name"],"sources":["/home/soula/grafana/public/app/features/transformers/editors/ReduceTransformerEditor.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\n\nimport {\n  DataTransformerID,\n  ReducerID,\n  SelectableValue,\n  standardTransformers,\n  TransformerRegistryItem,\n  TransformerUIProps,\n} from '@grafana/data';\nimport { ReduceTransformerMode, ReduceTransformerOptions } from '@grafana/data/src/transformations/transformers/reduce';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { LegacyForms, Select, StatsPicker } from '@grafana/ui';\n\n// TODO:  Minimal implementation, needs some <3\nexport const ReduceTransformerEditor: React.FC<TransformerUIProps<ReduceTransformerOptions>> = ({\n  options,\n  onChange,\n}) => {\n  const modes: Array<SelectableValue<ReduceTransformerMode>> = [\n    {\n      label: 'Series to rows',\n      value: ReduceTransformerMode.SeriesToRows,\n      description: 'Create a table with one row for each series value',\n    },\n    {\n      label: 'Reduce fields',\n      value: ReduceTransformerMode.ReduceFields,\n      description: 'Collapse each field into a single value',\n    },\n  ];\n\n  const onSelectMode = useCallback(\n    (value: SelectableValue<ReduceTransformerMode>) => {\n      const mode = value.value!;\n      onChange({\n        ...options,\n        mode,\n        includeTimeField: mode === ReduceTransformerMode.ReduceFields ? !!options.includeTimeField : false,\n      });\n    },\n    [onChange, options]\n  );\n\n  const onToggleTime = useCallback(() => {\n    onChange({\n      ...options,\n      includeTimeField: !options.includeTimeField,\n    });\n  }, [onChange, options]);\n\n  const onToggleLabels = useCallback(() => {\n    onChange({\n      ...options,\n      labelsToFields: !options.labelsToFields,\n    });\n  }, [onChange, options]);\n\n  return (\n    <>\n      <div>\n        <div className=\"gf-form gf-form--grow\">\n          <div className=\"gf-form-label width-8\" aria-label={selectors.components.Transforms.Reduce.modeLabel}>\n            Mode\n          </div>\n          <Select\n            options={modes}\n            value={modes.find((v) => v.value === options.mode) || modes[0]}\n            onChange={onSelectMode}\n            className=\"flex-grow-1\"\n          />\n        </div>\n      </div>\n      <div className=\"gf-form-inline\">\n        <div className=\"gf-form gf-form--grow\">\n          <div className=\"gf-form-label width-8\" aria-label={selectors.components.Transforms.Reduce.calculationsLabel}>\n            Calculations\n          </div>\n          <StatsPicker\n            className=\"flex-grow-1\"\n            placeholder=\"Choose Stat\"\n            allowMultiple\n            stats={options.reducers || []}\n            onChange={(stats) => {\n              onChange({\n                ...options,\n                reducers: stats as ReducerID[],\n              });\n            }}\n          />\n        </div>\n      </div>\n      {options.mode === ReduceTransformerMode.ReduceFields && (\n        <div className=\"gf-form-inline\">\n          <div className=\"gf-form\">\n            <LegacyForms.Switch\n              label=\"Include time\"\n              labelClass=\"width-8\"\n              checked={!!options.includeTimeField}\n              onChange={onToggleTime}\n            />\n          </div>\n        </div>\n      )}\n      {options.mode !== ReduceTransformerMode.ReduceFields && (\n        <div className=\"gf-form-inline\">\n          <div className=\"gf-form\">\n            <LegacyForms.Switch\n              label=\"Labels to fields\"\n              labelClass=\"width-8\"\n              checked={!!options.labelsToFields}\n              onChange={onToggleLabels}\n            />\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport const reduceTransformRegistryItem: TransformerRegistryItem<ReduceTransformerOptions> = {\n  id: DataTransformerID.reduce,\n  editor: ReduceTransformerEditor,\n  transformation: standardTransformers.reduceTransformer,\n  name: standardTransformers.reduceTransformer.name,\n  description: standardTransformers.reduceTransformer.description,\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}