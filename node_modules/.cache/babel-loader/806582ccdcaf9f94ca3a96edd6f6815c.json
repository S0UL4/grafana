{"ast":null,"code":"import { css, cx } from '@emotion/css';\nimport { cloneDeep } from 'lodash';\nimport React from 'react';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { Tooltip, useStyles2 } from '@grafana/ui';\nimport { PanelRenderer } from '../PanelRenderer';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function VisualizationSuggestionCard({\n  data,\n  suggestion,\n  onChange,\n  width,\n  showTitle\n}) {\n  var _suggestion$cardOptio, _suggestion$cardOptio2;\n\n  const styles = useStyles2(getStyles);\n  const {\n    innerStyles,\n    outerStyles,\n    renderWidth,\n    renderHeight\n  } = getPreviewDimensionsAndStyles(width);\n  const cardOptions = (_suggestion$cardOptio = suggestion.cardOptions) !== null && _suggestion$cardOptio !== void 0 ? _suggestion$cardOptio : {};\n  const commonButtonProps = {\n    'aria-label': suggestion.name,\n    className: styles.vizBox,\n    'data-testid': selectors.components.VisualizationPreview.card(suggestion.name),\n    style: outerStyles,\n    onClick: () => {\n      onChange({\n        pluginId: suggestion.pluginId,\n        options: suggestion.options,\n        fieldConfig: suggestion.fieldConfig\n      });\n    }\n  };\n\n  if (cardOptions.imgSrc) {\n    var _suggestion$descripti;\n\n    return /*#__PURE__*/_jsx(Tooltip, {\n      content: (_suggestion$descripti = suggestion.description) !== null && _suggestion$descripti !== void 0 ? _suggestion$descripti : suggestion.name,\n      children: /*#__PURE__*/_jsxs(\"button\", Object.assign({}, commonButtonProps, {\n        className: cx(styles.vizBox, styles.imgBox),\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: styles.name,\n          children: suggestion.name\n        }), /*#__PURE__*/_jsx(\"img\", {\n          className: styles.img,\n          src: cardOptions.imgSrc,\n          alt: suggestion.name\n        })]\n      }))\n    });\n  }\n\n  let preview = suggestion;\n\n  if ((_suggestion$cardOptio2 = suggestion.cardOptions) !== null && _suggestion$cardOptio2 !== void 0 && _suggestion$cardOptio2.previewModifier) {\n    preview = cloneDeep(suggestion);\n    suggestion.cardOptions.previewModifier(preview);\n  }\n\n  return /*#__PURE__*/_jsx(\"button\", Object.assign({}, commonButtonProps, {\n    children: /*#__PURE__*/_jsx(Tooltip, {\n      content: suggestion.name,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        style: innerStyles,\n        className: styles.renderContainer,\n        children: [/*#__PURE__*/_jsx(PanelRenderer, {\n          title: \"\",\n          data: data,\n          pluginId: suggestion.pluginId,\n          width: renderWidth,\n          height: renderHeight,\n          options: preview.options,\n          fieldConfig: preview.fieldConfig\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.hoverPane\n        })]\n      })\n    })\n  }));\n}\n\nconst getStyles = theme => {\n  return {\n    hoverPane: css({\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      left: 0,\n      borderRadius: theme.spacing(2),\n      bottom: 0\n    }),\n    vizBox: css`\n      position: relative;\n      background: none;\n      border-radius: ${theme.shape.borderRadius(1)};\n      cursor: pointer;\n      border: 1px solid ${theme.colors.border.medium};\n\n      transition: ${theme.transitions.create(['background'], {\n      duration: theme.transitions.duration.short\n    })};\n\n      &:hover {\n        background: ${theme.colors.background.secondary};\n      }\n    `,\n    imgBox: css`\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n\n      justify-self: center;\n      color: ${theme.colors.text.primary};\n      width: 100%;\n      display: flex;\n\n      justify-content: center;\n      align-items: center;\n      text-align: center;\n    `,\n    name: css`\n      padding-bottom: ${theme.spacing(0.5)};\n      margin-top: ${theme.spacing(-1)};\n      font-size: ${theme.typography.bodySmall.fontSize};\n      white-space: nowrap;\n      overflow: hidden;\n      color: ${theme.colors.text.secondary};\n      font-weight: ${theme.typography.fontWeightMedium};\n      text-overflow: ellipsis;\n    `,\n    img: css`\n      max-width: ${theme.spacing(8)};\n      max-height: ${theme.spacing(8)};\n    `,\n    renderContainer: css`\n      position: absolute;\n      transform-origin: left top;\n      top: 6px;\n      left: 6px;\n    `\n  };\n};\n\nfunction getPreviewDimensionsAndStyles(width) {\n  const aspectRatio = 16 / 10;\n  const showWidth = width;\n  const showHeight = width * (1 / aspectRatio);\n  const renderWidth = 350;\n  const renderHeight = renderWidth * (1 / aspectRatio);\n  const padding = 6;\n  const widthFactor = (showWidth - padding * 2) / renderWidth;\n  const heightFactor = (showHeight - padding * 2) / renderHeight;\n  return {\n    renderHeight,\n    renderWidth,\n    outerStyles: {\n      width: showWidth,\n      height: showHeight\n    },\n    innerStyles: {\n      width: renderWidth,\n      height: renderHeight,\n      transform: `scale(${widthFactor}, ${heightFactor})`\n    }\n  };\n}","map":{"version":3,"names":["css","cx","cloneDeep","React","selectors","Tooltip","useStyles2","PanelRenderer","VisualizationSuggestionCard","data","suggestion","onChange","width","showTitle","styles","getStyles","innerStyles","outerStyles","renderWidth","renderHeight","getPreviewDimensionsAndStyles","cardOptions","commonButtonProps","name","className","vizBox","components","VisualizationPreview","card","style","onClick","pluginId","options","fieldConfig","imgSrc","description","imgBox","img","preview","previewModifier","renderContainer","hoverPane","theme","position","top","right","left","borderRadius","spacing","bottom","shape","colors","border","medium","transitions","create","duration","short","background","secondary","text","primary","typography","bodySmall","fontSize","fontWeightMedium","aspectRatio","showWidth","showHeight","padding","widthFactor","heightFactor","height","transform"],"sources":["/home/soula/grafana/public/app/features/panel/components/VizTypePicker/VisualizationSuggestionCard.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport { cloneDeep } from 'lodash';\nimport React, { CSSProperties } from 'react';\n\nimport { GrafanaTheme2, PanelData, VisualizationSuggestion } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { Tooltip, useStyles2 } from '@grafana/ui';\n\nimport { PanelRenderer } from '../PanelRenderer';\n\nimport { VizTypeChangeDetails } from './types';\n\nexport interface Props {\n  data: PanelData;\n  width: number;\n  suggestion: VisualizationSuggestion;\n  showTitle?: boolean;\n  onChange: (details: VizTypeChangeDetails) => void;\n}\n\nexport function VisualizationSuggestionCard({ data, suggestion, onChange, width, showTitle }: Props) {\n  const styles = useStyles2(getStyles);\n  const { innerStyles, outerStyles, renderWidth, renderHeight } = getPreviewDimensionsAndStyles(width);\n  const cardOptions = suggestion.cardOptions ?? {};\n\n  const commonButtonProps = {\n    'aria-label': suggestion.name,\n    className: styles.vizBox,\n    'data-testid': selectors.components.VisualizationPreview.card(suggestion.name),\n    style: outerStyles,\n    onClick: () => {\n      onChange({\n        pluginId: suggestion.pluginId,\n        options: suggestion.options,\n        fieldConfig: suggestion.fieldConfig,\n      });\n    },\n  };\n\n  if (cardOptions.imgSrc) {\n    return (\n      <Tooltip content={suggestion.description ?? suggestion.name}>\n        <button {...commonButtonProps} className={cx(styles.vizBox, styles.imgBox)}>\n          <div className={styles.name}>{suggestion.name}</div>\n          <img className={styles.img} src={cardOptions.imgSrc} alt={suggestion.name} />\n        </button>\n      </Tooltip>\n    );\n  }\n\n  let preview = suggestion;\n  if (suggestion.cardOptions?.previewModifier) {\n    preview = cloneDeep(suggestion);\n    suggestion.cardOptions.previewModifier(preview);\n  }\n\n  return (\n    <button {...commonButtonProps}>\n      <Tooltip content={suggestion.name}>\n        <div style={innerStyles} className={styles.renderContainer}>\n          <PanelRenderer\n            title=\"\"\n            data={data}\n            pluginId={suggestion.pluginId}\n            width={renderWidth}\n            height={renderHeight}\n            options={preview.options}\n            fieldConfig={preview.fieldConfig}\n          />\n          <div className={styles.hoverPane} />\n        </div>\n      </Tooltip>\n    </button>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    hoverPane: css({\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      left: 0,\n      borderRadius: theme.spacing(2),\n      bottom: 0,\n    }),\n    vizBox: css`\n      position: relative;\n      background: none;\n      border-radius: ${theme.shape.borderRadius(1)};\n      cursor: pointer;\n      border: 1px solid ${theme.colors.border.medium};\n\n      transition: ${theme.transitions.create(['background'], {\n        duration: theme.transitions.duration.short,\n      })};\n\n      &:hover {\n        background: ${theme.colors.background.secondary};\n      }\n    `,\n    imgBox: css`\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n\n      justify-self: center;\n      color: ${theme.colors.text.primary};\n      width: 100%;\n      display: flex;\n\n      justify-content: center;\n      align-items: center;\n      text-align: center;\n    `,\n    name: css`\n      padding-bottom: ${theme.spacing(0.5)};\n      margin-top: ${theme.spacing(-1)};\n      font-size: ${theme.typography.bodySmall.fontSize};\n      white-space: nowrap;\n      overflow: hidden;\n      color: ${theme.colors.text.secondary};\n      font-weight: ${theme.typography.fontWeightMedium};\n      text-overflow: ellipsis;\n    `,\n    img: css`\n      max-width: ${theme.spacing(8)};\n      max-height: ${theme.spacing(8)};\n    `,\n    renderContainer: css`\n      position: absolute;\n      transform-origin: left top;\n      top: 6px;\n      left: 6px;\n    `,\n  };\n};\n\ninterface PreviewDimensionsAndStyles {\n  renderWidth: number;\n  renderHeight: number;\n  innerStyles: CSSProperties;\n  outerStyles: CSSProperties;\n}\n\nfunction getPreviewDimensionsAndStyles(width: number): PreviewDimensionsAndStyles {\n  const aspectRatio = 16 / 10;\n  const showWidth = width;\n  const showHeight = width * (1 / aspectRatio);\n  const renderWidth = 350;\n  const renderHeight = renderWidth * (1 / aspectRatio);\n\n  const padding = 6;\n  const widthFactor = (showWidth - padding * 2) / renderWidth;\n  const heightFactor = (showHeight - padding * 2) / renderHeight;\n\n  return {\n    renderHeight,\n    renderWidth,\n    outerStyles: { width: showWidth, height: showHeight },\n    innerStyles: {\n      width: renderWidth,\n      height: renderHeight,\n      transform: `scale(${widthFactor}, ${heightFactor})`,\n    },\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}