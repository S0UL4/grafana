{"ast":null,"code":"var _window, _window$grafanaBootDa, _window$grafanaBootDa2;\n\nimport { config, getBackendSrv, getGrafanaLiveSrv, setGrafanaLiveSrv } from '@grafana/runtime';\nimport { liveTimer } from 'app/features/dashboard/dashgrid/liveTimer';\nimport { contextSrv } from '../../core/services/context_srv';\nimport { CentrifugeService } from './centrifuge/service';\nimport { CentrifugeServiceWorkerProxy } from './centrifuge/serviceWorkerProxy';\nimport { GrafanaLiveService } from './live';\nexport const sessionId = ((_window = window) === null || _window === void 0 ? void 0 : (_window$grafanaBootDa = _window.grafanaBootData) === null || _window$grafanaBootDa === void 0 ? void 0 : (_window$grafanaBootDa2 = _window$grafanaBootDa.user) === null || _window$grafanaBootDa2 === void 0 ? void 0 : _window$grafanaBootDa2.id) + '/' + Date.now().toString(16) + '/' + Math.random().toString(36).substring(2, 15);\nexport function initGrafanaLive() {\n  const centrifugeServiceDeps = {\n    appUrl: `${window.location.origin}${config.appSubUrl}`,\n    orgId: contextSrv.user.orgId,\n    orgRole: contextSrv.user.orgRole,\n    liveEnabled: config.liveEnabled,\n    sessionId,\n    dataStreamSubscriberReadiness: liveTimer.ok.asObservable()\n  };\n  const centrifugeSrv = config.featureToggles['live-service-web-worker'] ? new CentrifugeServiceWorkerProxy(centrifugeServiceDeps) : new CentrifugeService(centrifugeServiceDeps);\n  setGrafanaLiveSrv(new GrafanaLiveService({\n    centrifugeSrv,\n    backendSrv: getBackendSrv()\n  }));\n}\nexport function getGrafanaLiveCentrifugeSrv() {\n  return getGrafanaLiveSrv();\n}","map":{"version":3,"names":["config","getBackendSrv","getGrafanaLiveSrv","setGrafanaLiveSrv","liveTimer","contextSrv","CentrifugeService","CentrifugeServiceWorkerProxy","GrafanaLiveService","sessionId","window","grafanaBootData","user","id","Date","now","toString","Math","random","substring","initGrafanaLive","centrifugeServiceDeps","appUrl","location","origin","appSubUrl","orgId","orgRole","liveEnabled","dataStreamSubscriberReadiness","ok","asObservable","centrifugeSrv","featureToggles","backendSrv","getGrafanaLiveCentrifugeSrv"],"sources":["/home/soula/grafana/public/app/features/live/index.ts"],"sourcesContent":["import { config, getBackendSrv, getGrafanaLiveSrv, setGrafanaLiveSrv } from '@grafana/runtime';\nimport { liveTimer } from 'app/features/dashboard/dashgrid/liveTimer';\n\nimport { contextSrv } from '../../core/services/context_srv';\n\nimport { CentrifugeService } from './centrifuge/service';\nimport { CentrifugeServiceWorkerProxy } from './centrifuge/serviceWorkerProxy';\nimport { GrafanaLiveService } from './live';\n\nexport const sessionId =\n  (window as any)?.grafanaBootData?.user?.id +\n  '/' +\n  Date.now().toString(16) +\n  '/' +\n  Math.random().toString(36).substring(2, 15);\n\nexport function initGrafanaLive() {\n  const centrifugeServiceDeps = {\n    appUrl: `${window.location.origin}${config.appSubUrl}`,\n    orgId: contextSrv.user.orgId,\n    orgRole: contextSrv.user.orgRole,\n    liveEnabled: config.liveEnabled,\n    sessionId,\n    dataStreamSubscriberReadiness: liveTimer.ok.asObservable(),\n  };\n\n  const centrifugeSrv = config.featureToggles['live-service-web-worker']\n    ? new CentrifugeServiceWorkerProxy(centrifugeServiceDeps)\n    : new CentrifugeService(centrifugeServiceDeps);\n\n  setGrafanaLiveSrv(\n    new GrafanaLiveService({\n      centrifugeSrv,\n      backendSrv: getBackendSrv(),\n    })\n  );\n}\n\nexport function getGrafanaLiveCentrifugeSrv() {\n  return getGrafanaLiveSrv() as GrafanaLiveService;\n}\n"],"mappings":";;AAAA,SAASA,MAAT,EAAiBC,aAAjB,EAAgCC,iBAAhC,EAAmDC,iBAAnD,QAA4E,kBAA5E;AACA,SAASC,SAAT,QAA0B,2CAA1B;AAEA,SAASC,UAAT,QAA2B,iCAA3B;AAEA,SAASC,iBAAT,QAAkC,sBAAlC;AACA,SAASC,4BAAT,QAA6C,iCAA7C;AACA,SAASC,kBAAT,QAAmC,QAAnC;AAEA,OAAO,MAAMC,SAAS,GACpB,YAACC,MAAD,6EAAiBC,eAAjB,0GAAkCC,IAAlC,kFAAwCC,EAAxC,IACA,GADA,GAEAC,IAAI,CAACC,GAAL,GAAWC,QAAX,CAAoB,EAApB,CAFA,GAGA,GAHA,GAIAC,IAAI,CAACC,MAAL,GAAcF,QAAd,CAAuB,EAAvB,EAA2BG,SAA3B,CAAqC,CAArC,EAAwC,EAAxC,CALK;AAOP,OAAO,SAASC,eAAT,GAA2B;EAChC,MAAMC,qBAAqB,GAAG;IAC5BC,MAAM,EAAG,GAAEZ,MAAM,CAACa,QAAP,CAAgBC,MAAO,GAAExB,MAAM,CAACyB,SAAU,EADzB;IAE5BC,KAAK,EAAErB,UAAU,CAACO,IAAX,CAAgBc,KAFK;IAG5BC,OAAO,EAAEtB,UAAU,CAACO,IAAX,CAAgBe,OAHG;IAI5BC,WAAW,EAAE5B,MAAM,CAAC4B,WAJQ;IAK5BnB,SAL4B;IAM5BoB,6BAA6B,EAAEzB,SAAS,CAAC0B,EAAV,CAAaC,YAAb;EANH,CAA9B;EASA,MAAMC,aAAa,GAAGhC,MAAM,CAACiC,cAAP,CAAsB,yBAAtB,IAClB,IAAI1B,4BAAJ,CAAiCc,qBAAjC,CADkB,GAElB,IAAIf,iBAAJ,CAAsBe,qBAAtB,CAFJ;EAIAlB,iBAAiB,CACf,IAAIK,kBAAJ,CAAuB;IACrBwB,aADqB;IAErBE,UAAU,EAAEjC,aAAa;EAFJ,CAAvB,CADe,CAAjB;AAMD;AAED,OAAO,SAASkC,2BAAT,GAAuC;EAC5C,OAAOjC,iBAAiB,EAAxB;AACD"},"metadata":{},"sourceType":"module"}