{"ast":null,"code":"import { isString } from 'lodash';\n\n/**\n * Convert instance settings to a reference\n *\n * @public\n */\nexport function getDataSourceRef(ds) {\n  return {\n    uid: ds.uid,\n    type: ds.type\n  };\n}\n/**\n * Returns true if the argument is a DataSourceRef\n *\n * @public\n */\n\nexport function isDataSourceRef(ref) {\n  return typeof ref === 'object' && typeof (ref === null || ref === void 0 ? void 0 : ref.uid) === 'string';\n}\n/**\n * Get the UID from a string of reference\n *\n * @public\n */\n\nexport function getDataSourceUID(ref) {\n  if (isDataSourceRef(ref)) {\n    return ref.uid;\n  }\n\n  if (isString(ref)) {\n    return ref;\n  }\n\n  return undefined;\n}\nexport const onUpdateDatasourceOption = (props, key) => event => {\n  updateDatasourcePluginOption(props, key, event.currentTarget.value);\n};\nexport const onUpdateDatasourceJsonDataOption = (props, key) => event => {\n  updateDatasourcePluginJsonDataOption(props, key, event.currentTarget.value);\n};\nexport const onUpdateDatasourceSecureJsonDataOption = (props, key) => event => {\n  updateDatasourcePluginSecureJsonDataOption(props, key, event.currentTarget.value);\n};\nexport const onUpdateDatasourceJsonDataOptionSelect = (props, key) => selected => {\n  updateDatasourcePluginJsonDataOption(props, key, selected.value);\n};\nexport const onUpdateDatasourceJsonDataOptionChecked = (props, key) => event => {\n  updateDatasourcePluginJsonDataOption(props, key, event.currentTarget.checked);\n};\nexport const onUpdateDatasourceSecureJsonDataOptionSelect = (props, key) => selected => {\n  updateDatasourcePluginSecureJsonDataOption(props, key, selected.value);\n};\nexport const onUpdateDatasourceResetOption = (props, key) => event => {\n  updateDatasourcePluginResetOption(props, key);\n};\nexport function updateDatasourcePluginOption(props, key, val) {\n  const config = props.options;\n  props.onOptionsChange(Object.assign({}, config, {\n    [key]: val\n  }));\n}\nexport const updateDatasourcePluginJsonDataOption = (props, key, val) => {\n  const config = props.options;\n  props.onOptionsChange(Object.assign({}, config, {\n    jsonData: Object.assign({}, config.jsonData, {\n      [key]: val\n    })\n  }));\n};\nexport const updateDatasourcePluginSecureJsonDataOption = (props, key, val) => {\n  const config = props.options;\n  props.onOptionsChange(Object.assign({}, config, {\n    secureJsonData: Object.assign({}, config.secureJsonData ? config.secureJsonData : {}, {\n      [key]: val\n    })\n  }));\n};\nexport const updateDatasourcePluginResetOption = (props, key) => {\n  const config = props.options;\n  props.onOptionsChange(Object.assign({}, config, {\n    secureJsonData: Object.assign({}, config.secureJsonData ? config.secureJsonData : {}, {\n      [key]: ''\n    }),\n    secureJsonFields: Object.assign({}, config.secureJsonFields, {\n      [key]: false\n    })\n  }));\n};","map":{"version":3,"names":["isString","getDataSourceRef","ds","uid","type","isDataSourceRef","ref","getDataSourceUID","undefined","onUpdateDatasourceOption","props","key","event","updateDatasourcePluginOption","currentTarget","value","onUpdateDatasourceJsonDataOption","updateDatasourcePluginJsonDataOption","onUpdateDatasourceSecureJsonDataOption","updateDatasourcePluginSecureJsonDataOption","onUpdateDatasourceJsonDataOptionSelect","selected","onUpdateDatasourceJsonDataOptionChecked","checked","onUpdateDatasourceSecureJsonDataOptionSelect","onUpdateDatasourceResetOption","updateDatasourcePluginResetOption","val","config","options","onOptionsChange","jsonData","secureJsonData","secureJsonFields"],"sources":["/home/soula/grafana/packages/grafana-data/src/utils/datasource.ts"],"sourcesContent":["import { isString } from 'lodash';\n\nimport {\n  DataSourcePluginOptionsEditorProps,\n  SelectableValue,\n  KeyValue,\n  DataSourceSettings,\n  DataSourceInstanceSettings,\n  DataSourceRef,\n} from '../types';\n\n/**\n * Convert instance settings to a reference\n *\n * @public\n */\nexport function getDataSourceRef(ds: DataSourceInstanceSettings): DataSourceRef {\n  return { uid: ds.uid, type: ds.type };\n}\n\n/**\n * Returns true if the argument is a DataSourceRef\n *\n * @public\n */\nexport function isDataSourceRef(ref: DataSourceRef | string | null | undefined): ref is DataSourceRef {\n  return typeof ref === 'object' && typeof ref?.uid === 'string';\n}\n\n/**\n * Get the UID from a string of reference\n *\n * @public\n */\nexport function getDataSourceUID(ref: DataSourceRef | string | null): string | undefined {\n  if (isDataSourceRef(ref)) {\n    return ref.uid;\n  }\n  if (isString(ref)) {\n    return ref;\n  }\n  return undefined;\n}\n\nexport const onUpdateDatasourceOption =\n  (props: DataSourcePluginOptionsEditorProps, key: keyof DataSourceSettings) =>\n  (event: React.SyntheticEvent<HTMLInputElement | HTMLSelectElement>) => {\n    updateDatasourcePluginOption(props, key, event.currentTarget.value);\n  };\n\nexport const onUpdateDatasourceJsonDataOption =\n  <J, S, K extends keyof J>(props: DataSourcePluginOptionsEditorProps<J, S>, key: K) =>\n  (event: React.SyntheticEvent<HTMLInputElement | HTMLSelectElement>) => {\n    updateDatasourcePluginJsonDataOption(props, key, event.currentTarget.value);\n  };\n\nexport const onUpdateDatasourceSecureJsonDataOption =\n  <J, S extends {} = KeyValue>(props: DataSourcePluginOptionsEditorProps<J, S>, key: string) =>\n  (event: React.SyntheticEvent<HTMLInputElement | HTMLSelectElement>) => {\n    updateDatasourcePluginSecureJsonDataOption(props, key, event.currentTarget.value);\n  };\n\nexport const onUpdateDatasourceJsonDataOptionSelect =\n  <J, S, K extends keyof J>(props: DataSourcePluginOptionsEditorProps<J, S>, key: K) =>\n  (selected: SelectableValue) => {\n    updateDatasourcePluginJsonDataOption(props, key, selected.value);\n  };\n\nexport const onUpdateDatasourceJsonDataOptionChecked =\n  <J, S, K extends keyof J>(props: DataSourcePluginOptionsEditorProps<J, S>, key: K) =>\n  (event: React.SyntheticEvent<HTMLInputElement>) => {\n    updateDatasourcePluginJsonDataOption(props, key, event.currentTarget.checked);\n  };\n\nexport const onUpdateDatasourceSecureJsonDataOptionSelect =\n  <J, S extends {} = KeyValue>(props: DataSourcePluginOptionsEditorProps<J, S>, key: string) =>\n  (selected: SelectableValue) => {\n    updateDatasourcePluginSecureJsonDataOption(props, key, selected.value);\n  };\n\nexport const onUpdateDatasourceResetOption =\n  (props: DataSourcePluginOptionsEditorProps, key: string) =>\n  (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n    updateDatasourcePluginResetOption(props, key);\n  };\n\nexport function updateDatasourcePluginOption<J, S extends {} = KeyValue>(\n  props: DataSourcePluginOptionsEditorProps<J, S>,\n  key: keyof DataSourceSettings,\n  val: any\n) {\n  const config = props.options;\n\n  props.onOptionsChange({\n    ...config,\n    [key]: val,\n  });\n}\n\nexport const updateDatasourcePluginJsonDataOption = <J, S, K extends keyof J>(\n  props: DataSourcePluginOptionsEditorProps<J, S>,\n  key: K,\n  val: any\n) => {\n  const config = props.options;\n\n  props.onOptionsChange({\n    ...config,\n    jsonData: {\n      ...config.jsonData,\n      [key]: val,\n    },\n  });\n};\n\nexport const updateDatasourcePluginSecureJsonDataOption = <J, S extends {} = KeyValue>(\n  props: DataSourcePluginOptionsEditorProps<J, S>,\n  key: string,\n  val: any\n) => {\n  const config = props.options;\n\n  props.onOptionsChange({\n    ...config,\n    secureJsonData: {\n      ...(config.secureJsonData ? config.secureJsonData : ({} as S)),\n      [key]: val,\n    },\n  });\n};\n\nexport const updateDatasourcePluginResetOption = <J, S extends {} = KeyValue>(\n  props: DataSourcePluginOptionsEditorProps<J, S>,\n  key: string\n) => {\n  const config = props.options;\n  props.onOptionsChange({\n    ...config,\n    secureJsonData: {\n      ...(config.secureJsonData ? config.secureJsonData : ({} as S)),\n      [key]: '',\n    },\n    secureJsonFields: {\n      ...config.secureJsonFields,\n      [key]: false,\n    },\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}