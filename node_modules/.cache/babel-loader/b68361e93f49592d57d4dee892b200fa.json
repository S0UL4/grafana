{"ast":null,"code":"import { locationUtil } from '@grafana/data';\nimport { locationService, navigationLogger } from '@grafana/runtime';\nexport function interceptLinkClicks(e) {\n  const anchor = getParentAnchor(e.target); // Ignore if opening new tab or already default prevented\n\n  if (e.ctrlKey || e.metaKey || e.defaultPrevented) {\n    return;\n  }\n\n  if (anchor) {\n    let href = anchor.getAttribute('href');\n    const target = anchor.getAttribute('target');\n\n    if (href && !target) {\n      navigationLogger('utils', false, 'intercepting link click', e);\n      e.preventDefault();\n      href = locationUtil.stripBaseFromUrl(href); // Ensure old angular urls with no starting '/' are handled the same as before\n      // Make sure external links are handled correctly\n      // That is they where seen as being absolute from app root\n\n      if (href[0] !== '/') {\n        // if still contains protocol or is a mailto link, it's an absolute link to another domain or web application\n        if (href.indexOf('://') > 0 || href.indexOf('mailto:') === 0) {\n          window.location.href = href;\n          return;\n        } else if (href.indexOf('#') === 0) {\n          // If it is a hash click, update the hash instead of trying to update the history\n          window.location.hash = href;\n          return;\n        } else {\n          href = `/${href}`;\n        }\n      }\n\n      locationService.push(href);\n    }\n  }\n}\n\nfunction getParentAnchor(element) {\n  while (element !== null && element.tagName) {\n    if (element.tagName.toUpperCase() === 'A') {\n      return element;\n    }\n\n    element = element.parentNode;\n  }\n\n  return null;\n}","map":{"version":3,"names":["locationUtil","locationService","navigationLogger","interceptLinkClicks","e","anchor","getParentAnchor","target","ctrlKey","metaKey","defaultPrevented","href","getAttribute","preventDefault","stripBaseFromUrl","indexOf","window","location","hash","push","element","tagName","toUpperCase","parentNode"],"sources":["/home/soula/grafana/public/app/core/navigation/patch/interceptLinkClicks.ts"],"sourcesContent":["import { locationUtil } from '@grafana/data';\nimport { locationService, navigationLogger } from '@grafana/runtime';\n\nexport function interceptLinkClicks(e: MouseEvent) {\n  const anchor = getParentAnchor(e.target as HTMLElement);\n\n  // Ignore if opening new tab or already default prevented\n  if (e.ctrlKey || e.metaKey || e.defaultPrevented) {\n    return;\n  }\n\n  if (anchor) {\n    let href = anchor.getAttribute('href');\n    const target = anchor.getAttribute('target');\n\n    if (href && !target) {\n      navigationLogger('utils', false, 'intercepting link click', e);\n      e.preventDefault();\n\n      href = locationUtil.stripBaseFromUrl(href);\n\n      // Ensure old angular urls with no starting '/' are handled the same as before\n      // Make sure external links are handled correctly\n      // That is they where seen as being absolute from app root\n      if (href[0] !== '/') {\n        // if still contains protocol or is a mailto link, it's an absolute link to another domain or web application\n        if (href.indexOf('://') > 0 || href.indexOf('mailto:') === 0) {\n          window.location.href = href;\n          return;\n        } else if (href.indexOf('#') === 0) {\n          // If it is a hash click, update the hash instead of trying to update the history\n          window.location.hash = href;\n          return;\n        } else {\n          href = `/${href}`;\n        }\n      }\n      locationService.push(href);\n    }\n  }\n}\n\nfunction getParentAnchor(element: HTMLElement | null): HTMLElement | null {\n  while (element !== null && element.tagName) {\n    if (element.tagName.toUpperCase() === 'A') {\n      return element;\n    }\n    element = element.parentNode as HTMLElement;\n  }\n\n  return null;\n}\n"],"mappings":"AAAA,SAASA,YAAT,QAA6B,eAA7B;AACA,SAASC,eAAT,EAA0BC,gBAA1B,QAAkD,kBAAlD;AAEA,OAAO,SAASC,mBAAT,CAA6BC,CAA7B,EAA4C;EACjD,MAAMC,MAAM,GAAGC,eAAe,CAACF,CAAC,CAACG,MAAH,CAA9B,CADiD,CAGjD;;EACA,IAAIH,CAAC,CAACI,OAAF,IAAaJ,CAAC,CAACK,OAAf,IAA0BL,CAAC,CAACM,gBAAhC,EAAkD;IAChD;EACD;;EAED,IAAIL,MAAJ,EAAY;IACV,IAAIM,IAAI,GAAGN,MAAM,CAACO,YAAP,CAAoB,MAApB,CAAX;IACA,MAAML,MAAM,GAAGF,MAAM,CAACO,YAAP,CAAoB,QAApB,CAAf;;IAEA,IAAID,IAAI,IAAI,CAACJ,MAAb,EAAqB;MACnBL,gBAAgB,CAAC,OAAD,EAAU,KAAV,EAAiB,yBAAjB,EAA4CE,CAA5C,CAAhB;MACAA,CAAC,CAACS,cAAF;MAEAF,IAAI,GAAGX,YAAY,CAACc,gBAAb,CAA8BH,IAA9B,CAAP,CAJmB,CAMnB;MACA;MACA;;MACA,IAAIA,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAhB,EAAqB;QACnB;QACA,IAAIA,IAAI,CAACI,OAAL,CAAa,KAAb,IAAsB,CAAtB,IAA2BJ,IAAI,CAACI,OAAL,CAAa,SAAb,MAA4B,CAA3D,EAA8D;UAC5DC,MAAM,CAACC,QAAP,CAAgBN,IAAhB,GAAuBA,IAAvB;UACA;QACD,CAHD,MAGO,IAAIA,IAAI,CAACI,OAAL,CAAa,GAAb,MAAsB,CAA1B,EAA6B;UAClC;UACAC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuBP,IAAvB;UACA;QACD,CAJM,MAIA;UACLA,IAAI,GAAI,IAAGA,IAAK,EAAhB;QACD;MACF;;MACDV,eAAe,CAACkB,IAAhB,CAAqBR,IAArB;IACD;EACF;AACF;;AAED,SAASL,eAAT,CAAyBc,OAAzB,EAA0E;EACxE,OAAOA,OAAO,KAAK,IAAZ,IAAoBA,OAAO,CAACC,OAAnC,EAA4C;IAC1C,IAAID,OAAO,CAACC,OAAR,CAAgBC,WAAhB,OAAkC,GAAtC,EAA2C;MACzC,OAAOF,OAAP;IACD;;IACDA,OAAO,GAAGA,OAAO,CAACG,UAAlB;EACD;;EAED,OAAO,IAAP;AACD"},"metadata":{},"sourceType":"module"}