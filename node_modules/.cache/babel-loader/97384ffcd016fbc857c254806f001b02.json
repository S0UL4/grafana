{"ast":null,"code":"import { isArray, isString } from 'lodash';\nexport const toUrl = filters => {\n  return filters.map(filter => toArray(filter).map(escapeDelimiter).join('|'));\n};\nexport const toFilters = value => {\n  if (isArray(value)) {\n    const values = value;\n    return values.map(toFilter).filter(isFilter);\n  }\n\n  const filter = toFilter(value);\n  return filter === null ? [] : [filter];\n};\n\nfunction escapeDelimiter(value) {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  return /\\|/g[Symbol.replace](value, '__gfp__');\n}\n\nfunction unescapeDelimiter(value) {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  return /__gfp__/g[Symbol.replace](value, '|');\n}\n\nfunction toArray(filter) {\n  return [filter.key, filter.operator, filter.value];\n}\n\nfunction toFilter(value) {\n  if (!isString(value) || value.length === 0) {\n    return null;\n  }\n\n  const parts = value.split('|').map(unescapeDelimiter);\n  return {\n    key: parts[0],\n    operator: parts[1],\n    value: parts[2],\n    condition: ''\n  };\n}\n\nfunction isFilter(filter) {\n  return filter !== null && isString(filter.value);\n}","map":{"version":3,"names":["isArray","isString","toUrl","filters","map","filter","toArray","escapeDelimiter","join","toFilters","value","values","toFilter","isFilter","undefined","Symbol","replace","unescapeDelimiter","key","operator","length","parts","split","condition"],"sources":["/home/soula/grafana/public/app/features/variables/adhoc/urlParser.ts"],"sourcesContent":["import { isArray, isString } from 'lodash';\n\nimport { UrlQueryValue } from '@grafana/data';\nimport { AdHocVariableFilter } from 'app/features/variables/types';\n\nexport const toUrl = (filters: AdHocVariableFilter[]): string[] => {\n  return filters.map((filter) => toArray(filter).map(escapeDelimiter).join('|'));\n};\n\nexport const toFilters = (value: UrlQueryValue): AdHocVariableFilter[] => {\n  if (isArray(value)) {\n    const values = value as any[];\n    return values.map(toFilter).filter(isFilter);\n  }\n\n  const filter = toFilter(value);\n  return filter === null ? [] : [filter];\n};\n\nfunction escapeDelimiter(value: string | undefined): string {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  return /\\|/g[Symbol.replace](value, '__gfp__');\n}\n\nfunction unescapeDelimiter(value: string | undefined): string {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  return /__gfp__/g[Symbol.replace](value, '|');\n}\n\nfunction toArray(filter: AdHocVariableFilter): string[] {\n  return [filter.key, filter.operator, filter.value];\n}\n\nfunction toFilter(value: string | number | boolean | undefined | null): AdHocVariableFilter | null {\n  if (!isString(value) || value.length === 0) {\n    return null;\n  }\n\n  const parts = value.split('|').map(unescapeDelimiter);\n\n  return {\n    key: parts[0],\n    operator: parts[1],\n    value: parts[2],\n    condition: '',\n  };\n}\n\nfunction isFilter(filter: AdHocVariableFilter | null): filter is AdHocVariableFilter {\n  return filter !== null && isString(filter.value);\n}\n"],"mappings":"AAAA,SAASA,OAAT,EAAkBC,QAAlB,QAAkC,QAAlC;AAKA,OAAO,MAAMC,KAAK,GAAIC,OAAD,IAA8C;EACjE,OAAOA,OAAO,CAACC,GAAR,CAAaC,MAAD,IAAYC,OAAO,CAACD,MAAD,CAAP,CAAgBD,GAAhB,CAAoBG,eAApB,EAAqCC,IAArC,CAA0C,GAA1C,CAAxB,CAAP;AACD,CAFM;AAIP,OAAO,MAAMC,SAAS,GAAIC,KAAD,IAAiD;EACxE,IAAIV,OAAO,CAACU,KAAD,CAAX,EAAoB;IAClB,MAAMC,MAAM,GAAGD,KAAf;IACA,OAAOC,MAAM,CAACP,GAAP,CAAWQ,QAAX,EAAqBP,MAArB,CAA4BQ,QAA5B,CAAP;EACD;;EAED,MAAMR,MAAM,GAAGO,QAAQ,CAACF,KAAD,CAAvB;EACA,OAAOL,MAAM,KAAK,IAAX,GAAkB,EAAlB,GAAuB,CAACA,MAAD,CAA9B;AACD,CARM;;AAUP,SAASE,eAAT,CAAyBG,KAAzB,EAA4D;EAC1D,IAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKI,SAAhC,EAA2C;IACzC,OAAO,EAAP;EACD;;EAED,OAAO,MAAMC,MAAM,CAACC,OAAb,EAAsBN,KAAtB,EAA6B,SAA7B,CAAP;AACD;;AAED,SAASO,iBAAT,CAA2BP,KAA3B,EAA8D;EAC5D,IAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKI,SAAhC,EAA2C;IACzC,OAAO,EAAP;EACD;;EAED,OAAO,WAAWC,MAAM,CAACC,OAAlB,EAA2BN,KAA3B,EAAkC,GAAlC,CAAP;AACD;;AAED,SAASJ,OAAT,CAAiBD,MAAjB,EAAwD;EACtD,OAAO,CAACA,MAAM,CAACa,GAAR,EAAab,MAAM,CAACc,QAApB,EAA8Bd,MAAM,CAACK,KAArC,CAAP;AACD;;AAED,SAASE,QAAT,CAAkBF,KAAlB,EAAmG;EACjG,IAAI,CAACT,QAAQ,CAACS,KAAD,CAAT,IAAoBA,KAAK,CAACU,MAAN,KAAiB,CAAzC,EAA4C;IAC1C,OAAO,IAAP;EACD;;EAED,MAAMC,KAAK,GAAGX,KAAK,CAACY,KAAN,CAAY,GAAZ,EAAiBlB,GAAjB,CAAqBa,iBAArB,CAAd;EAEA,OAAO;IACLC,GAAG,EAAEG,KAAK,CAAC,CAAD,CADL;IAELF,QAAQ,EAAEE,KAAK,CAAC,CAAD,CAFV;IAGLX,KAAK,EAAEW,KAAK,CAAC,CAAD,CAHP;IAILE,SAAS,EAAE;EAJN,CAAP;AAMD;;AAED,SAASV,QAAT,CAAkBR,MAAlB,EAAqF;EACnF,OAAOA,MAAM,KAAK,IAAX,IAAmBJ,QAAQ,CAACI,MAAM,CAACK,KAAR,CAAlC;AACD"},"metadata":{},"sourceType":"module"}