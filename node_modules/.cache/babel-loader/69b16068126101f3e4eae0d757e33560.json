{"ast":null,"code":"function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nexport class GraphContextMenuCtrl {\n  constructor($scope) {\n    _defineProperty(this, \"source\", void 0);\n\n    _defineProperty(this, \"scope\", void 0);\n\n    _defineProperty(this, \"menuItemsSupplier\", void 0);\n\n    _defineProperty(this, \"scrollContextElement\", null);\n\n    _defineProperty(this, \"position\", {\n      x: 0,\n      y: 0\n    });\n\n    _defineProperty(this, \"isVisible\", void 0);\n\n    _defineProperty(this, \"onClose\", () => {\n      if (this.scrollContextElement) {\n        this.scrollContextElement.removeEventListener('scroll', this.onClose);\n      }\n\n      this.scope.$apply(() => {\n        this.isVisible = false;\n      });\n    });\n\n    _defineProperty(this, \"toggleMenu\", event => {\n      this.isVisible = !this.isVisible;\n\n      if (this.isVisible && this.scrollContextElement) {\n        this.scrollContextElement.addEventListener('scroll', this.onClose);\n      }\n\n      if (this.source) {\n        this.position = {\n          x: this.source.pageX,\n          y: this.source.pageY\n        };\n      } else {\n        this.position = {\n          x: event ? event.pageX : 0,\n          y: event ? event.pageY : 0\n        };\n      }\n    });\n\n    _defineProperty(this, \"setScrollContextElement\", el => {\n      this.scrollContextElement = el;\n    });\n\n    _defineProperty(this, \"setSource\", source => {\n      this.source = source;\n    });\n\n    _defineProperty(this, \"getSource\", () => {\n      return this.source;\n    });\n\n    _defineProperty(this, \"setMenuItemsSupplier\", menuItemsSupplier => {\n      this.menuItemsSupplier = menuItemsSupplier;\n    });\n\n    this.isVisible = false;\n    this.scope = $scope;\n  }\n\n}","map":{"version":3,"names":["GraphContextMenuCtrl","constructor","$scope","x","y","scrollContextElement","removeEventListener","onClose","scope","$apply","isVisible","event","addEventListener","source","position","pageX","pageY","el","menuItemsSupplier"],"sources":["/home/soula/grafana/public/app/plugins/panel/graph/GraphContextMenuCtrl.ts"],"sourcesContent":["import { FlotDataPoint } from '@grafana/data';\nimport { MenuItemProps } from '@grafana/ui';\n\nexport class GraphContextMenuCtrl {\n  private source?: FlotDataPoint | null;\n  private scope?: any;\n  menuItemsSupplier?: () => MenuItemProps[];\n  scrollContextElement: HTMLElement | null = null;\n  position: {\n    x: number;\n    y: number;\n  } = { x: 0, y: 0 };\n\n  isVisible: boolean;\n\n  constructor($scope: any) {\n    this.isVisible = false;\n    this.scope = $scope;\n  }\n\n  onClose = () => {\n    if (this.scrollContextElement) {\n      this.scrollContextElement.removeEventListener('scroll', this.onClose);\n    }\n\n    this.scope.$apply(() => {\n      this.isVisible = false;\n    });\n  };\n\n  toggleMenu = (event?: { pageX: number; pageY: number }) => {\n    this.isVisible = !this.isVisible;\n    if (this.isVisible && this.scrollContextElement) {\n      this.scrollContextElement.addEventListener('scroll', this.onClose);\n    }\n\n    if (this.source) {\n      this.position = {\n        x: this.source.pageX,\n        y: this.source.pageY,\n      };\n    } else {\n      this.position = {\n        x: event ? event.pageX : 0,\n        y: event ? event.pageY : 0,\n      };\n    }\n  };\n\n  // Sets element which is considered as a scroll context of given context menu.\n  // Having access to this element allows scroll event attachement for menu to be closed when user scrolls\n  setScrollContextElement = (el: HTMLElement | null) => {\n    this.scrollContextElement = el;\n  };\n\n  setSource = (source: FlotDataPoint | null) => {\n    this.source = source;\n  };\n\n  getSource = () => {\n    return this.source;\n  };\n\n  setMenuItemsSupplier = (menuItemsSupplier: () => MenuItemProps[]) => {\n    this.menuItemsSupplier = menuItemsSupplier;\n  };\n}\n"],"mappings":";;AAGA,OAAO,MAAMA,oBAAN,CAA2B;EAYhCC,WAAW,CAACC,MAAD,EAAc;IAAA;;IAAA;;IAAA;;IAAA,8CARkB,IAQlB;;IAAA,kCAJrB;MAAEC,CAAC,EAAE,CAAL;MAAQC,CAAC,EAAE;IAAX,CAIqB;;IAAA;;IAAA,iCAKf,MAAM;MACd,IAAI,KAAKC,oBAAT,EAA+B;QAC7B,KAAKA,oBAAL,CAA0BC,mBAA1B,CAA8C,QAA9C,EAAwD,KAAKC,OAA7D;MACD;;MAED,KAAKC,KAAL,CAAWC,MAAX,CAAkB,MAAM;QACtB,KAAKC,SAAL,GAAiB,KAAjB;MACD,CAFD;IAGD,CAbwB;;IAAA,oCAeXC,KAAD,IAA8C;MACzD,KAAKD,SAAL,GAAiB,CAAC,KAAKA,SAAvB;;MACA,IAAI,KAAKA,SAAL,IAAkB,KAAKL,oBAA3B,EAAiD;QAC/C,KAAKA,oBAAL,CAA0BO,gBAA1B,CAA2C,QAA3C,EAAqD,KAAKL,OAA1D;MACD;;MAED,IAAI,KAAKM,MAAT,EAAiB;QACf,KAAKC,QAAL,GAAgB;UACdX,CAAC,EAAE,KAAKU,MAAL,CAAYE,KADD;UAEdX,CAAC,EAAE,KAAKS,MAAL,CAAYG;QAFD,CAAhB;MAID,CALD,MAKO;QACL,KAAKF,QAAL,GAAgB;UACdX,CAAC,EAAEQ,KAAK,GAAGA,KAAK,CAACI,KAAT,GAAiB,CADX;UAEdX,CAAC,EAAEO,KAAK,GAAGA,KAAK,CAACK,KAAT,GAAiB;QAFX,CAAhB;MAID;IACF,CAhCwB;;IAAA,iDAoCEC,EAAD,IAA4B;MACpD,KAAKZ,oBAAL,GAA4BY,EAA5B;IACD,CAtCwB;;IAAA,mCAwCZJ,MAAD,IAAkC;MAC5C,KAAKA,MAAL,GAAcA,MAAd;IACD,CA1CwB;;IAAA,mCA4Cb,MAAM;MAChB,OAAO,KAAKA,MAAZ;IACD,CA9CwB;;IAAA,8CAgDDK,iBAAD,IAA8C;MACnE,KAAKA,iBAAL,GAAyBA,iBAAzB;IACD,CAlDwB;;IACvB,KAAKR,SAAL,GAAiB,KAAjB;IACA,KAAKF,KAAL,GAAaN,MAAb;EACD;;AAf+B"},"metadata":{},"sourceType":"module"}