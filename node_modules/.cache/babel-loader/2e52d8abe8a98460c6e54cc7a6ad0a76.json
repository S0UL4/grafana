{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nexport const initialVariableEditorState = {\n  id: '',\n  isValid: true,\n  errors: {},\n  name: '',\n  extended: null\n};\nconst variableEditorReducerSlice = createSlice({\n  name: 'templating/editor',\n  initialState: initialVariableEditorState,\n  reducers: {\n    setIdInEditor: (state, action) => {\n      state.id = action.payload.id;\n    },\n    clearIdInEditor: (state, action) => {\n      state.id = '';\n    },\n    variableEditorMounted: (state, action) => {\n      state.name = action.payload.name;\n    },\n    variableEditorUnMounted: (state, action) => {\n      return initialVariableEditorState;\n    },\n    changeVariableNameSucceeded: (state, action) => {\n      state.name = action.payload.data.newName;\n      delete state.errors['name'];\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    changeVariableNameFailed: (state, action) => {\n      state.name = action.payload.newName;\n      state.errors.name = action.payload.errorText;\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    addVariableEditorError: (state, action) => {\n      state.errors[action.payload.errorProp] = action.payload.errorText;\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    removeVariableEditorError: (state, action) => {\n      delete state.errors[action.payload.errorProp];\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    changeVariableEditorExtended: (state, action) => {\n      state.extended = Object.assign({}, state.extended, action.payload);\n    },\n    cleanEditorState: () => initialVariableEditorState\n  }\n});\nexport const variableEditorReducer = variableEditorReducerSlice.reducer;\nexport const {\n  setIdInEditor,\n  clearIdInEditor,\n  changeVariableNameSucceeded,\n  changeVariableNameFailed,\n  variableEditorMounted,\n  variableEditorUnMounted,\n  changeVariableEditorExtended,\n  addVariableEditorError,\n  removeVariableEditorError,\n  cleanEditorState\n} = variableEditorReducerSlice.actions;","map":{"version":3,"names":["createSlice","initialVariableEditorState","id","isValid","errors","name","extended","variableEditorReducerSlice","initialState","reducers","setIdInEditor","state","action","payload","clearIdInEditor","variableEditorMounted","variableEditorUnMounted","changeVariableNameSucceeded","data","newName","Object","keys","length","changeVariableNameFailed","errorText","addVariableEditorError","errorProp","removeVariableEditorError","changeVariableEditorExtended","cleanEditorState","variableEditorReducer","reducer","actions"],"sources":["/home/soula/grafana/public/app/features/variables/editor/reducer.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { DataSourceApi, DataSourceRef } from '@grafana/data';\n\nimport { VariablePayload } from '../state/types';\nimport { VariableQueryEditorType } from '../types';\n\nexport interface AdHocVariableEditorState {\n  infoText?: string;\n  dataSources: Array<{ text: string; value: DataSourceRef | null }>;\n}\n\nexport interface DataSourceVariableEditorState {\n  dataSourceTypes: Array<{ text: string; value: string }>;\n}\n\nexport interface QueryVariableEditorState {\n  VariableQueryEditor: VariableQueryEditorType;\n  dataSource: DataSourceApi | null;\n}\n\ntype VariableEditorExtension = AdHocVariableEditorState | DataSourceVariableEditorState | QueryVariableEditorState;\n\nexport interface VariableEditorState {\n  id: string;\n  name: string;\n  errors: Record<string, string>;\n  isValid: boolean;\n  extended: VariableEditorExtension | null;\n}\n\nexport const initialVariableEditorState: VariableEditorState = {\n  id: '',\n  isValid: true,\n  errors: {},\n  name: '',\n  extended: null,\n};\n\nconst variableEditorReducerSlice = createSlice({\n  name: 'templating/editor',\n  initialState: initialVariableEditorState,\n  reducers: {\n    setIdInEditor: (state: VariableEditorState, action: PayloadAction<{ id: string }>) => {\n      state.id = action.payload.id;\n    },\n    clearIdInEditor: (state: VariableEditorState, action: PayloadAction<undefined>) => {\n      state.id = '';\n    },\n    variableEditorMounted: (state: VariableEditorState, action: PayloadAction<{ name: string }>) => {\n      state.name = action.payload.name;\n    },\n    variableEditorUnMounted: (state: VariableEditorState, action: PayloadAction<VariablePayload>) => {\n      return initialVariableEditorState;\n    },\n    changeVariableNameSucceeded: (\n      state: VariableEditorState,\n      action: PayloadAction<VariablePayload<{ newName: string }>>\n    ) => {\n      state.name = action.payload.data.newName;\n      delete state.errors['name'];\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    changeVariableNameFailed: (\n      state: VariableEditorState,\n      action: PayloadAction<{ newName: string; errorText: string }>\n    ) => {\n      state.name = action.payload.newName;\n      state.errors.name = action.payload.errorText;\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    addVariableEditorError: (\n      state: VariableEditorState,\n      action: PayloadAction<{ errorProp: string; errorText: any }>\n    ) => {\n      state.errors[action.payload.errorProp] = action.payload.errorText;\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    removeVariableEditorError: (state: VariableEditorState, action: PayloadAction<{ errorProp: string }>) => {\n      delete state.errors[action.payload.errorProp];\n      state.isValid = Object.keys(state.errors).length === 0;\n    },\n    changeVariableEditorExtended: (state: VariableEditorState, action: PayloadAction<VariableEditorExtension>) => {\n      state.extended = {\n        ...state.extended,\n        ...action.payload,\n      };\n    },\n    cleanEditorState: () => initialVariableEditorState,\n  },\n});\n\nexport const variableEditorReducer = variableEditorReducerSlice.reducer;\n\nexport const {\n  setIdInEditor,\n  clearIdInEditor,\n  changeVariableNameSucceeded,\n  changeVariableNameFailed,\n  variableEditorMounted,\n  variableEditorUnMounted,\n  changeVariableEditorExtended,\n  addVariableEditorError,\n  removeVariableEditorError,\n  cleanEditorState,\n} = variableEditorReducerSlice.actions;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}