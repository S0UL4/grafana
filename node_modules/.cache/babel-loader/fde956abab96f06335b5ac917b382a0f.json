{"ast":null,"code":"var _div;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport cx from 'classnames';\nimport memoizeOne from 'memoize-one';\nimport * as React from 'react';\nimport { ubPb2, ubPx2, ubRelative } from '../../uberUtilityStyles';\nimport CanvasSpanGraph from './CanvasSpanGraph';\nimport TickLabels from './TickLabels';\nimport ViewingLayer from './ViewingLayer';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nconst DEFAULT_HEIGHT = 60;\nconst TIMELINE_TICK_INTERVAL = 4;\n\nfunction getItem(span) {\n  return {\n    valueOffset: span.relativeStartTime,\n    valueWidth: span.duration,\n    serviceName: span.process.serviceName\n  };\n}\n\nfunction getItems(trace) {\n  return trace.spans.map(getItem);\n}\n\nconst memoizedGetitems = memoizeOne(getItems);\nexport default class SpanGraph extends React.PureComponent {\n  render() {\n    const {\n      height,\n      trace,\n      viewRange,\n      updateNextViewRangeTime,\n      updateViewRangeTime\n    } = this.props;\n\n    if (!trace) {\n      return _div || (_div = /*#__PURE__*/_jsx(\"div\", {}));\n    }\n\n    const items = memoizedGetitems(trace);\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: cx(ubPb2, ubPx2),\n      children: [/*#__PURE__*/_jsx(TickLabels, {\n        numTicks: TIMELINE_TICK_INTERVAL,\n        duration: trace.duration\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: ubRelative,\n        children: [/*#__PURE__*/_jsx(CanvasSpanGraph, {\n          valueWidth: trace.duration,\n          items: items\n        }), /*#__PURE__*/_jsx(ViewingLayer, {\n          viewRange: viewRange,\n          numTicks: TIMELINE_TICK_INTERVAL,\n          height: height || DEFAULT_HEIGHT,\n          updateViewRangeTime: updateViewRangeTime,\n          updateNextViewRangeTime: updateNextViewRangeTime\n        })]\n      })]\n    });\n  }\n\n}\n\n_defineProperty(SpanGraph, \"defaultProps\", {\n  height: DEFAULT_HEIGHT\n});","map":{"version":3,"names":["cx","memoizeOne","React","ubPb2","ubPx2","ubRelative","CanvasSpanGraph","TickLabels","ViewingLayer","DEFAULT_HEIGHT","TIMELINE_TICK_INTERVAL","getItem","span","valueOffset","relativeStartTime","valueWidth","duration","serviceName","process","getItems","trace","spans","map","memoizedGetitems","SpanGraph","PureComponent","render","height","viewRange","updateNextViewRangeTime","updateViewRangeTime","props","items"],"sources":["/home/soula/grafana/packages/jaeger-ui-components/src/TracePageHeader/SpanGraph/index.tsx"],"sourcesContent":["// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport cx from 'classnames';\nimport memoizeOne from 'memoize-one';\nimport * as React from 'react';\n\nimport { TUpdateViewRangeTimeFunction, ViewRange, ViewRangeTimeUpdate } from '../..';\nimport { TraceSpan, Trace } from '../../types/trace';\nimport { ubPb2, ubPx2, ubRelative } from '../../uberUtilityStyles';\n\nimport CanvasSpanGraph from './CanvasSpanGraph';\nimport TickLabels from './TickLabels';\nimport ViewingLayer from './ViewingLayer';\n\nconst DEFAULT_HEIGHT = 60;\nconst TIMELINE_TICK_INTERVAL = 4;\n\ntype SpanGraphProps = {\n  height?: number;\n  trace: Trace;\n  viewRange: ViewRange;\n  updateViewRangeTime: TUpdateViewRangeTimeFunction;\n  updateNextViewRangeTime: (nextUpdate: ViewRangeTimeUpdate) => void;\n};\n\ntype SpanItem = {\n  valueOffset: number;\n  valueWidth: number;\n  serviceName: string;\n};\n\nfunction getItem(span: TraceSpan): SpanItem {\n  return {\n    valueOffset: span.relativeStartTime,\n    valueWidth: span.duration,\n    serviceName: span.process.serviceName,\n  };\n}\n\nfunction getItems(trace: Trace): SpanItem[] {\n  return trace.spans.map(getItem);\n}\n\nconst memoizedGetitems = memoizeOne(getItems);\n\nexport default class SpanGraph extends React.PureComponent<SpanGraphProps> {\n  static defaultProps = {\n    height: DEFAULT_HEIGHT,\n  };\n\n  render() {\n    const { height, trace, viewRange, updateNextViewRangeTime, updateViewRangeTime } = this.props;\n    if (!trace) {\n      return <div />;\n    }\n\n    const items = memoizedGetitems(trace);\n    return (\n      <div className={cx(ubPb2, ubPx2)}>\n        <TickLabels numTicks={TIMELINE_TICK_INTERVAL} duration={trace.duration} />\n        <div className={ubRelative}>\n          <CanvasSpanGraph valueWidth={trace.duration} items={items} />\n          <ViewingLayer\n            viewRange={viewRange}\n            numTicks={TIMELINE_TICK_INTERVAL}\n            height={height || DEFAULT_HEIGHT}\n            updateViewRangeTime={updateViewRangeTime}\n            updateNextViewRangeTime={updateNextViewRangeTime}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,EAAP,MAAe,YAAf;AACA,OAAOC,UAAP,MAAuB,aAAvB;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AAIA,SAASC,KAAT,EAAgBC,KAAhB,EAAuBC,UAAvB,QAAyC,yBAAzC;AAEA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;;;AAEA,MAAMC,cAAc,GAAG,EAAvB;AACA,MAAMC,sBAAsB,GAAG,CAA/B;;AAgBA,SAASC,OAAT,CAAiBC,IAAjB,EAA4C;EAC1C,OAAO;IACLC,WAAW,EAAED,IAAI,CAACE,iBADb;IAELC,UAAU,EAAEH,IAAI,CAACI,QAFZ;IAGLC,WAAW,EAAEL,IAAI,CAACM,OAAL,CAAaD;EAHrB,CAAP;AAKD;;AAED,SAASE,QAAT,CAAkBC,KAAlB,EAA4C;EAC1C,OAAOA,KAAK,CAACC,KAAN,CAAYC,GAAZ,CAAgBX,OAAhB,CAAP;AACD;;AAED,MAAMY,gBAAgB,GAAGtB,UAAU,CAACkB,QAAD,CAAnC;AAEA,eAAe,MAAMK,SAAN,SAAwBtB,KAAK,CAACuB,aAA9B,CAA4D;EAKzEC,MAAM,GAAG;IACP,MAAM;MAAEC,MAAF;MAAUP,KAAV;MAAiBQ,SAAjB;MAA4BC,uBAA5B;MAAqDC;IAArD,IAA6E,KAAKC,KAAxF;;IACA,IAAI,CAACX,KAAL,EAAY;MACV,oCAAO,eAAP;IACD;;IAED,MAAMY,KAAK,GAAGT,gBAAgB,CAACH,KAAD,CAA9B;IACA,oBACE;MAAK,SAAS,EAAEpB,EAAE,CAACG,KAAD,EAAQC,KAAR,CAAlB;MAAA,wBACE,KAAC,UAAD;QAAY,QAAQ,EAAEM,sBAAtB;QAA8C,QAAQ,EAAEU,KAAK,CAACJ;MAA9D,EADF,eAEE;QAAK,SAAS,EAAEX,UAAhB;QAAA,wBACE,KAAC,eAAD;UAAiB,UAAU,EAAEe,KAAK,CAACJ,QAAnC;UAA6C,KAAK,EAAEgB;QAApD,EADF,eAEE,KAAC,YAAD;UACE,SAAS,EAAEJ,SADb;UAEE,QAAQ,EAAElB,sBAFZ;UAGE,MAAM,EAAEiB,MAAM,IAAIlB,cAHpB;UAIE,mBAAmB,EAAEqB,mBAJvB;UAKE,uBAAuB,EAAED;QAL3B,EAFF;MAAA,EAFF;IAAA,EADF;EAeD;;AA3BwE;;gBAAtDL,S,kBACG;EACpBG,MAAM,EAAElB;AADY,C"},"metadata":{},"sourceType":"module"}