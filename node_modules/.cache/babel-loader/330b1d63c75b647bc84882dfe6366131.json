{"ast":null,"code":"import { css } from '@emotion/css';\nimport React from 'react';\nimport { config } from '@grafana/runtime';\nimport { HorizontalGroup, RadioButtonGroup, useStyles2, Checkbox, Button } from '@grafana/ui';\nimport { SortPicker } from 'app/core/components/Select/SortPicker';\nimport { TagFilter } from 'app/core/components/TagFilter/TagFilter';\nimport { SEARCH_SELECTED_LAYOUT } from '../../constants';\nimport { SearchLayout } from '../../types';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const layoutOptions = [{\n  value: SearchLayout.Folders,\n  icon: 'folder',\n  ariaLabel: 'View by folders'\n}, {\n  value: SearchLayout.List,\n  icon: 'list-ul',\n  ariaLabel: 'View as list'\n}];\n\nif (config.featureToggles.dashboardPreviews) {\n  layoutOptions.push({\n    value: SearchLayout.Grid,\n    icon: 'apps',\n    ariaLabel: 'Grid view'\n  });\n}\n\nexport function getValidQueryLayout(q) {\n  var _q$layout;\n\n  const layout = (_q$layout = q.layout) !== null && _q$layout !== void 0 ? _q$layout : SearchLayout.Folders; // Folders is not valid when a query exists\n\n  if (layout === SearchLayout.Folders) {\n    if (q.query || q.sort) {\n      return SearchLayout.List;\n    }\n  }\n\n  if (layout === SearchLayout.Grid && !config.featureToggles.dashboardPreviews) {\n    return SearchLayout.List;\n  }\n\n  return layout;\n}\nexport const ActionRow = ({\n  onLayoutChange,\n  onSortChange,\n  onStarredFilterChange = () => {},\n  onTagFilterChange,\n  getTagOptions,\n  getSortOptions,\n  onDatasourceChange,\n  query,\n  showStarredFilter,\n  hideLayout,\n  includePanels,\n  setIncludePanels\n}) => {\n  var _query$sort;\n\n  const styles = useStyles2(getStyles);\n  const layout = getValidQueryLayout(query); // Disabled folder layout option when query is present\n\n  const disabledOptions = query.query ? [SearchLayout.Folders] : [];\n\n  const updateLayoutPreference = layout => {\n    localStorage.setItem(SEARCH_SELECTED_LAYOUT, layout);\n    onLayoutChange(layout);\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.actionRow,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: styles.rowContainer,\n      children: /*#__PURE__*/_jsxs(HorizontalGroup, {\n        spacing: \"md\",\n        width: \"auto\",\n        children: [!hideLayout && /*#__PURE__*/_jsx(RadioButtonGroup, {\n          options: layoutOptions,\n          disabledOptions: disabledOptions,\n          onChange: updateLayoutPreference,\n          value: layout\n        }), /*#__PURE__*/_jsx(SortPicker, {\n          onChange: onSortChange,\n          value: (_query$sort = query.sort) === null || _query$sort === void 0 ? void 0 : _query$sort.value,\n          getSortOptions: getSortOptions,\n          isClearable: true\n        })]\n      })\n    }), /*#__PURE__*/_jsxs(HorizontalGroup, {\n      spacing: \"md\",\n      width: \"auto\",\n      children: [showStarredFilter && /*#__PURE__*/_jsx(\"div\", {\n        className: styles.checkboxWrapper,\n        children: /*#__PURE__*/_jsx(Checkbox, {\n          label: \"Filter by starred\",\n          onChange: onStarredFilterChange,\n          value: query.starred\n        })\n      }), query.datasource && /*#__PURE__*/_jsxs(Button, {\n        icon: \"times\",\n        variant: \"secondary\",\n        onClick: () => onDatasourceChange(undefined),\n        children: [\"Datasource: \", query.datasource]\n      }), layout !== SearchLayout.Folders && config.featureToggles.panelTitleSearch && /*#__PURE__*/_jsx(Checkbox, {\n        value: includePanels,\n        onChange: () => setIncludePanels(!includePanels),\n        label: \"Include panels\"\n      }), /*#__PURE__*/_jsx(TagFilter, {\n        isClearable: true,\n        tags: query.tag,\n        tagOptions: getTagOptions,\n        onChange: onTagFilterChange\n      })]\n    })]\n  });\n};\nActionRow.displayName = 'ActionRow';\nexport const getStyles = theme => {\n  return {\n    actionRow: css`\n      display: none;\n\n      ${theme.breakpoints.up('md')} {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding-bottom: ${theme.spacing(2)};\n        width: 100%;\n      }\n    `,\n    rowContainer: css`\n      margin-right: ${theme.v1.spacing.md};\n    `,\n    checkboxWrapper: css`\n      label {\n        line-height: 1.2;\n      }\n    `\n  };\n};","map":{"version":3,"names":["css","React","config","HorizontalGroup","RadioButtonGroup","useStyles2","Checkbox","Button","SortPicker","TagFilter","SEARCH_SELECTED_LAYOUT","SearchLayout","layoutOptions","value","Folders","icon","ariaLabel","List","featureToggles","dashboardPreviews","push","Grid","getValidQueryLayout","q","layout","query","sort","ActionRow","onLayoutChange","onSortChange","onStarredFilterChange","onTagFilterChange","getTagOptions","getSortOptions","onDatasourceChange","showStarredFilter","hideLayout","includePanels","setIncludePanels","styles","getStyles","disabledOptions","updateLayoutPreference","localStorage","setItem","actionRow","rowContainer","checkboxWrapper","starred","datasource","undefined","panelTitleSearch","tag","displayName","theme","breakpoints","up","spacing","v1","md"],"sources":["/home/soula/grafana/public/app/features/search/page/components/ActionRow.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { FC, FormEvent } from 'react';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { HorizontalGroup, RadioButtonGroup, useStyles2, Checkbox, Button } from '@grafana/ui';\nimport { SortPicker } from 'app/core/components/Select/SortPicker';\nimport { TagFilter, TermCount } from 'app/core/components/TagFilter/TagFilter';\n\nimport { SEARCH_SELECTED_LAYOUT } from '../../constants';\nimport { DashboardQuery, SearchLayout } from '../../types';\n\nexport const layoutOptions = [\n  { value: SearchLayout.Folders, icon: 'folder', ariaLabel: 'View by folders' },\n  { value: SearchLayout.List, icon: 'list-ul', ariaLabel: 'View as list' },\n];\n\nif (config.featureToggles.dashboardPreviews) {\n  layoutOptions.push({ value: SearchLayout.Grid, icon: 'apps', ariaLabel: 'Grid view' });\n}\n\ninterface Props {\n  onLayoutChange: (layout: SearchLayout) => void;\n  onSortChange: (value: SelectableValue) => void;\n  onStarredFilterChange?: (event: FormEvent<HTMLInputElement>) => void;\n  onTagFilterChange: (tags: string[]) => void;\n  getTagOptions: () => Promise<TermCount[]>;\n  getSortOptions: () => Promise<SelectableValue[]>;\n  onDatasourceChange: (ds?: string) => void;\n  includePanels: boolean;\n  setIncludePanels: (v: boolean) => void;\n  query: DashboardQuery;\n  showStarredFilter?: boolean;\n  hideLayout?: boolean;\n}\n\nexport function getValidQueryLayout(q: DashboardQuery): SearchLayout {\n  const layout = q.layout ?? SearchLayout.Folders;\n\n  // Folders is not valid when a query exists\n  if (layout === SearchLayout.Folders) {\n    if (q.query || q.sort) {\n      return SearchLayout.List;\n    }\n  }\n\n  if (layout === SearchLayout.Grid && !config.featureToggles.dashboardPreviews) {\n    return SearchLayout.List;\n  }\n  return layout;\n}\n\nexport const ActionRow: FC<Props> = ({\n  onLayoutChange,\n  onSortChange,\n  onStarredFilterChange = () => {},\n  onTagFilterChange,\n  getTagOptions,\n  getSortOptions,\n  onDatasourceChange,\n  query,\n  showStarredFilter,\n  hideLayout,\n  includePanels,\n  setIncludePanels,\n}) => {\n  const styles = useStyles2(getStyles);\n  const layout = getValidQueryLayout(query);\n\n  // Disabled folder layout option when query is present\n  const disabledOptions = query.query ? [SearchLayout.Folders] : [];\n\n  const updateLayoutPreference = (layout: SearchLayout) => {\n    localStorage.setItem(SEARCH_SELECTED_LAYOUT, layout);\n    onLayoutChange(layout);\n  };\n\n  return (\n    <div className={styles.actionRow}>\n      <div className={styles.rowContainer}>\n        <HorizontalGroup spacing=\"md\" width=\"auto\">\n          {!hideLayout && (\n            <RadioButtonGroup\n              options={layoutOptions}\n              disabledOptions={disabledOptions}\n              onChange={updateLayoutPreference}\n              value={layout}\n            />\n          )}\n          <SortPicker onChange={onSortChange} value={query.sort?.value} getSortOptions={getSortOptions} isClearable />\n        </HorizontalGroup>\n      </div>\n      <HorizontalGroup spacing=\"md\" width=\"auto\">\n        {showStarredFilter && (\n          <div className={styles.checkboxWrapper}>\n            <Checkbox label=\"Filter by starred\" onChange={onStarredFilterChange} value={query.starred} />\n          </div>\n        )}\n        {query.datasource && (\n          <Button icon=\"times\" variant=\"secondary\" onClick={() => onDatasourceChange(undefined)}>\n            Datasource: {query.datasource}\n          </Button>\n        )}\n        {layout !== SearchLayout.Folders && config.featureToggles.panelTitleSearch && (\n          <Checkbox value={includePanels} onChange={() => setIncludePanels(!includePanels)} label=\"Include panels\" />\n        )}\n\n        <TagFilter isClearable tags={query.tag} tagOptions={getTagOptions} onChange={onTagFilterChange} />\n      </HorizontalGroup>\n    </div>\n  );\n};\n\nActionRow.displayName = 'ActionRow';\n\nexport const getStyles = (theme: GrafanaTheme2) => {\n  return {\n    actionRow: css`\n      display: none;\n\n      ${theme.breakpoints.up('md')} {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding-bottom: ${theme.spacing(2)};\n        width: 100%;\n      }\n    `,\n    rowContainer: css`\n      margin-right: ${theme.v1.spacing.md};\n    `,\n    checkboxWrapper: css`\n      label {\n        line-height: 1.2;\n      }\n    `,\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}