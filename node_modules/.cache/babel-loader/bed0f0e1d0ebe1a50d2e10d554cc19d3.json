{"ast":null,"code":"var _Space, _LoadingPlaceholder, _h, _Space2, _h2, _Space3, _Space4, _Space5, _Space6;\n\nimport { cx } from '@emotion/css';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useEffectOnce } from 'react-use';\nimport { Alert, Button, Icon, Input, LoadingPlaceholder, Tooltip, useStyles2, Collapse, Label } from '@grafana/ui';\nimport messageFromError from '../../utils/messageFromError';\nimport { Space } from '../Space';\nimport NestedRow from './NestedRow';\nimport Search from './Search';\nimport getStyles from './styles';\nimport { findRow } from './utils';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nconst ResourcePicker = ({\n  resourcePickerData,\n  resourceURI,\n  onApply,\n  onCancel,\n  selectableEntryTypes,\n  queryType\n}) => {\n  const styles = useStyles2(getStyles);\n  const [isLoading, setIsLoading] = useState(false);\n  const [rows, setRows] = useState([]);\n  const [selectedRows, setSelectedRows] = useState([]);\n  const [internalSelectedURI, setInternalSelectedURI] = useState(resourceURI);\n  const [errorMessage, setErrorMessage] = useState(undefined);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(resourceURI === null || resourceURI === void 0 ? void 0 : resourceURI.includes('$'));\n  const [shouldShowLimitFlag, setShouldShowLimitFlag] = useState(false); // Sync the resourceURI prop to internal state\n\n  useEffect(() => {\n    setInternalSelectedURI(resourceURI);\n  }, [resourceURI]);\n  const loadInitialData = useCallback(async () => {\n    if (!isLoading) {\n      try {\n        setIsLoading(true);\n        const resources = await resourcePickerData.fetchInitialRows(queryType, internalSelectedURI || '');\n        setRows(resources);\n      } catch (error) {\n        setErrorMessage(messageFromError(error));\n      }\n\n      setIsLoading(false);\n    }\n  }, [internalSelectedURI, isLoading, resourcePickerData, queryType]);\n  useEffectOnce(() => {\n    loadInitialData();\n  }); // set selected row data whenever row or selection changes\n\n  useEffect(() => {\n    if (!internalSelectedURI) {\n      setSelectedRows([]);\n    }\n\n    const found = internalSelectedURI && findRow(rows, internalSelectedURI);\n\n    if (found) {\n      return setSelectedRows([Object.assign({}, found, {\n        children: undefined\n      })]);\n    }\n  }, [internalSelectedURI, rows]); // Request resources for an expanded resource group\n\n  const requestNestedRows = useCallback(async parentRow => {\n    var _parentRow$children;\n\n    // clear error message (also when loading cached resources)\n    setErrorMessage(undefined); // If we already have children, we don't need to re-fetch them.\n\n    if ((_parentRow$children = parentRow.children) !== null && _parentRow$children !== void 0 && _parentRow$children.length) {\n      return;\n    }\n\n    try {\n      const nestedRows = await resourcePickerData.fetchAndAppendNestedRow(rows, parentRow, queryType);\n      setRows(nestedRows);\n    } catch (error) {\n      setErrorMessage(messageFromError(error));\n      throw error;\n    }\n  }, [resourcePickerData, rows, queryType]);\n  const handleSelectionChanged = useCallback((row, isSelected) => {\n    isSelected ? setInternalSelectedURI(row.uri) : setInternalSelectedURI(undefined);\n  }, []);\n  const handleApply = useCallback(() => {\n    onApply(internalSelectedURI);\n  }, [internalSelectedURI, onApply]);\n  const handleSearch = useCallback(async searchWord => {\n    // clear errors and warnings\n    setErrorMessage(undefined);\n    setShouldShowLimitFlag(false);\n\n    if (!searchWord) {\n      loadInitialData();\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const searchResults = await resourcePickerData.search(searchWord, queryType);\n      setRows(searchResults);\n\n      if (searchResults.length >= resourcePickerData.resultLimit) {\n        setShouldShowLimitFlag(true);\n      }\n    } catch (err) {\n      setErrorMessage(messageFromError(err));\n    }\n\n    setIsLoading(false);\n  }, [loadInitialData, resourcePickerData, queryType]);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(Search, {\n      searchFn: handleSearch\n    }), shouldShowLimitFlag ? /*#__PURE__*/_jsxs(\"p\", {\n      className: styles.resultLimit,\n      children: [\"Showing first \", resourcePickerData.resultLimit, \" results\"]\n    }) : _Space || (_Space = /*#__PURE__*/_jsx(Space, {\n      v: 2\n    })), /*#__PURE__*/_jsx(\"table\", {\n      className: styles.table,\n      children: /*#__PURE__*/_jsx(\"thead\", {\n        children: /*#__PURE__*/_jsxs(\"tr\", {\n          className: cx(styles.row, styles.header),\n          children: [/*#__PURE__*/_jsx(\"td\", {\n            className: styles.cell,\n            children: \"Scope\"\n          }), /*#__PURE__*/_jsx(\"td\", {\n            className: styles.cell,\n            children: \"Type\"\n          }), /*#__PURE__*/_jsx(\"td\", {\n            className: styles.cell,\n            children: \"Location\"\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: styles.tableScroller,\n      children: /*#__PURE__*/_jsx(\"table\", {\n        className: styles.table,\n        children: /*#__PURE__*/_jsxs(\"tbody\", {\n          children: [isLoading && /*#__PURE__*/_jsx(\"tr\", {\n            className: cx(styles.row),\n            children: /*#__PURE__*/_jsx(\"td\", {\n              className: styles.cell,\n              children: _LoadingPlaceholder || (_LoadingPlaceholder = /*#__PURE__*/_jsx(LoadingPlaceholder, {\n                text: 'Loading...'\n              }))\n            })\n          }), !isLoading && rows.length === 0 && /*#__PURE__*/_jsx(\"tr\", {\n            className: cx(styles.row),\n            children: /*#__PURE__*/_jsx(\"td\", {\n              className: styles.cell,\n              \"aria-live\": \"polite\",\n              children: \"No resources found\"\n            })\n          }), !isLoading && rows.map(row => /*#__PURE__*/_jsx(NestedRow, {\n            row: row,\n            selectedRows: selectedRows,\n            level: 0,\n            requestNestedRows: requestNestedRows,\n            onRowSelectedChange: handleSelectionChanged,\n            selectableEntryTypes: selectableEntryTypes,\n            scrollIntoView: true\n          }, row.uri))]\n        })\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.selectionFooter,\n      children: [selectedRows.length > 0 && /*#__PURE__*/_jsxs(_Fragment, {\n        children: [_h || (_h = /*#__PURE__*/_jsx(\"h5\", {\n          children: \"Selection\"\n        })), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.tableScroller,\n          children: /*#__PURE__*/_jsx(\"table\", {\n            className: styles.table,\n            children: /*#__PURE__*/_jsx(\"tbody\", {\n              children: selectedRows.map(row => /*#__PURE__*/_jsx(NestedRow, {\n                row: row,\n                selectedRows: selectedRows,\n                level: 0,\n                requestNestedRows: requestNestedRows,\n                onRowSelectedChange: handleSelectionChanged,\n                selectableEntryTypes: selectableEntryTypes\n              }, row.uri))\n            })\n          })\n        }), _Space2 || (_Space2 = /*#__PURE__*/_jsx(Space, {\n          v: 2\n        }))]\n      }), /*#__PURE__*/_jsxs(Collapse, {\n        collapsible: true,\n        label: \"Advanced\",\n        isOpen: isAdvancedOpen,\n        onToggle: () => setIsAdvancedOpen(!isAdvancedOpen),\n        children: [/*#__PURE__*/_jsx(Label, {\n          htmlFor: `input-${internalSelectedURI}`,\n          children: _h2 || (_h2 = /*#__PURE__*/_jsxs(\"h6\", {\n            children: [\"Resource URI\", ' ', /*#__PURE__*/_jsx(Tooltip, {\n              content: /*#__PURE__*/_jsxs(_Fragment, {\n                children: [\"Manually edit the\", ' ', /*#__PURE__*/_jsxs(\"a\", {\n                  href: \"https://docs.microsoft.com/en-us/azure/azure-monitor/logs/log-standard-columns#_resourceid\",\n                  rel: \"noopener noreferrer\",\n                  target: \"_blank\",\n                  children: [\"resource uri.\", ' ']\n                }), \"Supports the use of multiple template variables (ex: /subscriptions/$subId/resourceGroups/$rg)\"]\n              }),\n              placement: \"right\",\n              interactive: true,\n              children: /*#__PURE__*/_jsx(Icon, {\n                name: \"info-circle\"\n              })\n            })]\n          }))\n        }), /*#__PURE__*/_jsx(Input, {\n          id: `input-${internalSelectedURI}`,\n          value: internalSelectedURI,\n          onChange: event => setInternalSelectedURI(event.currentTarget.value),\n          placeholder: \"ex: /subscriptions/$subId\"\n        }), _Space3 || (_Space3 = /*#__PURE__*/_jsx(Space, {\n          v: 2\n        }))]\n      }), _Space4 || (_Space4 = /*#__PURE__*/_jsx(Space, {\n        v: 2\n      })), /*#__PURE__*/_jsx(Button, {\n        disabled: !!errorMessage,\n        onClick: handleApply,\n        children: \"Apply\"\n      }), _Space5 || (_Space5 = /*#__PURE__*/_jsx(Space, {\n        layout: \"inline\",\n        h: 1\n      })), /*#__PURE__*/_jsx(Button, {\n        onClick: onCancel,\n        variant: \"secondary\",\n        children: \"Cancel\"\n      })]\n    }), errorMessage && /*#__PURE__*/_jsxs(_Fragment, {\n      children: [_Space6 || (_Space6 = /*#__PURE__*/_jsx(Space, {\n        v: 2\n      })), /*#__PURE__*/_jsx(Alert, {\n        severity: \"error\",\n        title: \"An error occurred while requesting resources from Azure Monitor\",\n        children: errorMessage\n      })]\n    })]\n  });\n};\n\nexport default ResourcePicker;","map":{"version":3,"names":["cx","React","useCallback","useEffect","useState","useEffectOnce","Alert","Button","Icon","Input","LoadingPlaceholder","Tooltip","useStyles2","Collapse","Label","messageFromError","Space","NestedRow","Search","getStyles","findRow","ResourcePicker","resourcePickerData","resourceURI","onApply","onCancel","selectableEntryTypes","queryType","styles","isLoading","setIsLoading","rows","setRows","selectedRows","setSelectedRows","internalSelectedURI","setInternalSelectedURI","errorMessage","setErrorMessage","undefined","isAdvancedOpen","setIsAdvancedOpen","includes","shouldShowLimitFlag","setShouldShowLimitFlag","loadInitialData","resources","fetchInitialRows","error","found","children","requestNestedRows","parentRow","length","nestedRows","fetchAndAppendNestedRow","handleSelectionChanged","row","isSelected","uri","handleApply","handleSearch","searchWord","searchResults","search","resultLimit","err","table","header","cell","tableScroller","map","selectionFooter","event","currentTarget","value"],"sources":["/home/soula/grafana/public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/ResourcePicker.tsx"],"sourcesContent":["import { cx } from '@emotion/css';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useEffectOnce } from 'react-use';\n\nimport { Alert, Button, Icon, Input, LoadingPlaceholder, Tooltip, useStyles2, Collapse, Label } from '@grafana/ui';\n\nimport ResourcePickerData, { ResourcePickerQueryType } from '../../resourcePicker/resourcePickerData';\nimport messageFromError from '../../utils/messageFromError';\nimport { Space } from '../Space';\n\nimport NestedRow from './NestedRow';\nimport Search from './Search';\nimport getStyles from './styles';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\nimport { findRow } from './utils';\n\ninterface ResourcePickerProps {\n  resourcePickerData: ResourcePickerData;\n  resourceURI: string | undefined;\n  selectableEntryTypes: ResourceRowType[];\n  queryType: ResourcePickerQueryType;\n\n  onApply: (resourceURI: string | undefined) => void;\n  onCancel: () => void;\n}\n\nconst ResourcePicker = ({\n  resourcePickerData,\n  resourceURI,\n  onApply,\n  onCancel,\n  selectableEntryTypes,\n  queryType,\n}: ResourcePickerProps) => {\n  const styles = useStyles2(getStyles);\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [rows, setRows] = useState<ResourceRowGroup>([]);\n  const [selectedRows, setSelectedRows] = useState<ResourceRowGroup>([]);\n  const [internalSelectedURI, setInternalSelectedURI] = useState<string | undefined>(resourceURI);\n  const [errorMessage, setErrorMessage] = useState<string | undefined>(undefined);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(resourceURI?.includes('$'));\n  const [shouldShowLimitFlag, setShouldShowLimitFlag] = useState(false);\n\n  // Sync the resourceURI prop to internal state\n  useEffect(() => {\n    setInternalSelectedURI(resourceURI);\n  }, [resourceURI]);\n\n  const loadInitialData = useCallback(async () => {\n    if (!isLoading) {\n      try {\n        setIsLoading(true);\n        const resources = await resourcePickerData.fetchInitialRows(queryType, internalSelectedURI || '');\n        setRows(resources);\n      } catch (error) {\n        setErrorMessage(messageFromError(error));\n      }\n      setIsLoading(false);\n    }\n  }, [internalSelectedURI, isLoading, resourcePickerData, queryType]);\n\n  useEffectOnce(() => {\n    loadInitialData();\n  });\n\n  // set selected row data whenever row or selection changes\n  useEffect(() => {\n    if (!internalSelectedURI) {\n      setSelectedRows([]);\n    }\n\n    const found = internalSelectedURI && findRow(rows, internalSelectedURI);\n    if (found) {\n      return setSelectedRows([\n        {\n          ...found,\n          children: undefined,\n        },\n      ]);\n    }\n  }, [internalSelectedURI, rows]);\n\n  // Request resources for an expanded resource group\n  const requestNestedRows = useCallback(\n    async (parentRow: ResourceRow) => {\n      // clear error message (also when loading cached resources)\n      setErrorMessage(undefined);\n\n      // If we already have children, we don't need to re-fetch them.\n      if (parentRow.children?.length) {\n        return;\n      }\n\n      try {\n        const nestedRows = await resourcePickerData.fetchAndAppendNestedRow(rows, parentRow, queryType);\n        setRows(nestedRows);\n      } catch (error) {\n        setErrorMessage(messageFromError(error));\n        throw error;\n      }\n    },\n    [resourcePickerData, rows, queryType]\n  );\n\n  const handleSelectionChanged = useCallback((row: ResourceRow, isSelected: boolean) => {\n    isSelected ? setInternalSelectedURI(row.uri) : setInternalSelectedURI(undefined);\n  }, []);\n\n  const handleApply = useCallback(() => {\n    onApply(internalSelectedURI);\n  }, [internalSelectedURI, onApply]);\n\n  const handleSearch = useCallback(\n    async (searchWord: string) => {\n      // clear errors and warnings\n      setErrorMessage(undefined);\n      setShouldShowLimitFlag(false);\n\n      if (!searchWord) {\n        loadInitialData();\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        const searchResults = await resourcePickerData.search(searchWord, queryType);\n        setRows(searchResults);\n        if (searchResults.length >= resourcePickerData.resultLimit) {\n          setShouldShowLimitFlag(true);\n        }\n      } catch (err) {\n        setErrorMessage(messageFromError(err));\n      }\n      setIsLoading(false);\n    },\n    [loadInitialData, resourcePickerData, queryType]\n  );\n\n  return (\n    <div>\n      <Search searchFn={handleSearch} />\n      {shouldShowLimitFlag ? (\n        <p className={styles.resultLimit}>Showing first {resourcePickerData.resultLimit} results</p>\n      ) : (\n        <Space v={2} />\n      )}\n\n      <table className={styles.table}>\n        <thead>\n          <tr className={cx(styles.row, styles.header)}>\n            <td className={styles.cell}>Scope</td>\n            <td className={styles.cell}>Type</td>\n            <td className={styles.cell}>Location</td>\n          </tr>\n        </thead>\n      </table>\n\n      <div className={styles.tableScroller}>\n        <table className={styles.table}>\n          <tbody>\n            {isLoading && (\n              <tr className={cx(styles.row)}>\n                <td className={styles.cell}>\n                  <LoadingPlaceholder text={'Loading...'} />\n                </td>\n              </tr>\n            )}\n            {!isLoading && rows.length === 0 && (\n              <tr className={cx(styles.row)}>\n                <td className={styles.cell} aria-live=\"polite\">\n                  No resources found\n                </td>\n              </tr>\n            )}\n            {!isLoading &&\n              rows.map((row) => (\n                <NestedRow\n                  key={row.uri}\n                  row={row}\n                  selectedRows={selectedRows}\n                  level={0}\n                  requestNestedRows={requestNestedRows}\n                  onRowSelectedChange={handleSelectionChanged}\n                  selectableEntryTypes={selectableEntryTypes}\n                  scrollIntoView={true}\n                />\n              ))}\n          </tbody>\n        </table>\n      </div>\n\n      <div className={styles.selectionFooter}>\n        {selectedRows.length > 0 && (\n          <>\n            <h5>Selection</h5>\n\n            <div className={styles.tableScroller}>\n              <table className={styles.table}>\n                <tbody>\n                  {selectedRows.map((row) => (\n                    <NestedRow\n                      key={row.uri}\n                      row={row}\n                      selectedRows={selectedRows}\n                      level={0}\n                      requestNestedRows={requestNestedRows}\n                      onRowSelectedChange={handleSelectionChanged}\n                      selectableEntryTypes={selectableEntryTypes}\n                    />\n                  ))}\n                </tbody>\n              </table>\n            </div>\n            <Space v={2} />\n          </>\n        )}\n\n        <Collapse\n          collapsible\n          label=\"Advanced\"\n          isOpen={isAdvancedOpen}\n          onToggle={() => setIsAdvancedOpen(!isAdvancedOpen)}\n        >\n          <Label htmlFor={`input-${internalSelectedURI}`}>\n            <h6>\n              Resource URI{' '}\n              <Tooltip\n                content={\n                  <>\n                    Manually edit the{' '}\n                    <a\n                      href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/logs/log-standard-columns#_resourceid\"\n                      rel=\"noopener noreferrer\"\n                      target=\"_blank\"\n                    >\n                      resource uri.{' '}\n                    </a>\n                    Supports the use of multiple template variables (ex: /subscriptions/$subId/resourceGroups/$rg)\n                  </>\n                }\n                placement=\"right\"\n                interactive={true}\n              >\n                <Icon name=\"info-circle\" />\n              </Tooltip>\n            </h6>\n          </Label>\n          <Input\n            id={`input-${internalSelectedURI}`}\n            value={internalSelectedURI}\n            onChange={(event) => setInternalSelectedURI(event.currentTarget.value)}\n            placeholder=\"ex: /subscriptions/$subId\"\n          />\n          <Space v={2} />\n        </Collapse>\n        <Space v={2} />\n\n        <Button disabled={!!errorMessage} onClick={handleApply}>\n          Apply\n        </Button>\n\n        <Space layout=\"inline\" h={1} />\n\n        <Button onClick={onCancel} variant=\"secondary\">\n          Cancel\n        </Button>\n      </div>\n\n      {errorMessage && (\n        <>\n          <Space v={2} />\n          <Alert severity=\"error\" title=\"An error occurred while requesting resources from Azure Monitor\">\n            {errorMessage}\n          </Alert>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default ResourcePicker;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}