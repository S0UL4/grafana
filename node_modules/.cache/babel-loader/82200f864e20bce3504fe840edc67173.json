{"ast":null,"code":"import { css } from '@emotion/css';\nimport { localPoint } from '@visx/event';\nimport { RadialGradient } from '@visx/gradient';\nimport { Group } from '@visx/group';\nimport Pie from '@visx/shape/lib/shapes/Pie';\nimport { useTooltip, useTooltipInPortal } from '@visx/tooltip';\nimport React, { useCallback } from 'react';\nimport tinycolor from 'tinycolor2';\nimport { FALLBACK_COLOR, formattedValueToString, DataHoverClearEvent, DataHoverEvent } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { useTheme2, useStyles2, DataLinksContextMenu, SeriesTable, usePanelContext } from '@grafana/ui';\nimport { getTooltipContainerStyles } from '@grafana/ui/src/themes/mixins';\nimport { useComponentInstanceId } from '@grafana/ui/src/utils/useComponetInstanceId';\nimport { PieChartType, PieChartLabels } from './types';\nimport { filterDisplayItems, sumDisplayItemsReducer } from './utils';\n/**\n * @beta\n */\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const PieChart = ({\n  fieldDisplayValues,\n  pieType,\n  width,\n  height,\n  highlightedTitle,\n  displayLabels = [],\n  tooltipOptions\n}) => {\n  const theme = useTheme2();\n  const componentInstanceId = useComponentInstanceId('PieChart');\n  const styles = useStyles2(getStyles);\n  const tooltip = useTooltip();\n  const {\n    containerRef,\n    TooltipInPortal\n  } = useTooltipInPortal({\n    detectBounds: true,\n    scroll: true\n  });\n  const filteredFieldDisplayValues = fieldDisplayValues.filter(filterDisplayItems);\n\n  const getValue = d => d.display.numeric;\n\n  const getGradientId = color => `${componentInstanceId}-${tinycolor(color).toHex()}`;\n\n  const getGradientColor = color => {\n    return `url(#${getGradientId(color)})`;\n  };\n\n  const showLabel = displayLabels.length > 0;\n  const showTooltip = tooltipOptions.mode !== 'none' && tooltip.tooltipOpen;\n  const total = filteredFieldDisplayValues.reduce(sumDisplayItemsReducer, 0);\n  const layout = getPieLayout(width, height, pieType);\n  const colors = [...new Set(filteredFieldDisplayValues.map(fieldDisplayValue => {\n    var _fieldDisplayValue$di;\n\n    return (_fieldDisplayValue$di = fieldDisplayValue.display.color) !== null && _fieldDisplayValue$di !== void 0 ? _fieldDisplayValue$di : FALLBACK_COLOR;\n  }))];\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsx(\"svg\", {\n      width: layout.size,\n      height: layout.size,\n      ref: containerRef,\n      children: /*#__PURE__*/_jsxs(Group, {\n        top: layout.position,\n        left: layout.position,\n        children: [colors.map(color => {\n          return /*#__PURE__*/_jsx(RadialGradient, {\n            id: getGradientId(color),\n            from: getGradientColorFrom(color, theme),\n            to: getGradientColorTo(color, theme),\n            fromOffset: layout.gradientFromOffset,\n            toOffset: \"1\",\n            gradientUnits: \"userSpaceOnUse\",\n            cx: 0,\n            cy: 0,\n            radius: layout.outerRadius\n          }, color);\n        }), /*#__PURE__*/_jsx(Pie, {\n          data: filteredFieldDisplayValues,\n          pieValue: getValue,\n          outerRadius: layout.outerRadius,\n          innerRadius: layout.innerRadius,\n          cornerRadius: 3,\n          padAngle: 0.005,\n          children: pie => /*#__PURE__*/_jsxs(_Fragment, {\n            children: [pie.arcs.map(arc => {\n              var _arc$data$display$col;\n\n              const color = (_arc$data$display$col = arc.data.display.color) !== null && _arc$data$display$col !== void 0 ? _arc$data$display$col : FALLBACK_COLOR;\n              const highlightState = getHighlightState(highlightedTitle, arc);\n\n              if (arc.data.hasLinks && arc.data.getLinks) {\n                return /*#__PURE__*/_jsx(DataLinksContextMenu, {\n                  config: arc.data.field,\n                  links: arc.data.getLinks,\n                  children: api => /*#__PURE__*/_jsx(PieSlice, {\n                    tooltip: tooltip,\n                    highlightState: highlightState,\n                    arc: arc,\n                    pie: pie,\n                    fill: getGradientColor(color),\n                    openMenu: api.openMenu,\n                    tooltipOptions: tooltipOptions\n                  })\n                }, arc.index);\n              } else {\n                return /*#__PURE__*/_jsx(PieSlice, {\n                  highlightState: highlightState,\n                  tooltip: tooltip,\n                  arc: arc,\n                  pie: pie,\n                  fill: getGradientColor(color),\n                  tooltipOptions: tooltipOptions\n                }, arc.index);\n              }\n            }), showLabel && pie.arcs.map(arc => {\n              const highlightState = getHighlightState(highlightedTitle, arc);\n              return /*#__PURE__*/_jsx(PieLabel, {\n                arc: arc,\n                highlightState: highlightState,\n                outerRadius: layout.outerRadius,\n                innerRadius: layout.innerRadius,\n                displayLabels: displayLabels,\n                total: total,\n                color: theme.colors.text.primary\n              }, arc.index);\n            })]\n          })\n        })]\n      })\n    }), showTooltip ? /*#__PURE__*/_jsx(TooltipInPortal, {\n      top: tooltip.tooltipTop,\n      className: styles.tooltipPortal,\n      left: tooltip.tooltipLeft,\n      unstyled: true,\n      applyPositionStyle: true,\n      children: /*#__PURE__*/_jsx(SeriesTable, {\n        series: tooltip.tooltipData\n      })\n    }, Math.random()) : null]\n  });\n};\n\nfunction PieSlice({\n  arc,\n  pie,\n  highlightState,\n  openMenu,\n  fill,\n  tooltip,\n  tooltipOptions\n}) {\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const {\n    eventBus\n  } = usePanelContext();\n  const onMouseOut = useCallback(event => {\n    eventBus === null || eventBus === void 0 ? void 0 : eventBus.publish({\n      type: DataHoverClearEvent.type,\n      payload: {\n        raw: event,\n        x: 0,\n        y: 0,\n        dataId: arc.data.display.title\n      }\n    });\n    tooltip.hideTooltip();\n  }, [eventBus, arc, tooltip]);\n  const onMouseMoveOverArc = useCallback(event => {\n    eventBus === null || eventBus === void 0 ? void 0 : eventBus.publish({\n      type: DataHoverEvent.type,\n      payload: {\n        raw: event,\n        x: 0,\n        y: 0,\n        dataId: arc.data.display.title\n      }\n    });\n    const coords = localPoint(event.target.ownerSVGElement, event);\n    tooltip.showTooltip({\n      tooltipLeft: coords.x,\n      tooltipTop: coords.y,\n      tooltipData: getTooltipData(pie, arc, tooltipOptions)\n    });\n  }, [eventBus, arc, tooltip, pie, tooltipOptions]);\n  const pieStyle = getSvgStyle(highlightState, styles);\n  return /*#__PURE__*/_jsx(\"g\", {\n    className: pieStyle,\n    onMouseMove: tooltipOptions.mode !== 'none' ? onMouseMoveOverArc : undefined,\n    onMouseOut: onMouseOut,\n    onClick: openMenu,\n    \"aria-label\": selectors.components.Panels.Visualization.PieChart.svgSlice,\n    children: /*#__PURE__*/_jsx(\"path\", {\n      d: pie.path(Object.assign({}, arc)),\n      fill: fill,\n      stroke: theme.colors.background.primary,\n      strokeWidth: 1\n    })\n  }, arc.data.display.title);\n}\n\nfunction PieLabel({\n  arc,\n  outerRadius,\n  innerRadius,\n  displayLabels,\n  total,\n  color,\n  highlightState\n}) {\n  var _arc$data$field$decim;\n\n  const styles = useStyles2(getStyles);\n  const labelRadius = innerRadius === 0 ? outerRadius / 6 : innerRadius;\n  const [labelX, labelY] = getLabelPos(arc, outerRadius, labelRadius);\n  const hasSpaceForLabel = arc.endAngle - arc.startAngle >= 0.3;\n\n  if (!hasSpaceForLabel) {\n    return null;\n  }\n\n  let labelFontSize = displayLabels.includes(PieChartLabels.Name) ? Math.min(Math.max(outerRadius / 150 * 14, 12), 30) : Math.min(Math.max(outerRadius / 100 * 14, 12), 36);\n  return /*#__PURE__*/_jsx(\"g\", {\n    className: getSvgStyle(highlightState, styles),\n    children: /*#__PURE__*/_jsxs(\"text\", {\n      fill: color,\n      x: labelX,\n      y: labelY,\n      dy: \".33em\",\n      fontSize: labelFontSize,\n      fontWeight: 500,\n      textAnchor: \"middle\",\n      pointerEvents: \"none\",\n      children: [displayLabels.includes(PieChartLabels.Name) && /*#__PURE__*/_jsx(\"tspan\", {\n        x: labelX,\n        dy: \"1.2em\",\n        children: arc.data.display.title\n      }), displayLabels.includes(PieChartLabels.Value) && /*#__PURE__*/_jsx(\"tspan\", {\n        x: labelX,\n        dy: \"1.2em\",\n        children: formattedValueToString(arc.data.display)\n      }), displayLabels.includes(PieChartLabels.Percent) && /*#__PURE__*/_jsx(\"tspan\", {\n        x: labelX,\n        dy: \"1.2em\",\n        children: (arc.data.display.numeric / total * 100).toFixed((_arc$data$field$decim = arc.data.field.decimals) !== null && _arc$data$field$decim !== void 0 ? _arc$data$field$decim : 0) + '%'\n      })]\n    })\n  });\n}\n\nfunction getTooltipData(pie, arc, tooltipOptions) {\n  var _arc$data$display$col2;\n\n  if (tooltipOptions.mode === 'multi') {\n    return pie.arcs.map(pieArc => {\n      var _pieArc$data$display$;\n\n      return {\n        color: (_pieArc$data$display$ = pieArc.data.display.color) !== null && _pieArc$data$display$ !== void 0 ? _pieArc$data$display$ : FALLBACK_COLOR,\n        label: pieArc.data.display.title,\n        value: formattedValueToString(pieArc.data.display),\n        isActive: pieArc.index === arc.index\n      };\n    });\n  }\n\n  return [{\n    color: (_arc$data$display$col2 = arc.data.display.color) !== null && _arc$data$display$col2 !== void 0 ? _arc$data$display$col2 : FALLBACK_COLOR,\n    label: arc.data.display.title,\n    value: formattedValueToString(arc.data.display)\n  }];\n}\n\nfunction getLabelPos(arc, outerRadius, innerRadius) {\n  const r = (outerRadius + innerRadius) / 2;\n  const a = (+arc.startAngle + +arc.endAngle) / 2 - Math.PI / 2;\n  return [Math.cos(a) * r, Math.sin(a) * r];\n}\n\nfunction getGradientColorFrom(color, theme) {\n  return tinycolor(color).darken(20 * (theme.isDark ? 1 : -0.7)).spin(4).toRgbString();\n}\n\nfunction getGradientColorTo(color, theme) {\n  return tinycolor(color).darken(10 * (theme.isDark ? 1 : -0.7)).spin(-4).toRgbString();\n}\n\nfunction getPieLayout(height, width, pieType, margin = 16) {\n  const size = Math.min(width, height);\n  const outerRadius = (size - margin * 2) / 2;\n  const donutThickness = pieType === PieChartType.Pie ? outerRadius : Math.max(outerRadius / 3, 20);\n  const innerRadius = outerRadius - donutThickness;\n  const centerOffset = (size - margin * 2) / 2; // for non donut pie charts shift gradient out a bit\n\n  const gradientFromOffset = 1 - (outerRadius - innerRadius) / outerRadius;\n  return {\n    position: centerOffset + margin,\n    size: size,\n    outerRadius: outerRadius,\n    innerRadius: innerRadius,\n    gradientFromOffset: gradientFromOffset\n  };\n}\n\nvar HighLightState;\n\n(function (HighLightState) {\n  HighLightState[HighLightState[\"Highlighted\"] = 0] = \"Highlighted\";\n  HighLightState[HighLightState[\"Deemphasized\"] = 1] = \"Deemphasized\";\n  HighLightState[HighLightState[\"Normal\"] = 2] = \"Normal\";\n})(HighLightState || (HighLightState = {}));\n\nfunction getHighlightState(highlightedTitle, arc) {\n  if (highlightedTitle) {\n    if (highlightedTitle === arc.data.display.title) {\n      return HighLightState.Highlighted;\n    } else {\n      return HighLightState.Deemphasized;\n    }\n  }\n\n  return HighLightState.Normal;\n}\n\nfunction getSvgStyle(highlightState, styles) {\n  switch (highlightState) {\n    case HighLightState.Highlighted:\n      return styles.svgArg.highlighted;\n\n    case HighLightState.Deemphasized:\n      return styles.svgArg.deemphasized;\n\n    case HighLightState.Normal:\n    default:\n      return styles.svgArg.normal;\n  }\n}\n\nconst getStyles = theme => {\n  return {\n    container: css`\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `,\n    svgArg: {\n      normal: css`\n        transition: all 200ms ease-in-out;\n      `,\n      highlighted: css`\n        transition: all 200ms ease-in-out;\n        transform: scale3d(1.03, 1.03, 1);\n      `,\n      deemphasized: css`\n        transition: all 200ms ease-in-out;\n        fill-opacity: 0.5;\n      `\n    },\n    tooltipPortal: css`\n      ${getTooltipContainerStyles(theme)}\n    `\n  };\n};","map":{"version":3,"names":["css","localPoint","RadialGradient","Group","Pie","useTooltip","useTooltipInPortal","React","useCallback","tinycolor","FALLBACK_COLOR","formattedValueToString","DataHoverClearEvent","DataHoverEvent","selectors","useTheme2","useStyles2","DataLinksContextMenu","SeriesTable","usePanelContext","getTooltipContainerStyles","useComponentInstanceId","PieChartType","PieChartLabels","filterDisplayItems","sumDisplayItemsReducer","PieChart","fieldDisplayValues","pieType","width","height","highlightedTitle","displayLabels","tooltipOptions","theme","componentInstanceId","styles","getStyles","tooltip","containerRef","TooltipInPortal","detectBounds","scroll","filteredFieldDisplayValues","filter","getValue","d","display","numeric","getGradientId","color","toHex","getGradientColor","showLabel","length","showTooltip","mode","tooltipOpen","total","reduce","layout","getPieLayout","colors","Set","map","fieldDisplayValue","container","size","position","getGradientColorFrom","getGradientColorTo","gradientFromOffset","outerRadius","innerRadius","pie","arcs","arc","data","highlightState","getHighlightState","hasLinks","getLinks","field","api","openMenu","index","text","primary","tooltipTop","tooltipPortal","tooltipLeft","tooltipData","Math","random","PieSlice","fill","eventBus","onMouseOut","event","publish","type","payload","raw","x","y","dataId","title","hideTooltip","onMouseMoveOverArc","coords","target","ownerSVGElement","getTooltipData","pieStyle","getSvgStyle","undefined","components","Panels","Visualization","svgSlice","path","background","PieLabel","labelRadius","labelX","labelY","getLabelPos","hasSpaceForLabel","endAngle","startAngle","labelFontSize","includes","Name","min","max","Value","Percent","toFixed","decimals","pieArc","label","value","isActive","r","a","PI","cos","sin","darken","isDark","spin","toRgbString","margin","donutThickness","centerOffset","HighLightState","Highlighted","Deemphasized","Normal","svgArg","highlighted","deemphasized","normal"],"sources":["/home/soula/grafana/public/app/plugins/panel/piechart/PieChart.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport { localPoint } from '@visx/event';\nimport { RadialGradient } from '@visx/gradient';\nimport { Group } from '@visx/group';\nimport Pie, { PieArcDatum, ProvidedProps } from '@visx/shape/lib/shapes/Pie';\nimport { useTooltip, useTooltipInPortal } from '@visx/tooltip';\nimport { UseTooltipParams } from '@visx/tooltip/lib/hooks/useTooltip';\nimport React, { FC, useCallback } from 'react';\nimport tinycolor from 'tinycolor2';\n\nimport {\n  FieldDisplay,\n  FALLBACK_COLOR,\n  formattedValueToString,\n  GrafanaTheme2,\n  DataHoverClearEvent,\n  DataHoverEvent,\n} from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { VizTooltipOptions } from '@grafana/schema';\nimport {\n  useTheme2,\n  useStyles2,\n  SeriesTableRowProps,\n  DataLinksContextMenu,\n  SeriesTable,\n  usePanelContext,\n} from '@grafana/ui';\nimport { getTooltipContainerStyles } from '@grafana/ui/src/themes/mixins';\nimport { useComponentInstanceId } from '@grafana/ui/src/utils/useComponetInstanceId';\n\nimport { PieChartType, PieChartLabels } from './types';\nimport { filterDisplayItems, sumDisplayItemsReducer } from './utils';\n\n/**\n * @beta\n */\ninterface PieChartProps {\n  height: number;\n  width: number;\n  fieldDisplayValues: FieldDisplay[];\n  pieType: PieChartType;\n  highlightedTitle?: string;\n  displayLabels?: PieChartLabels[];\n  useGradients?: boolean; // not used?\n  tooltipOptions: VizTooltipOptions;\n}\n\nexport const PieChart: FC<PieChartProps> = ({\n  fieldDisplayValues,\n  pieType,\n  width,\n  height,\n  highlightedTitle,\n  displayLabels = [],\n  tooltipOptions,\n}) => {\n  const theme = useTheme2();\n  const componentInstanceId = useComponentInstanceId('PieChart');\n  const styles = useStyles2(getStyles);\n  const tooltip = useTooltip<SeriesTableRowProps[]>();\n  const { containerRef, TooltipInPortal } = useTooltipInPortal({\n    detectBounds: true,\n    scroll: true,\n  });\n\n  const filteredFieldDisplayValues = fieldDisplayValues.filter(filterDisplayItems);\n\n  const getValue = (d: FieldDisplay) => d.display.numeric;\n  const getGradientId = (color: string) => `${componentInstanceId}-${tinycolor(color).toHex()}`;\n  const getGradientColor = (color: string) => {\n    return `url(#${getGradientId(color)})`;\n  };\n\n  const showLabel = displayLabels.length > 0;\n  const showTooltip = tooltipOptions.mode !== 'none' && tooltip.tooltipOpen;\n  const total = filteredFieldDisplayValues.reduce(sumDisplayItemsReducer, 0);\n  const layout = getPieLayout(width, height, pieType);\n  const colors = [\n    ...new Set(\n      filteredFieldDisplayValues.map((fieldDisplayValue) => fieldDisplayValue.display.color ?? FALLBACK_COLOR)\n    ),\n  ];\n\n  return (\n    <div className={styles.container}>\n      <svg width={layout.size} height={layout.size} ref={containerRef}>\n        <Group top={layout.position} left={layout.position}>\n          {colors.map((color) => {\n            return (\n              <RadialGradient\n                key={color}\n                id={getGradientId(color)}\n                from={getGradientColorFrom(color, theme)}\n                to={getGradientColorTo(color, theme)}\n                fromOffset={layout.gradientFromOffset}\n                toOffset=\"1\"\n                gradientUnits=\"userSpaceOnUse\"\n                cx={0}\n                cy={0}\n                radius={layout.outerRadius}\n              />\n            );\n          })}\n          <Pie\n            data={filteredFieldDisplayValues}\n            pieValue={getValue}\n            outerRadius={layout.outerRadius}\n            innerRadius={layout.innerRadius}\n            cornerRadius={3}\n            padAngle={0.005}\n          >\n            {(pie) => (\n              <>\n                {pie.arcs.map((arc) => {\n                  const color = arc.data.display.color ?? FALLBACK_COLOR;\n                  const highlightState = getHighlightState(highlightedTitle, arc);\n\n                  if (arc.data.hasLinks && arc.data.getLinks) {\n                    return (\n                      <DataLinksContextMenu config={arc.data.field} key={arc.index} links={arc.data.getLinks}>\n                        {(api) => (\n                          <PieSlice\n                            tooltip={tooltip}\n                            highlightState={highlightState}\n                            arc={arc}\n                            pie={pie}\n                            fill={getGradientColor(color)}\n                            openMenu={api.openMenu}\n                            tooltipOptions={tooltipOptions}\n                          />\n                        )}\n                      </DataLinksContextMenu>\n                    );\n                  } else {\n                    return (\n                      <PieSlice\n                        key={arc.index}\n                        highlightState={highlightState}\n                        tooltip={tooltip}\n                        arc={arc}\n                        pie={pie}\n                        fill={getGradientColor(color)}\n                        tooltipOptions={tooltipOptions}\n                      />\n                    );\n                  }\n                })}\n                {showLabel &&\n                  pie.arcs.map((arc) => {\n                    const highlightState = getHighlightState(highlightedTitle, arc);\n                    return (\n                      <PieLabel\n                        arc={arc}\n                        key={arc.index}\n                        highlightState={highlightState}\n                        outerRadius={layout.outerRadius}\n                        innerRadius={layout.innerRadius}\n                        displayLabels={displayLabels}\n                        total={total}\n                        color={theme.colors.text.primary}\n                      />\n                    );\n                  })}\n              </>\n            )}\n          </Pie>\n        </Group>\n      </svg>\n      {showTooltip ? (\n        <TooltipInPortal\n          key={Math.random()}\n          top={tooltip.tooltipTop}\n          className={styles.tooltipPortal}\n          left={tooltip.tooltipLeft}\n          unstyled={true}\n          applyPositionStyle={true}\n        >\n          <SeriesTable series={tooltip.tooltipData!} />\n        </TooltipInPortal>\n      ) : null}\n    </div>\n  );\n};\n\ninterface SliceProps {\n  arc: PieArcDatum<FieldDisplay>;\n  pie: ProvidedProps<FieldDisplay>;\n  highlightState: HighLightState;\n  fill: string;\n  tooltip: UseTooltipParams<SeriesTableRowProps[]>;\n  tooltipOptions: VizTooltipOptions;\n  openMenu?: (event: React.MouseEvent<SVGElement>) => void;\n}\n\nfunction PieSlice({ arc, pie, highlightState, openMenu, fill, tooltip, tooltipOptions }: SliceProps) {\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const { eventBus } = usePanelContext();\n\n  const onMouseOut = useCallback(\n    (event: any) => {\n      eventBus?.publish({\n        type: DataHoverClearEvent.type,\n        payload: {\n          raw: event,\n          x: 0,\n          y: 0,\n          dataId: arc.data.display.title,\n        },\n      });\n      tooltip.hideTooltip();\n    },\n    [eventBus, arc, tooltip]\n  );\n\n  const onMouseMoveOverArc = useCallback(\n    (event: any) => {\n      eventBus?.publish({\n        type: DataHoverEvent.type,\n        payload: {\n          raw: event,\n          x: 0,\n          y: 0,\n          dataId: arc.data.display.title,\n        },\n      });\n\n      const coords = localPoint(event.target.ownerSVGElement, event);\n      tooltip.showTooltip({\n        tooltipLeft: coords!.x,\n        tooltipTop: coords!.y,\n        tooltipData: getTooltipData(pie, arc, tooltipOptions),\n      });\n    },\n    [eventBus, arc, tooltip, pie, tooltipOptions]\n  );\n\n  const pieStyle = getSvgStyle(highlightState, styles);\n\n  return (\n    <g\n      key={arc.data.display.title}\n      className={pieStyle}\n      onMouseMove={tooltipOptions.mode !== 'none' ? onMouseMoveOverArc : undefined}\n      onMouseOut={onMouseOut}\n      onClick={openMenu}\n      aria-label={selectors.components.Panels.Visualization.PieChart.svgSlice}\n    >\n      <path d={pie.path({ ...arc })!} fill={fill} stroke={theme.colors.background.primary} strokeWidth={1} />\n    </g>\n  );\n}\n\ninterface LabelProps {\n  arc: PieArcDatum<FieldDisplay>;\n  outerRadius: number;\n  innerRadius: number;\n  displayLabels: PieChartLabels[];\n  highlightState: HighLightState;\n  total: number;\n  color: string;\n}\n\nfunction PieLabel({ arc, outerRadius, innerRadius, displayLabels, total, color, highlightState }: LabelProps) {\n  const styles = useStyles2(getStyles);\n  const labelRadius = innerRadius === 0 ? outerRadius / 6 : innerRadius;\n  const [labelX, labelY] = getLabelPos(arc, outerRadius, labelRadius);\n  const hasSpaceForLabel = arc.endAngle - arc.startAngle >= 0.3;\n\n  if (!hasSpaceForLabel) {\n    return null;\n  }\n\n  let labelFontSize = displayLabels.includes(PieChartLabels.Name)\n    ? Math.min(Math.max((outerRadius / 150) * 14, 12), 30)\n    : Math.min(Math.max((outerRadius / 100) * 14, 12), 36);\n\n  return (\n    <g className={getSvgStyle(highlightState, styles)}>\n      <text\n        fill={color}\n        x={labelX}\n        y={labelY}\n        dy=\".33em\"\n        fontSize={labelFontSize}\n        fontWeight={500}\n        textAnchor=\"middle\"\n        pointerEvents=\"none\"\n      >\n        {displayLabels.includes(PieChartLabels.Name) && (\n          <tspan x={labelX} dy=\"1.2em\">\n            {arc.data.display.title}\n          </tspan>\n        )}\n        {displayLabels.includes(PieChartLabels.Value) && (\n          <tspan x={labelX} dy=\"1.2em\">\n            {formattedValueToString(arc.data.display)}\n          </tspan>\n        )}\n        {displayLabels.includes(PieChartLabels.Percent) && (\n          <tspan x={labelX} dy=\"1.2em\">\n            {((arc.data.display.numeric / total) * 100).toFixed(arc.data.field.decimals ?? 0) + '%'}\n          </tspan>\n        )}\n      </text>\n    </g>\n  );\n}\n\nfunction getTooltipData(\n  pie: ProvidedProps<FieldDisplay>,\n  arc: PieArcDatum<FieldDisplay>,\n  tooltipOptions: VizTooltipOptions\n) {\n  if (tooltipOptions.mode === 'multi') {\n    return pie.arcs.map((pieArc) => {\n      return {\n        color: pieArc.data.display.color ?? FALLBACK_COLOR,\n        label: pieArc.data.display.title,\n        value: formattedValueToString(pieArc.data.display),\n        isActive: pieArc.index === arc.index,\n      };\n    });\n  }\n  return [\n    {\n      color: arc.data.display.color ?? FALLBACK_COLOR,\n      label: arc.data.display.title,\n      value: formattedValueToString(arc.data.display),\n    },\n  ];\n}\n\nfunction getLabelPos(arc: PieArcDatum<FieldDisplay>, outerRadius: number, innerRadius: number) {\n  const r = (outerRadius + innerRadius) / 2;\n  const a = (+arc.startAngle + +arc.endAngle) / 2 - Math.PI / 2;\n  return [Math.cos(a) * r, Math.sin(a) * r];\n}\n\nfunction getGradientColorFrom(color: string, theme: GrafanaTheme2) {\n  return tinycolor(color)\n    .darken(20 * (theme.isDark ? 1 : -0.7))\n    .spin(4)\n    .toRgbString();\n}\n\nfunction getGradientColorTo(color: string, theme: GrafanaTheme2) {\n  return tinycolor(color)\n    .darken(10 * (theme.isDark ? 1 : -0.7))\n    .spin(-4)\n    .toRgbString();\n}\n\ninterface PieLayout {\n  position: number;\n  size: number;\n  outerRadius: number;\n  innerRadius: number;\n  gradientFromOffset: number;\n}\n\nfunction getPieLayout(height: number, width: number, pieType: PieChartType, margin = 16): PieLayout {\n  const size = Math.min(width, height);\n  const outerRadius = (size - margin * 2) / 2;\n  const donutThickness = pieType === PieChartType.Pie ? outerRadius : Math.max(outerRadius / 3, 20);\n  const innerRadius = outerRadius - donutThickness;\n  const centerOffset = (size - margin * 2) / 2;\n  // for non donut pie charts shift gradient out a bit\n  const gradientFromOffset = 1 - (outerRadius - innerRadius) / outerRadius;\n  return {\n    position: centerOffset + margin,\n    size: size,\n    outerRadius: outerRadius,\n    innerRadius: innerRadius,\n    gradientFromOffset: gradientFromOffset,\n  };\n}\n\nenum HighLightState {\n  Highlighted,\n  Deemphasized,\n  Normal,\n}\n\nfunction getHighlightState(highlightedTitle: string | undefined, arc: PieArcDatum<FieldDisplay>) {\n  if (highlightedTitle) {\n    if (highlightedTitle === arc.data.display.title) {\n      return HighLightState.Highlighted;\n    } else {\n      return HighLightState.Deemphasized;\n    }\n  }\n  return HighLightState.Normal;\n}\n\nfunction getSvgStyle(\n  highlightState: HighLightState,\n  styles: {\n    svgArg: { normal: string; highlighted: string; deemphasized: string };\n  }\n) {\n  switch (highlightState) {\n    case HighLightState.Highlighted:\n      return styles.svgArg.highlighted;\n    case HighLightState.Deemphasized:\n      return styles.svgArg.deemphasized;\n    case HighLightState.Normal:\n    default:\n      return styles.svgArg.normal;\n  }\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    container: css`\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `,\n    svgArg: {\n      normal: css`\n        transition: all 200ms ease-in-out;\n      `,\n      highlighted: css`\n        transition: all 200ms ease-in-out;\n        transform: scale3d(1.03, 1.03, 1);\n      `,\n      deemphasized: css`\n        transition: all 200ms ease-in-out;\n        fill-opacity: 0.5;\n      `,\n    },\n    tooltipPortal: css`\n      ${getTooltipContainerStyles(theme)}\n    `,\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}