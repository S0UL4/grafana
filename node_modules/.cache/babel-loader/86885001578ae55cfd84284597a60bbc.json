{"ast":null,"code":"var _h;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { css } from '@emotion/css';\nimport React, { Component } from 'react';\nimport { Button, Form, HorizontalGroup, Select, stylesFactory } from '@grafana/ui';\nimport { TeamPicker } from 'app/core/components/Select/TeamPicker';\nimport { UserPicker } from 'app/core/components/Select/UserPicker';\nimport config from 'app/core/config';\nimport { dashboardPermissionLevels, dashboardAclTargets, AclTarget, PermissionLevel, OrgRole } from 'app/types/acl';\nimport { CloseButton } from '../CloseButton/CloseButton';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nclass AddPermissions extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"onTypeChanged\", item => {\n      const type = item.value;\n\n      switch (type) {\n        case AclTarget.User:\n        case AclTarget.Team:\n          this.setState({\n            type: type,\n            userId: 0,\n            teamId: 0,\n            role: undefined\n          });\n          break;\n\n        case AclTarget.Editor:\n          this.setState({\n            type: type,\n            userId: 0,\n            teamId: 0,\n            role: OrgRole.Editor\n          });\n          break;\n\n        case AclTarget.Viewer:\n          this.setState({\n            type: type,\n            userId: 0,\n            teamId: 0,\n            role: OrgRole.Viewer\n          });\n          break;\n      }\n    });\n\n    _defineProperty(this, \"onUserSelected\", user => {\n      this.setState({\n        userId: user && !Array.isArray(user) ? user.id : 0\n      });\n    });\n\n    _defineProperty(this, \"onTeamSelected\", team => {\n      var _team$value;\n\n      this.setState({\n        teamId: (_team$value = team.value) !== null && _team$value !== void 0 && _team$value.id && !Array.isArray(team.value) ? team.value.id : 0\n      });\n    });\n\n    _defineProperty(this, \"onPermissionChanged\", permission => {\n      this.setState({\n        permission: permission.value\n      });\n    });\n\n    _defineProperty(this, \"onSubmit\", async () => {\n      await this.props.onAddPermission(this.state);\n      this.setState(this.getCleanState());\n    });\n\n    this.state = this.getCleanState();\n  }\n\n  getCleanState() {\n    return {\n      userId: 0,\n      teamId: 0,\n      role: undefined,\n      type: AclTarget.Team,\n      permission: PermissionLevel.View\n    };\n  }\n\n  isValid() {\n    switch (this.state.type) {\n      case AclTarget.Team:\n        return this.state.teamId > 0;\n\n      case AclTarget.User:\n        return this.state.userId > 0;\n    }\n\n    return true;\n  }\n\n  render() {\n    const {\n      onCancel\n    } = this.props;\n    const newItem = this.state;\n    const pickerClassName = 'min-width-20';\n    const isValid = this.isValid();\n    const styles = getStyles(config.theme);\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: \"cta-form\",\n      children: [/*#__PURE__*/_jsx(CloseButton, {\n        onClick: onCancel\n      }), _h || (_h = /*#__PURE__*/_jsx(\"h5\", {\n        children: \"Add Permission For\"\n      })), /*#__PURE__*/_jsx(Form, {\n        maxWidth: \"none\",\n        onSubmit: this.onSubmit,\n        children: () => /*#__PURE__*/_jsxs(HorizontalGroup, {\n          children: [/*#__PURE__*/_jsx(Select, {\n            \"aria-label\": \"Role to add new permission to\",\n            isSearchable: false,\n            value: this.state.type,\n            options: dashboardAclTargets,\n            onChange: this.onTypeChanged\n          }), newItem.type === AclTarget.User ? /*#__PURE__*/_jsx(UserPicker, {\n            onSelected: this.onUserSelected,\n            className: pickerClassName\n          }) : null, newItem.type === AclTarget.Team ? /*#__PURE__*/_jsx(TeamPicker, {\n            onSelected: this.onTeamSelected,\n            className: pickerClassName\n          }) : null, /*#__PURE__*/_jsx(\"span\", {\n            className: styles.label,\n            children: \"Can\"\n          }), /*#__PURE__*/_jsx(Select, {\n            \"aria-label\": \"Permission level\",\n            isSearchable: false,\n            value: this.state.permission,\n            options: dashboardPermissionLevels,\n            onChange: this.onPermissionChanged,\n            width: 25\n          }), /*#__PURE__*/_jsx(Button, {\n            \"data-save-permission\": true,\n            type: \"submit\",\n            disabled: !isValid,\n            children: \"Save\"\n          })]\n        })\n      })]\n    });\n  }\n\n}\n\n_defineProperty(AddPermissions, \"defaultProps\", {\n  showPermissionLevels: true\n});\n\nconst getStyles = stylesFactory(theme => ({\n  label: css`\n    color: ${theme.colors.textBlue};\n    font-weight: bold;\n  `\n}));\nexport default AddPermissions;","map":{"version":3,"names":["css","React","Component","Button","Form","HorizontalGroup","Select","stylesFactory","TeamPicker","UserPicker","config","dashboardPermissionLevels","dashboardAclTargets","AclTarget","PermissionLevel","OrgRole","CloseButton","AddPermissions","constructor","props","item","type","value","User","Team","setState","userId","teamId","role","undefined","Editor","Viewer","user","Array","isArray","id","team","permission","onAddPermission","state","getCleanState","View","isValid","render","onCancel","newItem","pickerClassName","styles","getStyles","theme","onSubmit","onTypeChanged","onUserSelected","onTeamSelected","label","onPermissionChanged","showPermissionLevels","colors","textBlue"],"sources":["/home/soula/grafana/public/app/core/components/PermissionList/AddPermission.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { Component } from 'react';\n\nimport { GrafanaTheme, SelectableValue } from '@grafana/data';\nimport { Button, Form, HorizontalGroup, Select, stylesFactory } from '@grafana/ui';\nimport { TeamPicker } from 'app/core/components/Select/TeamPicker';\nimport { UserPicker } from 'app/core/components/Select/UserPicker';\nimport config from 'app/core/config';\nimport { OrgUser, Team } from 'app/types';\nimport {\n  dashboardPermissionLevels,\n  dashboardAclTargets,\n  AclTarget,\n  PermissionLevel,\n  NewDashboardAclItem,\n  OrgRole,\n} from 'app/types/acl';\n\nimport { CloseButton } from '../CloseButton/CloseButton';\n\nexport interface Props {\n  onAddPermission: (item: NewDashboardAclItem) => void;\n  onCancel: () => void;\n}\n\nclass AddPermissions extends Component<Props, NewDashboardAclItem> {\n  static defaultProps = {\n    showPermissionLevels: true,\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this.state = this.getCleanState();\n  }\n\n  getCleanState() {\n    return {\n      userId: 0,\n      teamId: 0,\n      role: undefined,\n      type: AclTarget.Team,\n      permission: PermissionLevel.View,\n    };\n  }\n\n  onTypeChanged = (item: SelectableValue<AclTarget>) => {\n    const type = item.value;\n\n    switch (type) {\n      case AclTarget.User:\n      case AclTarget.Team:\n        this.setState({ type: type, userId: 0, teamId: 0, role: undefined });\n        break;\n      case AclTarget.Editor:\n        this.setState({ type: type, userId: 0, teamId: 0, role: OrgRole.Editor });\n        break;\n      case AclTarget.Viewer:\n        this.setState({ type: type, userId: 0, teamId: 0, role: OrgRole.Viewer });\n        break;\n    }\n  };\n\n  onUserSelected = (user: SelectableValue<OrgUser['userId']>) => {\n    this.setState({ userId: user && !Array.isArray(user) ? user.id : 0 });\n  };\n\n  onTeamSelected = (team: SelectableValue<Team>) => {\n    this.setState({ teamId: team.value?.id && !Array.isArray(team.value) ? team.value.id : 0 });\n  };\n\n  onPermissionChanged = (permission: SelectableValue<PermissionLevel>) => {\n    this.setState({ permission: permission.value! });\n  };\n\n  onSubmit = async () => {\n    await this.props.onAddPermission(this.state);\n    this.setState(this.getCleanState());\n  };\n\n  isValid() {\n    switch (this.state.type) {\n      case AclTarget.Team:\n        return this.state.teamId > 0;\n      case AclTarget.User:\n        return this.state.userId > 0;\n    }\n    return true;\n  }\n\n  render() {\n    const { onCancel } = this.props;\n    const newItem = this.state;\n    const pickerClassName = 'min-width-20';\n    const isValid = this.isValid();\n    const styles = getStyles(config.theme);\n\n    return (\n      <div className=\"cta-form\">\n        <CloseButton onClick={onCancel} />\n        <h5>Add Permission For</h5>\n        <Form maxWidth=\"none\" onSubmit={this.onSubmit}>\n          {() => (\n            <HorizontalGroup>\n              <Select\n                aria-label=\"Role to add new permission to\"\n                isSearchable={false}\n                value={this.state.type}\n                options={dashboardAclTargets}\n                onChange={this.onTypeChanged}\n              />\n\n              {newItem.type === AclTarget.User ? (\n                <UserPicker onSelected={this.onUserSelected} className={pickerClassName} />\n              ) : null}\n\n              {newItem.type === AclTarget.Team ? (\n                <TeamPicker onSelected={this.onTeamSelected} className={pickerClassName} />\n              ) : null}\n\n              <span className={styles.label}>Can</span>\n\n              <Select\n                aria-label=\"Permission level\"\n                isSearchable={false}\n                value={this.state.permission}\n                options={dashboardPermissionLevels}\n                onChange={this.onPermissionChanged}\n                width={25}\n              />\n              <Button data-save-permission type=\"submit\" disabled={!isValid}>\n                Save\n              </Button>\n            </HorizontalGroup>\n          )}\n        </Form>\n      </div>\n    );\n  }\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme) => ({\n  label: css`\n    color: ${theme.colors.textBlue};\n    font-weight: bold;\n  `,\n}));\n\nexport default AddPermissions;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}