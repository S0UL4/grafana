{"ast":null,"code":"import { css } from '@emotion/css';\nimport { isString } from 'lodash';\nimport React from 'react';\nimport SVG from 'react-inlinesvg';\nimport { ResourceDimensionMode, getPublicOrAbsoluteUrl } from 'app/features/dimensions';\nimport { ColorDimensionEditor, ResourceDimensionEditor } from 'app/features/dimensions/editors';\nimport { APIEditor, callApi } from 'app/plugins/panel/canvas/editor/APIEditor';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n// When a stoke is defined, we want the path to be in page units\nconst svgStrokePathClass = css`\n  path {\n    vector-effect: non-scaling-stroke;\n  }\n`;\nexport function IconDisplay(props) {\n  const {\n    data\n  } = props;\n\n  if (!(data !== null && data !== void 0 && data.path)) {\n    return null;\n  }\n\n  const onClick = () => {\n    if (data !== null && data !== void 0 && data.api) {\n      callApi(data.api);\n    }\n  };\n\n  const svgStyle = {\n    fill: data === null || data === void 0 ? void 0 : data.fill,\n    stroke: data === null || data === void 0 ? void 0 : data.strokeColor,\n    strokeWidth: data === null || data === void 0 ? void 0 : data.stroke\n  };\n  return /*#__PURE__*/_jsx(SVG, {\n    onClick: onClick,\n    src: data.path,\n    style: svgStyle,\n    className: svgStyle.strokeWidth ? svgStrokePathClass : undefined\n  });\n}\nexport const iconItem = {\n  id: 'icon',\n  name: 'Icon',\n  description: 'SVG Icon display',\n  display: IconDisplay,\n  getNewOptions: options => Object.assign({\n    placement: {\n      width: 50,\n      height: 50,\n      top: 0,\n      left: 0\n    }\n  }, options, {\n    config: {\n      path: {\n        mode: ResourceDimensionMode.Fixed,\n        fixed: 'img/icons/unicons/question-circle.svg'\n      },\n      fill: {\n        fixed: '#FFF899'\n      }\n    }\n  }),\n  // Called when data changes\n  prepareData: (ctx, cfg) => {\n    var _cfg$api, _cfg$stroke;\n\n    let path = undefined;\n\n    if (cfg.path) {\n      path = ctx.getResource(cfg.path).value();\n    }\n\n    if (!path || !isString(path)) {\n      path = getPublicOrAbsoluteUrl('img/icons/unicons/question-circle.svg');\n    }\n\n    const data = {\n      path,\n      fill: cfg.fill ? ctx.getColor(cfg.fill).value() : '#CCC',\n      api: (_cfg$api = cfg === null || cfg === void 0 ? void 0 : cfg.api) !== null && _cfg$api !== void 0 ? _cfg$api : undefined\n    };\n\n    if ((_cfg$stroke = cfg.stroke) !== null && _cfg$stroke !== void 0 && _cfg$stroke.width && cfg.stroke.color) {\n      if (cfg.stroke.width > 0) {\n        var _cfg$stroke2;\n\n        data.stroke = (_cfg$stroke2 = cfg.stroke) === null || _cfg$stroke2 === void 0 ? void 0 : _cfg$stroke2.width;\n        data.strokeColor = ctx.getColor(cfg.stroke.color).value();\n      }\n    }\n\n    return data;\n  },\n  // Heatmap overlay options\n  registerOptionsUI: builder => {\n    const category = ['Icon'];\n    builder.addCustomEditor({\n      category,\n      id: 'iconSelector',\n      path: 'config.path',\n      name: 'SVG Path',\n      editor: ResourceDimensionEditor,\n      settings: {\n        resourceType: 'icon'\n      }\n    }).addCustomEditor({\n      category,\n      id: 'config.fill',\n      path: 'config.fill',\n      name: 'Fill color',\n      editor: ColorDimensionEditor,\n      settings: {},\n      defaultValue: {\n        // Configured values\n        fixed: 'grey'\n      }\n    }).addSliderInput({\n      category,\n      path: 'config.stroke.width',\n      name: 'Stroke',\n      defaultValue: 0,\n      settings: {\n        min: 0,\n        max: 10\n      }\n    }).addCustomEditor({\n      category,\n      id: 'config.stroke.color',\n      path: 'config.stroke.color',\n      name: 'Stroke color',\n      editor: ColorDimensionEditor,\n      settings: {},\n      defaultValue: {\n        // Configured values\n        fixed: 'grey'\n      },\n      showIf: cfg => {\n        var _cfg$config, _cfg$config$stroke;\n\n        return Boolean(cfg === null || cfg === void 0 ? void 0 : (_cfg$config = cfg.config) === null || _cfg$config === void 0 ? void 0 : (_cfg$config$stroke = _cfg$config.stroke) === null || _cfg$config$stroke === void 0 ? void 0 : _cfg$config$stroke.width);\n      }\n    }).addCustomEditor({\n      category,\n      id: 'apiSelector',\n      path: 'config.api',\n      name: 'API',\n      editor: APIEditor\n    });\n  }\n};","map":{"version":3,"names":["css","isString","React","SVG","ResourceDimensionMode","getPublicOrAbsoluteUrl","ColorDimensionEditor","ResourceDimensionEditor","APIEditor","callApi","svgStrokePathClass","IconDisplay","props","data","path","onClick","api","svgStyle","fill","stroke","strokeColor","strokeWidth","undefined","iconItem","id","name","description","display","getNewOptions","options","placement","width","height","top","left","config","mode","Fixed","fixed","prepareData","ctx","cfg","getResource","value","getColor","color","registerOptionsUI","builder","category","addCustomEditor","editor","settings","resourceType","defaultValue","addSliderInput","min","max","showIf","Boolean"],"sources":["/home/soula/grafana/public/app/features/canvas/elements/icon.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport { isString } from 'lodash';\nimport React, { CSSProperties } from 'react';\nimport SVG from 'react-inlinesvg';\n\nimport {\n  ColorDimensionConfig,\n  ResourceDimensionConfig,\n  ResourceDimensionMode,\n  getPublicOrAbsoluteUrl,\n} from 'app/features/dimensions';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor, ResourceDimensionEditor } from 'app/features/dimensions/editors';\nimport { APIEditor, APIEditorConfig, callApi } from 'app/plugins/panel/canvas/editor/APIEditor';\n\nimport { CanvasElementItem, CanvasElementProps } from '../element';\nimport { LineConfig } from '../types';\n\nexport interface IconConfig {\n  path?: ResourceDimensionConfig;\n  fill?: ColorDimensionConfig;\n  stroke?: LineConfig;\n  api?: APIEditorConfig;\n}\n\ninterface IconData {\n  path: string;\n  fill: string;\n  strokeColor?: string;\n  stroke?: number;\n  api?: APIEditorConfig;\n}\n\n// When a stoke is defined, we want the path to be in page units\nconst svgStrokePathClass = css`\n  path {\n    vector-effect: non-scaling-stroke;\n  }\n`;\n\nexport function IconDisplay(props: CanvasElementProps) {\n  const { data } = props;\n  if (!data?.path) {\n    return null;\n  }\n\n  const onClick = () => {\n    if (data?.api) {\n      callApi(data.api);\n    }\n  };\n\n  const svgStyle: CSSProperties = {\n    fill: data?.fill,\n    stroke: data?.strokeColor,\n    strokeWidth: data?.stroke,\n  };\n\n  return (\n    <SVG\n      onClick={onClick}\n      src={data.path}\n      style={svgStyle}\n      className={svgStyle.strokeWidth ? svgStrokePathClass : undefined}\n    />\n  );\n}\n\nexport const iconItem: CanvasElementItem<IconConfig, IconData> = {\n  id: 'icon',\n  name: 'Icon',\n  description: 'SVG Icon display',\n\n  display: IconDisplay,\n\n  getNewOptions: (options) => ({\n    placement: {\n      width: 50,\n      height: 50,\n      top: 0,\n      left: 0,\n    },\n    ...options,\n    config: {\n      path: {\n        mode: ResourceDimensionMode.Fixed,\n        fixed: 'img/icons/unicons/question-circle.svg',\n      },\n      fill: { fixed: '#FFF899' },\n    },\n  }),\n\n  // Called when data changes\n  prepareData: (ctx: DimensionContext, cfg: IconConfig) => {\n    let path: string | undefined = undefined;\n    if (cfg.path) {\n      path = ctx.getResource(cfg.path).value();\n    }\n    if (!path || !isString(path)) {\n      path = getPublicOrAbsoluteUrl('img/icons/unicons/question-circle.svg');\n    }\n\n    const data: IconData = {\n      path,\n      fill: cfg.fill ? ctx.getColor(cfg.fill).value() : '#CCC',\n      api: cfg?.api ?? undefined,\n    };\n\n    if (cfg.stroke?.width && cfg.stroke.color) {\n      if (cfg.stroke.width > 0) {\n        data.stroke = cfg.stroke?.width;\n        data.strokeColor = ctx.getColor(cfg.stroke.color).value();\n      }\n    }\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Icon'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'iconSelector',\n        path: 'config.path',\n        name: 'SVG Path',\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'icon',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.fill',\n        path: 'config.fill',\n        name: 'Fill color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: 'grey',\n        },\n      })\n      .addSliderInput({\n        category,\n        path: 'config.stroke.width',\n        name: 'Stroke',\n        defaultValue: 0,\n        settings: {\n          min: 0,\n          max: 10,\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.stroke.color',\n        path: 'config.stroke.color',\n        name: 'Stroke color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: 'grey',\n        },\n        showIf: (cfg) => Boolean(cfg?.config?.stroke?.width),\n      })\n      .addCustomEditor({\n        category,\n        id: 'apiSelector',\n        path: 'config.api',\n        name: 'API',\n        editor: APIEditor,\n      });\n  },\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}