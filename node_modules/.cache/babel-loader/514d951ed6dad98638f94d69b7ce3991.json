{"ast":null,"code":"var _th, _th2, _th3;\n\nimport { css } from '@emotion/css';\nimport React from 'react';\nimport { dateTimeFormat } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Button, DeleteButton, HorizontalGroup, Icon, Tooltip, useTheme2 } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction } from 'app/types';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const ApiKeysTable = ({\n  apiKeys,\n  timeZone,\n  onDelete,\n  onMigrate\n}) => {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n  return /*#__PURE__*/_jsxs(\"table\", {\n    className: \"filter-table\",\n    children: [/*#__PURE__*/_jsx(\"thead\", {\n      children: /*#__PURE__*/_jsxs(\"tr\", {\n        children: [_th || (_th = /*#__PURE__*/_jsx(\"th\", {\n          children: \"Name\"\n        })), _th2 || (_th2 = /*#__PURE__*/_jsx(\"th\", {\n          children: \"Role\"\n        })), _th3 || (_th3 = /*#__PURE__*/_jsx(\"th\", {\n          children: \"Expires\"\n        })), /*#__PURE__*/_jsx(\"th\", {\n          style: {\n            width: '34px'\n          }\n        })]\n      })\n    }), apiKeys.length > 0 ? /*#__PURE__*/_jsx(\"tbody\", {\n      children: apiKeys.map(key => {\n        const isExpired = Boolean(key.expiration && Date.now() > new Date(key.expiration).getTime());\n        return /*#__PURE__*/_jsxs(\"tr\", {\n          className: styles.tableRow(isExpired),\n          children: [/*#__PURE__*/_jsx(\"td\", {\n            children: key.name\n          }), /*#__PURE__*/_jsx(\"td\", {\n            children: key.role\n          }), /*#__PURE__*/_jsxs(\"td\", {\n            children: [formatDate(key.expiration, timeZone), isExpired && /*#__PURE__*/_jsx(\"span\", {\n              className: styles.tooltipContainer,\n              children: /*#__PURE__*/_jsx(Tooltip, {\n                content: \"This API key has expired.\",\n                children: /*#__PURE__*/_jsx(Icon, {\n                  name: 'exclamation-triangle'\n                })\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"td\", {\n            children: /*#__PURE__*/_jsxs(HorizontalGroup, {\n              justify: \"flex-end\",\n              children: [config.featureToggles.serviceAccounts && /*#__PURE__*/_jsx(Button, {\n                size: \"sm\",\n                onClick: () => onMigrate(key),\n                children: \"Migrate\"\n              }), /*#__PURE__*/_jsx(DeleteButton, {\n                \"aria-label\": \"Delete API key\",\n                size: \"sm\",\n                onConfirm: () => onDelete(key),\n                disabled: !contextSrv.hasPermissionInMetadata(AccessControlAction.ActionAPIKeysDelete, key)\n              })]\n            })\n          })]\n        }, key.id);\n      })\n    }) : null]\n  });\n};\n\nfunction formatDate(expiration, timeZone) {\n  if (!expiration) {\n    return 'No expiration date';\n  }\n\n  return dateTimeFormat(expiration, {\n    timeZone\n  });\n}\n\nconst getStyles = theme => ({\n  tableRow: isExpired => css`\n    color: ${isExpired ? theme.colors.text.secondary : theme.colors.text.primary};\n  `,\n  tooltipContainer: css`\n    margin-left: ${theme.spacing(1)};\n  `\n});","map":{"version":3,"names":["css","React","dateTimeFormat","config","Button","DeleteButton","HorizontalGroup","Icon","Tooltip","useTheme2","contextSrv","AccessControlAction","ApiKeysTable","apiKeys","timeZone","onDelete","onMigrate","theme","styles","getStyles","width","length","map","key","isExpired","Boolean","expiration","Date","now","getTime","tableRow","name","role","formatDate","tooltipContainer","featureToggles","serviceAccounts","hasPermissionInMetadata","ActionAPIKeysDelete","id","colors","text","secondary","primary","spacing"],"sources":["/home/soula/grafana/public/app/features/api-keys/ApiKeysTable.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { FC } from 'react';\n\nimport { dateTimeFormat, GrafanaTheme2, TimeZone } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Button, DeleteButton, HorizontalGroup, Icon, IconName, Tooltip, useTheme2 } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction } from 'app/types';\n\nimport { ApiKey } from '../../types';\n\ninterface Props {\n  apiKeys: ApiKey[];\n  timeZone: TimeZone;\n  onDelete: (apiKey: ApiKey) => void;\n  onMigrate: (apiKey: ApiKey) => void;\n}\n\nexport const ApiKeysTable: FC<Props> = ({ apiKeys, timeZone, onDelete, onMigrate }) => {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n\n  return (\n    <table className=\"filter-table\">\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Role</th>\n          <th>Expires</th>\n          <th style={{ width: '34px' }} />\n        </tr>\n      </thead>\n      {apiKeys.length > 0 ? (\n        <tbody>\n          {apiKeys.map((key) => {\n            const isExpired = Boolean(key.expiration && Date.now() > new Date(key.expiration).getTime());\n            return (\n              <tr key={key.id} className={styles.tableRow(isExpired)}>\n                <td>{key.name}</td>\n                <td>{key.role}</td>\n                <td>\n                  {formatDate(key.expiration, timeZone)}\n                  {isExpired && (\n                    <span className={styles.tooltipContainer}>\n                      <Tooltip content=\"This API key has expired.\">\n                        <Icon name={'exclamation-triangle' as IconName} />\n                      </Tooltip>\n                    </span>\n                  )}\n                </td>\n                <td>\n                  <HorizontalGroup justify=\"flex-end\">\n                    {config.featureToggles.serviceAccounts && (\n                      <Button size=\"sm\" onClick={() => onMigrate(key)}>\n                        Migrate\n                      </Button>\n                    )}\n                    <DeleteButton\n                      aria-label=\"Delete API key\"\n                      size=\"sm\"\n                      onConfirm={() => onDelete(key)}\n                      disabled={!contextSrv.hasPermissionInMetadata(AccessControlAction.ActionAPIKeysDelete, key)}\n                    />\n                  </HorizontalGroup>\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      ) : null}\n    </table>\n  );\n};\n\nfunction formatDate(expiration: string | undefined, timeZone: TimeZone): string {\n  if (!expiration) {\n    return 'No expiration date';\n  }\n  return dateTimeFormat(expiration, { timeZone });\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  tableRow: (isExpired: boolean) => css`\n    color: ${isExpired ? theme.colors.text.secondary : theme.colors.text.primary};\n  `,\n  tooltipContainer: css`\n    margin-left: ${theme.spacing(1)};\n  `,\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}