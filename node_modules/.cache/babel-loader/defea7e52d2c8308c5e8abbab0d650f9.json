{"ast":null,"code":"import React, { useMemo } from 'react';\nimport { useQueryParams } from 'app/core/hooks/useQueryParams';\nimport { PromAlertingRuleState } from 'app/types/unified-alerting-dto';\nimport { getFiltersFromUrlParams } from '../../utils/misc';\nimport { isAlertingRule } from '../../utils/rules';\nimport { RuleListStateSection } from './RuleListStateSection';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport const RuleListStateView = ({\n  namespaces\n}) => {\n  const filters = getFiltersFromUrlParams(useQueryParams()[0]);\n  const groupedRules = useMemo(() => {\n    const result = {\n      [PromAlertingRuleState.Firing]: [],\n      [PromAlertingRuleState.Inactive]: [],\n      [PromAlertingRuleState.Pending]: []\n    };\n    namespaces.forEach(namespace => namespace.groups.forEach(group => group.rules.forEach(rule => {\n      if (rule.promRule && isAlertingRule(rule.promRule)) {\n        result[rule.promRule.state].push(rule);\n      }\n    })));\n    Object.values(result).forEach(rules => rules.sort((a, b) => a.name.localeCompare(b.name)));\n    return result;\n  }, [namespaces]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [(!filters.alertState || filters.alertState === PromAlertingRuleState.Firing) && /*#__PURE__*/_jsx(RuleListStateSection, {\n      state: PromAlertingRuleState.Firing,\n      rules: groupedRules[PromAlertingRuleState.Firing]\n    }), (!filters.alertState || filters.alertState === PromAlertingRuleState.Pending) && /*#__PURE__*/_jsx(RuleListStateSection, {\n      state: PromAlertingRuleState.Pending,\n      rules: groupedRules[PromAlertingRuleState.Pending]\n    }), (!filters.alertState || filters.alertState === PromAlertingRuleState.Inactive) && /*#__PURE__*/_jsx(RuleListStateSection, {\n      defaultCollapsed: filters.alertState !== PromAlertingRuleState.Inactive,\n      state: PromAlertingRuleState.Inactive,\n      rules: groupedRules[PromAlertingRuleState.Inactive]\n    })]\n  });\n};","map":{"version":3,"names":["React","useMemo","useQueryParams","PromAlertingRuleState","getFiltersFromUrlParams","isAlertingRule","RuleListStateSection","RuleListStateView","namespaces","filters","groupedRules","result","Firing","Inactive","Pending","forEach","namespace","groups","group","rules","rule","promRule","state","push","Object","values","sort","a","b","name","localeCompare","alertState"],"sources":["/home/soula/grafana/public/app/features/alerting/unified/components/rules/RuleListStateView.tsx"],"sourcesContent":["import React, { FC, useMemo } from 'react';\n\nimport { useQueryParams } from 'app/core/hooks/useQueryParams';\nimport { CombinedRule, CombinedRuleNamespace } from 'app/types/unified-alerting';\nimport { PromAlertingRuleState } from 'app/types/unified-alerting-dto';\n\nimport { getFiltersFromUrlParams } from '../../utils/misc';\nimport { isAlertingRule } from '../../utils/rules';\n\nimport { RuleListStateSection } from './RuleListStateSection';\n\ninterface Props {\n  namespaces: CombinedRuleNamespace[];\n  expandAll?: boolean;\n}\n\ntype GroupedRules = Record<PromAlertingRuleState, CombinedRule[]>;\n\nexport const RuleListStateView: FC<Props> = ({ namespaces }) => {\n  const filters = getFiltersFromUrlParams(useQueryParams()[0]);\n\n  const groupedRules = useMemo(() => {\n    const result: GroupedRules = {\n      [PromAlertingRuleState.Firing]: [],\n      [PromAlertingRuleState.Inactive]: [],\n      [PromAlertingRuleState.Pending]: [],\n    };\n\n    namespaces.forEach((namespace) =>\n      namespace.groups.forEach((group) =>\n        group.rules.forEach((rule) => {\n          if (rule.promRule && isAlertingRule(rule.promRule)) {\n            result[rule.promRule.state].push(rule);\n          }\n        })\n      )\n    );\n\n    Object.values(result).forEach((rules) => rules.sort((a, b) => a.name.localeCompare(b.name)));\n\n    return result;\n  }, [namespaces]);\n  return (\n    <>\n      {(!filters.alertState || filters.alertState === PromAlertingRuleState.Firing) && (\n        <RuleListStateSection state={PromAlertingRuleState.Firing} rules={groupedRules[PromAlertingRuleState.Firing]} />\n      )}\n      {(!filters.alertState || filters.alertState === PromAlertingRuleState.Pending) && (\n        <RuleListStateSection\n          state={PromAlertingRuleState.Pending}\n          rules={groupedRules[PromAlertingRuleState.Pending]}\n        />\n      )}\n      {(!filters.alertState || filters.alertState === PromAlertingRuleState.Inactive) && (\n        <RuleListStateSection\n          defaultCollapsed={filters.alertState !== PromAlertingRuleState.Inactive}\n          state={PromAlertingRuleState.Inactive}\n          rules={groupedRules[PromAlertingRuleState.Inactive]}\n        />\n      )}\n    </>\n  );\n};\n"],"mappings":"AAAA,OAAOA,KAAP,IAAoBC,OAApB,QAAmC,OAAnC;AAEA,SAASC,cAAT,QAA+B,+BAA/B;AAEA,SAASC,qBAAT,QAAsC,gCAAtC;AAEA,SAASC,uBAAT,QAAwC,kBAAxC;AACA,SAASC,cAAT,QAA+B,mBAA/B;AAEA,SAASC,oBAAT,QAAqC,wBAArC;;;;AASA,OAAO,MAAMC,iBAA4B,GAAG,CAAC;EAAEC;AAAF,CAAD,KAAoB;EAC9D,MAAMC,OAAO,GAAGL,uBAAuB,CAACF,cAAc,GAAG,CAAH,CAAf,CAAvC;EAEA,MAAMQ,YAAY,GAAGT,OAAO,CAAC,MAAM;IACjC,MAAMU,MAAoB,GAAG;MAC3B,CAACR,qBAAqB,CAACS,MAAvB,GAAgC,EADL;MAE3B,CAACT,qBAAqB,CAACU,QAAvB,GAAkC,EAFP;MAG3B,CAACV,qBAAqB,CAACW,OAAvB,GAAiC;IAHN,CAA7B;IAMAN,UAAU,CAACO,OAAX,CAAoBC,SAAD,IACjBA,SAAS,CAACC,MAAV,CAAiBF,OAAjB,CAA0BG,KAAD,IACvBA,KAAK,CAACC,KAAN,CAAYJ,OAAZ,CAAqBK,IAAD,IAAU;MAC5B,IAAIA,IAAI,CAACC,QAAL,IAAiBhB,cAAc,CAACe,IAAI,CAACC,QAAN,CAAnC,EAAoD;QAClDV,MAAM,CAACS,IAAI,CAACC,QAAL,CAAcC,KAAf,CAAN,CAA4BC,IAA5B,CAAiCH,IAAjC;MACD;IACF,CAJD,CADF,CADF;IAUAI,MAAM,CAACC,MAAP,CAAcd,MAAd,EAAsBI,OAAtB,CAA+BI,KAAD,IAAWA,KAAK,CAACO,IAAN,CAAW,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAACE,IAAF,CAAOC,aAAP,CAAqBF,CAAC,CAACC,IAAvB,CAArB,CAAzC;IAEA,OAAOlB,MAAP;EACD,CApB2B,EAoBzB,CAACH,UAAD,CApByB,CAA5B;EAqBA,oBACE;IAAA,WACG,CAAC,CAACC,OAAO,CAACsB,UAAT,IAAuBtB,OAAO,CAACsB,UAAR,KAAuB5B,qBAAqB,CAACS,MAArE,kBACC,KAAC,oBAAD;MAAsB,KAAK,EAAET,qBAAqB,CAACS,MAAnD;MAA2D,KAAK,EAAEF,YAAY,CAACP,qBAAqB,CAACS,MAAvB;IAA9E,EAFJ,EAIG,CAAC,CAACH,OAAO,CAACsB,UAAT,IAAuBtB,OAAO,CAACsB,UAAR,KAAuB5B,qBAAqB,CAACW,OAArE,kBACC,KAAC,oBAAD;MACE,KAAK,EAAEX,qBAAqB,CAACW,OAD/B;MAEE,KAAK,EAAEJ,YAAY,CAACP,qBAAqB,CAACW,OAAvB;IAFrB,EALJ,EAUG,CAAC,CAACL,OAAO,CAACsB,UAAT,IAAuBtB,OAAO,CAACsB,UAAR,KAAuB5B,qBAAqB,CAACU,QAArE,kBACC,KAAC,oBAAD;MACE,gBAAgB,EAAEJ,OAAO,CAACsB,UAAR,KAAuB5B,qBAAqB,CAACU,QADjE;MAEE,KAAK,EAAEV,qBAAqB,CAACU,QAF/B;MAGE,KAAK,EAAEH,YAAY,CAACP,qBAAqB,CAACU,QAAvB;IAHrB,EAXJ;EAAA,EADF;AAoBD,CA5CM"},"metadata":{},"sourceType":"module"}