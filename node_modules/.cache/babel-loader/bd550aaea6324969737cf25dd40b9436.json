{"ast":null,"code":"import { rangeUtil } from '@grafana/data';\nimport coreModule from './core_module';\n\nfunction ngModelOnBlur() {\n  return {\n    restrict: 'A',\n    priority: 1,\n    require: 'ngModel',\n    link: (scope, elm, attr, ngModelCtrl) => {\n      if (attr.type === 'radio' || attr.type === 'checkbox') {\n        return;\n      }\n\n      elm.off('input keydown change');\n      elm.bind('blur', () => {\n        scope.$apply(() => {\n          ngModelCtrl.$setViewValue(elm.val());\n        });\n      });\n    }\n  };\n}\n\nfunction emptyToNull() {\n  return {\n    restrict: 'A',\n    require: 'ngModel',\n    link: (scope, elm, attrs, ctrl) => {\n      ctrl.$parsers.push(viewValue => {\n        if (viewValue === '') {\n          return null;\n        }\n\n        return viewValue;\n      });\n    }\n  };\n}\n\nfunction validTimeSpan() {\n  return {\n    require: 'ngModel',\n    link: (scope, elm, attrs, ctrl) => {\n      ctrl.$validators.integer = (modelValue, viewValue) => {\n        if (ctrl.$isEmpty(modelValue)) {\n          return true;\n        }\n\n        if (viewValue.indexOf('$') === 0 || viewValue.indexOf('+$') === 0) {\n          return true; // allow template variable\n        }\n\n        const info = rangeUtil.describeTextRange(viewValue);\n        return info.invalid !== true;\n      };\n    }\n  };\n}\n\ncoreModule.directive('ngModelOnblur', ngModelOnBlur);\ncoreModule.directive('emptyToNull', emptyToNull);\ncoreModule.directive('validTimeSpan', validTimeSpan);","map":{"version":3,"names":["rangeUtil","coreModule","ngModelOnBlur","restrict","priority","require","link","scope","elm","attr","ngModelCtrl","type","off","bind","$apply","$setViewValue","val","emptyToNull","attrs","ctrl","$parsers","push","viewValue","validTimeSpan","$validators","integer","modelValue","$isEmpty","indexOf","info","describeTextRange","invalid","directive"],"sources":["/home/soula/grafana/public/app/angular/ng_model_on_blur.ts"],"sourcesContent":["import { rangeUtil } from '@grafana/data';\n\nimport coreModule from './core_module';\n\nfunction ngModelOnBlur() {\n  return {\n    restrict: 'A',\n    priority: 1,\n    require: 'ngModel',\n    link: (scope: any, elm: any, attr: any, ngModelCtrl: any) => {\n      if (attr.type === 'radio' || attr.type === 'checkbox') {\n        return;\n      }\n\n      elm.off('input keydown change');\n      elm.bind('blur', () => {\n        scope.$apply(() => {\n          ngModelCtrl.$setViewValue(elm.val());\n        });\n      });\n    },\n  };\n}\n\nfunction emptyToNull() {\n  return {\n    restrict: 'A',\n    require: 'ngModel',\n    link: (scope: any, elm: any, attrs: any, ctrl: any) => {\n      ctrl.$parsers.push((viewValue: any) => {\n        if (viewValue === '') {\n          return null;\n        }\n        return viewValue;\n      });\n    },\n  };\n}\n\nfunction validTimeSpan() {\n  return {\n    require: 'ngModel',\n    link: (scope: any, elm: any, attrs: any, ctrl: any) => {\n      ctrl.$validators.integer = (modelValue: any, viewValue: any) => {\n        if (ctrl.$isEmpty(modelValue)) {\n          return true;\n        }\n        if (viewValue.indexOf('$') === 0 || viewValue.indexOf('+$') === 0) {\n          return true; // allow template variable\n        }\n        const info = rangeUtil.describeTextRange(viewValue);\n        return info.invalid !== true;\n      };\n    },\n  };\n}\n\ncoreModule.directive('ngModelOnblur', ngModelOnBlur);\ncoreModule.directive('emptyToNull', emptyToNull);\ncoreModule.directive('validTimeSpan', validTimeSpan);\n"],"mappings":"AAAA,SAASA,SAAT,QAA0B,eAA1B;AAEA,OAAOC,UAAP,MAAuB,eAAvB;;AAEA,SAASC,aAAT,GAAyB;EACvB,OAAO;IACLC,QAAQ,EAAE,GADL;IAELC,QAAQ,EAAE,CAFL;IAGLC,OAAO,EAAE,SAHJ;IAILC,IAAI,EAAE,CAACC,KAAD,EAAaC,GAAb,EAAuBC,IAAvB,EAAkCC,WAAlC,KAAuD;MAC3D,IAAID,IAAI,CAACE,IAAL,KAAc,OAAd,IAAyBF,IAAI,CAACE,IAAL,KAAc,UAA3C,EAAuD;QACrD;MACD;;MAEDH,GAAG,CAACI,GAAJ,CAAQ,sBAAR;MACAJ,GAAG,CAACK,IAAJ,CAAS,MAAT,EAAiB,MAAM;QACrBN,KAAK,CAACO,MAAN,CAAa,MAAM;UACjBJ,WAAW,CAACK,aAAZ,CAA0BP,GAAG,CAACQ,GAAJ,EAA1B;QACD,CAFD;MAGD,CAJD;IAKD;EAfI,CAAP;AAiBD;;AAED,SAASC,WAAT,GAAuB;EACrB,OAAO;IACLd,QAAQ,EAAE,GADL;IAELE,OAAO,EAAE,SAFJ;IAGLC,IAAI,EAAE,CAACC,KAAD,EAAaC,GAAb,EAAuBU,KAAvB,EAAmCC,IAAnC,KAAiD;MACrDA,IAAI,CAACC,QAAL,CAAcC,IAAd,CAAoBC,SAAD,IAAoB;QACrC,IAAIA,SAAS,KAAK,EAAlB,EAAsB;UACpB,OAAO,IAAP;QACD;;QACD,OAAOA,SAAP;MACD,CALD;IAMD;EAVI,CAAP;AAYD;;AAED,SAASC,aAAT,GAAyB;EACvB,OAAO;IACLlB,OAAO,EAAE,SADJ;IAELC,IAAI,EAAE,CAACC,KAAD,EAAaC,GAAb,EAAuBU,KAAvB,EAAmCC,IAAnC,KAAiD;MACrDA,IAAI,CAACK,WAAL,CAAiBC,OAAjB,GAA2B,CAACC,UAAD,EAAkBJ,SAAlB,KAAqC;QAC9D,IAAIH,IAAI,CAACQ,QAAL,CAAcD,UAAd,CAAJ,EAA+B;UAC7B,OAAO,IAAP;QACD;;QACD,IAAIJ,SAAS,CAACM,OAAV,CAAkB,GAAlB,MAA2B,CAA3B,IAAgCN,SAAS,CAACM,OAAV,CAAkB,IAAlB,MAA4B,CAAhE,EAAmE;UACjE,OAAO,IAAP,CADiE,CACpD;QACd;;QACD,MAAMC,IAAI,GAAG7B,SAAS,CAAC8B,iBAAV,CAA4BR,SAA5B,CAAb;QACA,OAAOO,IAAI,CAACE,OAAL,KAAiB,IAAxB;MACD,CATD;IAUD;EAbI,CAAP;AAeD;;AAED9B,UAAU,CAAC+B,SAAX,CAAqB,eAArB,EAAsC9B,aAAtC;AACAD,UAAU,CAAC+B,SAAX,CAAqB,aAArB,EAAoCf,WAApC;AACAhB,UAAU,CAAC+B,SAAX,CAAqB,eAArB,EAAsCT,aAAtC"},"metadata":{},"sourceType":"module"}