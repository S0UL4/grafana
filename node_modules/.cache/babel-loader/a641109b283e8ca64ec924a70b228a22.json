{"ast":null,"code":"import React from 'react'; // @ts-ignore\n\nimport Drop from 'tether-drop';\nimport { locationSearchToObject, navigationLogger, reportPageview } from '@grafana/runtime';\nimport { keybindingSrv } from '../services/keybindingSrv';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport class GrafanaRoute extends React.Component {\n  componentDidMount() {\n    this.updateBodyClassNames();\n    this.cleanupDOM(); // unbinds all and re-bind global keybindins\n\n    keybindingSrv.reset();\n    keybindingSrv.initGlobals();\n    reportPageview();\n    navigationLogger('GrafanaRoute', false, 'Mounted', this.props.match);\n  }\n\n  componentDidUpdate(prevProps) {\n    this.cleanupDOM();\n    reportPageview();\n    navigationLogger('GrafanaRoute', false, 'Updated', this.props, prevProps);\n  }\n\n  componentWillUnmount() {\n    this.updateBodyClassNames(true);\n    navigationLogger('GrafanaRoute', false, 'Unmounted', this.props.route);\n  }\n\n  getPageClasses() {\n    return this.props.route.pageClass ? this.props.route.pageClass.split(' ') : [];\n  }\n\n  updateBodyClassNames(clear = false) {\n    for (const cls of this.getPageClasses()) {\n      if (clear) {\n        document.body.classList.remove(cls);\n      } else {\n        document.body.classList.add(cls);\n      }\n    }\n  }\n\n  cleanupDOM() {\n    var _tooltipById$parentEl;\n\n    document.body.classList.remove('sidemenu-open--xs'); // cleanup tooltips\n\n    const tooltipById = document.getElementById('tooltip');\n    tooltipById === null || tooltipById === void 0 ? void 0 : (_tooltipById$parentEl = tooltipById.parentElement) === null || _tooltipById$parentEl === void 0 ? void 0 : _tooltipById$parentEl.removeChild(tooltipById);\n    const tooltipsByClass = document.querySelectorAll('.tooltip');\n\n    for (let i = 0; i < tooltipsByClass.length; i++) {\n      var _tooltip$parentElemen;\n\n      const tooltip = tooltipsByClass[i];\n      (_tooltip$parentElemen = tooltip.parentElement) === null || _tooltip$parentElemen === void 0 ? void 0 : _tooltip$parentElemen.removeChild(tooltip);\n    } // cleanup tether-drop\n\n\n    for (const drop of Drop.drops) {\n      drop.destroy();\n    }\n  }\n\n  render() {\n    const {\n      props\n    } = this;\n    navigationLogger('GrafanaRoute', false, 'Rendered', props.route);\n    const RouteComponent = props.route.component;\n    return /*#__PURE__*/_jsx(RouteComponent, Object.assign({}, props, {\n      queryParams: locationSearchToObject(props.location.search)\n    }));\n  }\n\n}","map":{"version":3,"names":["React","Drop","locationSearchToObject","navigationLogger","reportPageview","keybindingSrv","GrafanaRoute","Component","componentDidMount","updateBodyClassNames","cleanupDOM","reset","initGlobals","props","match","componentDidUpdate","prevProps","componentWillUnmount","route","getPageClasses","pageClass","split","clear","cls","document","body","classList","remove","add","tooltipById","getElementById","parentElement","removeChild","tooltipsByClass","querySelectorAll","i","length","tooltip","drop","drops","destroy","render","RouteComponent","component","location","search"],"sources":["/home/soula/grafana/public/app/core/navigation/GrafanaRoute.tsx"],"sourcesContent":["import React from 'react';\n// @ts-ignore\nimport Drop from 'tether-drop';\n\nimport { locationSearchToObject, navigationLogger, reportPageview } from '@grafana/runtime';\n\nimport { keybindingSrv } from '../services/keybindingSrv';\n\nimport { GrafanaRouteComponentProps } from './types';\n\nexport interface Props extends Omit<GrafanaRouteComponentProps, 'queryParams'> {}\n\nexport class GrafanaRoute extends React.Component<Props> {\n  componentDidMount() {\n    this.updateBodyClassNames();\n    this.cleanupDOM();\n    // unbinds all and re-bind global keybindins\n    keybindingSrv.reset();\n    keybindingSrv.initGlobals();\n    reportPageview();\n    navigationLogger('GrafanaRoute', false, 'Mounted', this.props.match);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    this.cleanupDOM();\n    reportPageview();\n    navigationLogger('GrafanaRoute', false, 'Updated', this.props, prevProps);\n  }\n\n  componentWillUnmount() {\n    this.updateBodyClassNames(true);\n    navigationLogger('GrafanaRoute', false, 'Unmounted', this.props.route);\n  }\n\n  getPageClasses() {\n    return this.props.route.pageClass ? this.props.route.pageClass.split(' ') : [];\n  }\n\n  updateBodyClassNames(clear = false) {\n    for (const cls of this.getPageClasses()) {\n      if (clear) {\n        document.body.classList.remove(cls);\n      } else {\n        document.body.classList.add(cls);\n      }\n    }\n  }\n\n  cleanupDOM() {\n    document.body.classList.remove('sidemenu-open--xs');\n\n    // cleanup tooltips\n    const tooltipById = document.getElementById('tooltip');\n    tooltipById?.parentElement?.removeChild(tooltipById);\n\n    const tooltipsByClass = document.querySelectorAll('.tooltip');\n    for (let i = 0; i < tooltipsByClass.length; i++) {\n      const tooltip = tooltipsByClass[i];\n      tooltip.parentElement?.removeChild(tooltip);\n    }\n\n    // cleanup tether-drop\n    for (const drop of Drop.drops) {\n      drop.destroy();\n    }\n  }\n\n  render() {\n    const { props } = this;\n    navigationLogger('GrafanaRoute', false, 'Rendered', props.route);\n\n    const RouteComponent = props.route.component;\n\n    return <RouteComponent {...props} queryParams={locationSearchToObject(props.location.search)} />;\n  }\n}\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB,C,CACA;;AACA,OAAOC,IAAP,MAAiB,aAAjB;AAEA,SAASC,sBAAT,EAAiCC,gBAAjC,EAAmDC,cAAnD,QAAyE,kBAAzE;AAEA,SAASC,aAAT,QAA8B,2BAA9B;;AAMA,OAAO,MAAMC,YAAN,SAA2BN,KAAK,CAACO,SAAjC,CAAkD;EACvDC,iBAAiB,GAAG;IAClB,KAAKC,oBAAL;IACA,KAAKC,UAAL,GAFkB,CAGlB;;IACAL,aAAa,CAACM,KAAd;IACAN,aAAa,CAACO,WAAd;IACAR,cAAc;IACdD,gBAAgB,CAAC,cAAD,EAAiB,KAAjB,EAAwB,SAAxB,EAAmC,KAAKU,KAAL,CAAWC,KAA9C,CAAhB;EACD;;EAEDC,kBAAkB,CAACC,SAAD,EAAmB;IACnC,KAAKN,UAAL;IACAN,cAAc;IACdD,gBAAgB,CAAC,cAAD,EAAiB,KAAjB,EAAwB,SAAxB,EAAmC,KAAKU,KAAxC,EAA+CG,SAA/C,CAAhB;EACD;;EAEDC,oBAAoB,GAAG;IACrB,KAAKR,oBAAL,CAA0B,IAA1B;IACAN,gBAAgB,CAAC,cAAD,EAAiB,KAAjB,EAAwB,WAAxB,EAAqC,KAAKU,KAAL,CAAWK,KAAhD,CAAhB;EACD;;EAEDC,cAAc,GAAG;IACf,OAAO,KAAKN,KAAL,CAAWK,KAAX,CAAiBE,SAAjB,GAA6B,KAAKP,KAAL,CAAWK,KAAX,CAAiBE,SAAjB,CAA2BC,KAA3B,CAAiC,GAAjC,CAA7B,GAAqE,EAA5E;EACD;;EAEDZ,oBAAoB,CAACa,KAAK,GAAG,KAAT,EAAgB;IAClC,KAAK,MAAMC,GAAX,IAAkB,KAAKJ,cAAL,EAAlB,EAAyC;MACvC,IAAIG,KAAJ,EAAW;QACTE,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+BJ,GAA/B;MACD,CAFD,MAEO;QACLC,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBE,GAAxB,CAA4BL,GAA5B;MACD;IACF;EACF;;EAEDb,UAAU,GAAG;IAAA;;IACXc,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,MAAxB,CAA+B,mBAA/B,EADW,CAGX;;IACA,MAAME,WAAW,GAAGL,QAAQ,CAACM,cAAT,CAAwB,SAAxB,CAApB;IACAD,WAAW,SAAX,IAAAA,WAAW,WAAX,qCAAAA,WAAW,CAAEE,aAAb,gFAA4BC,WAA5B,CAAwCH,WAAxC;IAEA,MAAMI,eAAe,GAAGT,QAAQ,CAACU,gBAAT,CAA0B,UAA1B,CAAxB;;IACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,eAAe,CAACG,MAApC,EAA4CD,CAAC,EAA7C,EAAiD;MAAA;;MAC/C,MAAME,OAAO,GAAGJ,eAAe,CAACE,CAAD,CAA/B;MACA,yBAAAE,OAAO,CAACN,aAAR,gFAAuBC,WAAvB,CAAmCK,OAAnC;IACD,CAXU,CAaX;;;IACA,KAAK,MAAMC,IAAX,IAAmBrC,IAAI,CAACsC,KAAxB,EAA+B;MAC7BD,IAAI,CAACE,OAAL;IACD;EACF;;EAEDC,MAAM,GAAG;IACP,MAAM;MAAE5B;IAAF,IAAY,IAAlB;IACAV,gBAAgB,CAAC,cAAD,EAAiB,KAAjB,EAAwB,UAAxB,EAAoCU,KAAK,CAACK,KAA1C,CAAhB;IAEA,MAAMwB,cAAc,GAAG7B,KAAK,CAACK,KAAN,CAAYyB,SAAnC;IAEA,oBAAO,KAAC,cAAD,oBAAoB9B,KAApB;MAA2B,WAAW,EAAEX,sBAAsB,CAACW,KAAK,CAAC+B,QAAN,CAAeC,MAAhB;IAA9D,GAAP;EACD;;AA9DsD"},"metadata":{},"sourceType":"module"}