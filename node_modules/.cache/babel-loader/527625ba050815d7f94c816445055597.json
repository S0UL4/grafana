{"ast":null,"code":"import \"core-js/modules/esnext.array.filter-out.js\";\nimport \"core-js/modules/esnext.array.find-last.js\";\nimport \"core-js/modules/esnext.array.find-last-index.js\";\nimport \"core-js/modules/esnext.array.is-template-object.js\";\nimport \"core-js/modules/esnext.array.last-index.js\";\nimport \"core-js/modules/esnext.array.last-item.js\";\nimport \"core-js/modules/esnext.array.unique-by.js\";\nimport \"core-js/modules/esnext.async-iterator.constructor.js\";\nimport \"core-js/modules/esnext.async-iterator.as-indexed-pairs.js\";\nimport \"core-js/modules/esnext.async-iterator.drop.js\";\nimport \"core-js/modules/esnext.async-iterator.every.js\";\nimport \"core-js/modules/esnext.async-iterator.filter.js\";\nimport \"core-js/modules/esnext.async-iterator.find.js\";\nimport \"core-js/modules/esnext.async-iterator.flat-map.js\";\nimport \"core-js/modules/esnext.async-iterator.for-each.js\";\nimport \"core-js/modules/esnext.async-iterator.from.js\";\nimport \"core-js/modules/esnext.async-iterator.map.js\";\nimport \"core-js/modules/esnext.async-iterator.reduce.js\";\nimport \"core-js/modules/esnext.async-iterator.some.js\";\nimport \"core-js/modules/esnext.async-iterator.take.js\";\nimport \"core-js/modules/esnext.async-iterator.to-array.js\";\nimport \"core-js/modules/esnext.bigint.range.js\";\nimport \"core-js/modules/esnext.composite-key.js\";\nimport \"core-js/modules/esnext.composite-symbol.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.as-indexed-pairs.js\";\nimport \"core-js/modules/esnext.iterator.drop.js\";\nimport \"core-js/modules/esnext.iterator.every.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.flat-map.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.from.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nimport \"core-js/modules/esnext.iterator.take.js\";\nimport \"core-js/modules/esnext.iterator.to-array.js\";\nimport \"core-js/modules/esnext.map.delete-all.js\";\nimport \"core-js/modules/esnext.map.emplace.js\";\nimport \"core-js/modules/esnext.map.every.js\";\nimport \"core-js/modules/esnext.map.filter.js\";\nimport \"core-js/modules/esnext.map.find.js\";\nimport \"core-js/modules/esnext.map.find-key.js\";\nimport \"core-js/modules/esnext.map.from.js\";\nimport \"core-js/modules/esnext.map.group-by.js\";\nimport \"core-js/modules/esnext.map.includes.js\";\nimport \"core-js/modules/esnext.map.key-by.js\";\nimport \"core-js/modules/esnext.map.key-of.js\";\nimport \"core-js/modules/esnext.map.map-keys.js\";\nimport \"core-js/modules/esnext.map.map-values.js\";\nimport \"core-js/modules/esnext.map.merge.js\";\nimport \"core-js/modules/esnext.map.of.js\";\nimport \"core-js/modules/esnext.map.reduce.js\";\nimport \"core-js/modules/esnext.map.some.js\";\nimport \"core-js/modules/esnext.map.update.js\";\nimport \"core-js/modules/esnext.map.update-or-insert.js\";\nimport \"core-js/modules/esnext.map.upsert.js\";\nimport \"core-js/modules/esnext.math.clamp.js\";\nimport \"core-js/modules/esnext.math.deg-per-rad.js\";\nimport \"core-js/modules/esnext.math.degrees.js\";\nimport \"core-js/modules/esnext.math.fscale.js\";\nimport \"core-js/modules/esnext.math.iaddh.js\";\nimport \"core-js/modules/esnext.math.imulh.js\";\nimport \"core-js/modules/esnext.math.isubh.js\";\nimport \"core-js/modules/esnext.math.rad-per-deg.js\";\nimport \"core-js/modules/esnext.math.radians.js\";\nimport \"core-js/modules/esnext.math.scale.js\";\nimport \"core-js/modules/esnext.math.seeded-prng.js\";\nimport \"core-js/modules/esnext.math.signbit.js\";\nimport \"core-js/modules/esnext.math.umulh.js\";\nimport \"core-js/modules/esnext.number.from-string.js\";\nimport \"core-js/modules/esnext.number.range.js\";\nimport \"core-js/modules/esnext.object.iterate-entries.js\";\nimport \"core-js/modules/esnext.object.iterate-keys.js\";\nimport \"core-js/modules/esnext.object.iterate-values.js\";\nimport \"core-js/modules/esnext.observable.js\";\nimport \"core-js/modules/esnext.promise.try.js\";\nimport \"core-js/modules/esnext.reflect.define-metadata.js\";\nimport \"core-js/modules/esnext.reflect.delete-metadata.js\";\nimport \"core-js/modules/esnext.reflect.get-metadata.js\";\nimport \"core-js/modules/esnext.reflect.get-metadata-keys.js\";\nimport \"core-js/modules/esnext.reflect.get-own-metadata.js\";\nimport \"core-js/modules/esnext.reflect.get-own-metadata-keys.js\";\nimport \"core-js/modules/esnext.reflect.has-metadata.js\";\nimport \"core-js/modules/esnext.reflect.has-own-metadata.js\";\nimport \"core-js/modules/esnext.reflect.metadata.js\";\nimport \"core-js/modules/esnext.set.add-all.js\";\nimport \"core-js/modules/esnext.set.delete-all.js\";\nimport \"core-js/modules/esnext.set.difference.js\";\nimport \"core-js/modules/esnext.set.every.js\";\nimport \"core-js/modules/esnext.set.filter.js\";\nimport \"core-js/modules/esnext.set.find.js\";\nimport \"core-js/modules/esnext.set.from.js\";\nimport \"core-js/modules/esnext.set.intersection.js\";\nimport \"core-js/modules/esnext.set.is-disjoint-from.js\";\nimport \"core-js/modules/esnext.set.is-subset-of.js\";\nimport \"core-js/modules/esnext.set.is-superset-of.js\";\nimport \"core-js/modules/esnext.set.join.js\";\nimport \"core-js/modules/esnext.set.map.js\";\nimport \"core-js/modules/esnext.set.of.js\";\nimport \"core-js/modules/esnext.set.reduce.js\";\nimport \"core-js/modules/esnext.set.some.js\";\nimport \"core-js/modules/esnext.set.symmetric-difference.js\";\nimport \"core-js/modules/esnext.set.union.js\";\nimport \"core-js/modules/esnext.string.at.js\";\nimport \"core-js/modules/esnext.string.code-points.js\";\nimport \"core-js/modules/esnext.symbol.async-dispose.js\";\nimport \"core-js/modules/esnext.symbol.dispose.js\";\nimport \"core-js/modules/esnext.symbol.observable.js\";\nimport \"core-js/modules/esnext.symbol.pattern-match.js\";\nimport \"core-js/modules/esnext.symbol.replace-all.js\";\nimport \"core-js/modules/esnext.typed-array.filter-out.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\nimport \"core-js/modules/esnext.typed-array.unique-by.js\";\nimport \"core-js/modules/esnext.weak-map.delete-all.js\";\nimport \"core-js/modules/esnext.weak-map.from.js\";\nimport \"core-js/modules/esnext.weak-map.of.js\";\nimport \"core-js/modules/esnext.weak-map.emplace.js\";\nimport \"core-js/modules/esnext.weak-map.upsert.js\";\nimport \"core-js/modules/esnext.weak-set.add-all.js\";\nimport \"core-js/modules/esnext.weak-set.delete-all.js\";\nimport \"core-js/modules/esnext.weak-set.from.js\";\nimport \"core-js/modules/esnext.weak-set.of.js\";\nimport \"core-js/modules/web.immediate.js\";\nimport 'symbol-observable';\nimport 'whatwg-fetch'; // fetch polyfill needed for PhantomJs rendering\n\nimport './polyfills/old-mediaquerylist'; // Safari < 14 does not have mql.addEventListener()\n\nimport 'file-saver';\nimport 'jquery';\nimport 'app/features/all';\nimport _ from 'lodash'; // eslint-disable-line lodash/import-scope\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { locationUtil, monacoLanguageRegistry, setLocale, setTimeZoneResolver, setWeekStart, standardEditorsRegistry, standardFieldConfigEditorRegistry, standardTransformersRegistry } from '@grafana/data';\nimport { locationService, registerEchoBackend, setBackendSrv, setDataSourceSrv, setEchoSrv, setLocationSrv, setQueryRunnerFactory } from '@grafana/runtime';\nimport { setPanelDataErrorView } from '@grafana/runtime/src/components/PanelDataErrorView';\nimport { setPanelRenderer } from '@grafana/runtime/src/components/PanelRenderer';\nimport { getScrollbarWidth } from '@grafana/ui';\nimport config from 'app/core/config';\nimport { arrayMove } from 'app/core/utils/arrayMove';\nimport { getStandardTransformers } from 'app/features/transformers/standardTransformers';\nimport getDefaultMonacoLanguages from '../lib/monaco-languages';\nimport { AppWrapper } from './AppWrapper';\nimport { getAllOptionEditors, getAllStandardFieldConfigs } from './core/components/OptionsUI/registry';\nimport { interceptLinkClicks } from './core/navigation/patch/interceptLinkClicks';\nimport { ModalManager } from './core/services/ModalManager';\nimport { backendSrv } from './core/services/backend_srv';\nimport { contextSrv } from './core/services/context_srv';\nimport { Echo } from './core/services/echo/Echo';\nimport { reportPerformance } from './core/services/echo/EchoSrv';\nimport { PerformanceBackend } from './core/services/echo/backends/PerformanceBackend';\nimport { ApplicationInsightsBackend } from './core/services/echo/backends/analytics/ApplicationInsightsBackend';\nimport { GAEchoBackend } from './core/services/echo/backends/analytics/GABackend';\nimport { RudderstackBackend } from './core/services/echo/backends/analytics/RudderstackBackend';\nimport { SentryEchoBackend } from './core/services/echo/backends/sentry/SentryBackend';\nimport { initDevFeatures } from './dev';\nimport { getTimeSrv } from './features/dashboard/services/TimeSrv';\nimport { PanelDataErrorView } from './features/panel/components/PanelDataErrorView';\nimport { PanelRenderer } from './features/panel/components/PanelRenderer';\nimport { DatasourceSrv } from './features/plugins/datasource_srv';\nimport { preloadPlugins } from './features/plugins/pluginPreloader';\nimport { QueryRunner } from './features/query/state/QueryRunner';\nimport { initWindowRuntime } from './features/runtime/init';\nimport { variableAdapters } from './features/variables/adapters';\nimport { createAdHocVariableAdapter } from './features/variables/adhoc/adapter';\nimport { createConstantVariableAdapter } from './features/variables/constant/adapter';\nimport { createCustomVariableAdapter } from './features/variables/custom/adapter';\nimport { createDataSourceVariableAdapter } from './features/variables/datasource/adapter';\nimport { getVariablesUrlParams } from './features/variables/getAllVariableValuesForUrl';\nimport { createIntervalVariableAdapter } from './features/variables/interval/adapter';\nimport { setVariableQueryRunner, VariableQueryRunner } from './features/variables/query/VariableQueryRunner';\nimport { createQueryVariableAdapter } from './features/variables/query/adapter';\nimport { createSystemVariableAdapter } from './features/variables/system/adapter';\nimport { createTextBoxVariableAdapter } from './features/variables/textbox/adapter';\nimport { configureStore } from './store/configureStore'; // add move to lodash for backward compatabilty with plugins\n// @ts-ignore\n\n_.move = arrayMove; // import symlinked extensions\n\nconst extensionsIndex = require.context('.', true, /extensions\\/index.ts/);\n\nconst extensionsExports = extensionsIndex.keys().map(key => {\n  return extensionsIndex(key);\n});\n\nif (process.env.NODE_ENV === 'development') {\n  initDevFeatures();\n}\n\nexport class GrafanaApp {\n  async init() {\n    try {\n      setBackendSrv(backendSrv);\n      initEchoSrv();\n      addClassIfNoOverlayScrollbar();\n      setLocale(config.bootData.user.locale);\n      setWeekStart(config.bootData.user.weekStart);\n      setPanelRenderer(PanelRenderer);\n      setPanelDataErrorView(PanelDataErrorView);\n      setLocationSrv(locationService);\n      setTimeZoneResolver(() => config.bootData.user.timezone); // Important that extension reducers are initialized before store\n\n      addExtensionReducers();\n      configureStore();\n      initExtensions();\n      standardEditorsRegistry.setInit(getAllOptionEditors);\n      standardFieldConfigEditorRegistry.setInit(getAllStandardFieldConfigs);\n      standardTransformersRegistry.setInit(getStandardTransformers);\n      variableAdapters.setInit(() => [createQueryVariableAdapter(), createCustomVariableAdapter(), createTextBoxVariableAdapter(), createConstantVariableAdapter(), createDataSourceVariableAdapter(), createIntervalVariableAdapter(), createAdHocVariableAdapter(), createSystemVariableAdapter()]);\n      monacoLanguageRegistry.setInit(getDefaultMonacoLanguages);\n      setQueryRunnerFactory(() => new QueryRunner());\n      setVariableQueryRunner(new VariableQueryRunner());\n      locationUtil.initialize({\n        config,\n        getTimeRangeForUrl: getTimeSrv().timeRangeForUrl,\n        getVariablesUrlParams: getVariablesUrlParams\n      }); // intercept anchor clicks and forward it to custom history instead of relying on browser's history\n\n      document.addEventListener('click', interceptLinkClicks); // Init DataSourceSrv\n\n      const dataSourceSrv = new DatasourceSrv();\n      dataSourceSrv.init(config.datasources, config.defaultDatasource);\n      setDataSourceSrv(dataSourceSrv);\n      initWindowRuntime(); // init modal manager\n\n      const modalManager = new ModalManager();\n      modalManager.init(); // Preload selected app plugins\n\n      await preloadPlugins(config.pluginsToPreload);\n      ReactDOM.render( /*#__PURE__*/React.createElement(AppWrapper, {\n        app: this\n      }), document.getElementById('reactRoot'));\n    } catch (error) {\n      console.error('Failed to start Grafana', error);\n\n      window.__grafana_load_failed();\n    }\n  }\n\n}\n\nfunction addExtensionReducers() {\n  if (extensionsExports.length > 0) {\n    extensionsExports[0].addExtensionReducers();\n  }\n}\n\nfunction initExtensions() {\n  if (extensionsExports.length > 0) {\n    extensionsExports[0].init();\n  }\n}\n\nfunction initEchoSrv() {\n  setEchoSrv(new Echo({\n    debug: process.env.NODE_ENV === 'development'\n  }));\n  window.addEventListener('load', e => {\n    const loadMetricName = 'frontend_boot_load_time_seconds'; // Metrics below are marked in public/views/index-template.html\n\n    const jsLoadMetricName = 'frontend_boot_js_done_time_seconds';\n    const cssLoadMetricName = 'frontend_boot_css_time_seconds';\n\n    if (performance) {\n      performance.mark(loadMetricName);\n      reportMetricPerformanceMark('first-paint', 'frontend_boot_', '_time_seconds');\n      reportMetricPerformanceMark('first-contentful-paint', 'frontend_boot_', '_time_seconds');\n      reportMetricPerformanceMark(loadMetricName);\n      reportMetricPerformanceMark(jsLoadMetricName);\n      reportMetricPerformanceMark(cssLoadMetricName);\n    }\n  });\n\n  if (contextSrv.user.orgRole !== '') {\n    registerEchoBackend(new PerformanceBackend({}));\n  }\n\n  if (config.sentry.enabled) {\n    registerEchoBackend(new SentryEchoBackend(Object.assign({}, config.sentry, {\n      user: config.bootData.user,\n      buildInfo: config.buildInfo\n    })));\n  }\n\n  if (config.googleAnalyticsId) {\n    registerEchoBackend(new GAEchoBackend({\n      googleAnalyticsId: config.googleAnalyticsId\n    }));\n  }\n\n  if (config.rudderstackWriteKey && config.rudderstackDataPlaneUrl) {\n    registerEchoBackend(new RudderstackBackend({\n      writeKey: config.rudderstackWriteKey,\n      dataPlaneUrl: config.rudderstackDataPlaneUrl,\n      user: config.bootData.user,\n      sdkUrl: config.rudderstackSdkUrl,\n      configUrl: config.rudderstackConfigUrl\n    }));\n  }\n\n  if (config.applicationInsightsConnectionString) {\n    registerEchoBackend(new ApplicationInsightsBackend({\n      connectionString: config.applicationInsightsConnectionString,\n      endpointUrl: config.applicationInsightsEndpointUrl\n    }));\n  }\n}\n\nfunction addClassIfNoOverlayScrollbar() {\n  if (getScrollbarWidth() > 0) {\n    document.body.classList.add('no-overlay-scrollbar');\n  }\n}\n/**\n * Report when a metric of a given name was marked during the document lifecycle. Works for markers with no duration,\n * like PerformanceMark or PerformancePaintTiming (e.g. created with performance.mark, or first-contentful-paint)\n */\n\n\nfunction reportMetricPerformanceMark(metricName, prefix = '', suffix = '') {\n  const metric = _.first(performance.getEntriesByName(metricName));\n\n  if (metric) {\n    const metricName = metric.name.replace(/-/g, '_');\n    reportPerformance(`${prefix}${metricName}${suffix}`, Math.round(metric.startTime) / 1000);\n  }\n}\n\nexport default new GrafanaApp();","map":{"version":3,"names":["_","React","ReactDOM","locationUtil","monacoLanguageRegistry","setLocale","setTimeZoneResolver","setWeekStart","standardEditorsRegistry","standardFieldConfigEditorRegistry","standardTransformersRegistry","locationService","registerEchoBackend","setBackendSrv","setDataSourceSrv","setEchoSrv","setLocationSrv","setQueryRunnerFactory","setPanelDataErrorView","setPanelRenderer","getScrollbarWidth","config","arrayMove","getStandardTransformers","getDefaultMonacoLanguages","AppWrapper","getAllOptionEditors","getAllStandardFieldConfigs","interceptLinkClicks","ModalManager","backendSrv","contextSrv","Echo","reportPerformance","PerformanceBackend","ApplicationInsightsBackend","GAEchoBackend","RudderstackBackend","SentryEchoBackend","initDevFeatures","getTimeSrv","PanelDataErrorView","PanelRenderer","DatasourceSrv","preloadPlugins","QueryRunner","initWindowRuntime","variableAdapters","createAdHocVariableAdapter","createConstantVariableAdapter","createCustomVariableAdapter","createDataSourceVariableAdapter","getVariablesUrlParams","createIntervalVariableAdapter","setVariableQueryRunner","VariableQueryRunner","createQueryVariableAdapter","createSystemVariableAdapter","createTextBoxVariableAdapter","configureStore","move","extensionsIndex","require","context","extensionsExports","keys","map","key","process","env","NODE_ENV","GrafanaApp","init","initEchoSrv","addClassIfNoOverlayScrollbar","bootData","user","locale","weekStart","timezone","addExtensionReducers","initExtensions","setInit","initialize","getTimeRangeForUrl","timeRangeForUrl","document","addEventListener","dataSourceSrv","datasources","defaultDatasource","modalManager","pluginsToPreload","render","createElement","app","getElementById","error","console","window","__grafana_load_failed","length","debug","e","loadMetricName","jsLoadMetricName","cssLoadMetricName","performance","mark","reportMetricPerformanceMark","orgRole","sentry","enabled","buildInfo","googleAnalyticsId","rudderstackWriteKey","rudderstackDataPlaneUrl","writeKey","dataPlaneUrl","sdkUrl","rudderstackSdkUrl","configUrl","rudderstackConfigUrl","applicationInsightsConnectionString","connectionString","endpointUrl","applicationInsightsEndpointUrl","body","classList","add","metricName","prefix","suffix","metric","first","getEntriesByName","name","replace","Math","round","startTime"],"sources":["/home/soula/grafana/public/app/app.ts"],"sourcesContent":["import 'symbol-observable';\nimport 'core-js';\nimport 'regenerator-runtime/runtime';\n\nimport 'whatwg-fetch'; // fetch polyfill needed for PhantomJs rendering\nimport './polyfills/old-mediaquerylist'; // Safari < 14 does not have mql.addEventListener()\nimport 'file-saver';\nimport 'jquery';\n\nimport 'app/features/all';\n\nimport _ from 'lodash'; // eslint-disable-line lodash/import-scope\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport {\n  locationUtil,\n  monacoLanguageRegistry,\n  setLocale,\n  setTimeZoneResolver,\n  setWeekStart,\n  standardEditorsRegistry,\n  standardFieldConfigEditorRegistry,\n  standardTransformersRegistry,\n} from '@grafana/data';\nimport {\n  locationService,\n  registerEchoBackend,\n  setBackendSrv,\n  setDataSourceSrv,\n  setEchoSrv,\n  setLocationSrv,\n  setQueryRunnerFactory,\n} from '@grafana/runtime';\nimport { setPanelDataErrorView } from '@grafana/runtime/src/components/PanelDataErrorView';\nimport { setPanelRenderer } from '@grafana/runtime/src/components/PanelRenderer';\nimport { getScrollbarWidth } from '@grafana/ui';\nimport config from 'app/core/config';\nimport { arrayMove } from 'app/core/utils/arrayMove';\nimport { getStandardTransformers } from 'app/features/transformers/standardTransformers';\n\nimport getDefaultMonacoLanguages from '../lib/monaco-languages';\n\nimport { AppWrapper } from './AppWrapper';\nimport { getAllOptionEditors, getAllStandardFieldConfigs } from './core/components/OptionsUI/registry';\nimport { interceptLinkClicks } from './core/navigation/patch/interceptLinkClicks';\nimport { ModalManager } from './core/services/ModalManager';\nimport { backendSrv } from './core/services/backend_srv';\nimport { contextSrv } from './core/services/context_srv';\nimport { Echo } from './core/services/echo/Echo';\nimport { reportPerformance } from './core/services/echo/EchoSrv';\nimport { PerformanceBackend } from './core/services/echo/backends/PerformanceBackend';\nimport { ApplicationInsightsBackend } from './core/services/echo/backends/analytics/ApplicationInsightsBackend';\nimport { GAEchoBackend } from './core/services/echo/backends/analytics/GABackend';\nimport { RudderstackBackend } from './core/services/echo/backends/analytics/RudderstackBackend';\nimport { SentryEchoBackend } from './core/services/echo/backends/sentry/SentryBackend';\nimport { initDevFeatures } from './dev';\nimport { getTimeSrv } from './features/dashboard/services/TimeSrv';\nimport { PanelDataErrorView } from './features/panel/components/PanelDataErrorView';\nimport { PanelRenderer } from './features/panel/components/PanelRenderer';\nimport { DatasourceSrv } from './features/plugins/datasource_srv';\nimport { preloadPlugins } from './features/plugins/pluginPreloader';\nimport { QueryRunner } from './features/query/state/QueryRunner';\nimport { initWindowRuntime } from './features/runtime/init';\nimport { variableAdapters } from './features/variables/adapters';\nimport { createAdHocVariableAdapter } from './features/variables/adhoc/adapter';\nimport { createConstantVariableAdapter } from './features/variables/constant/adapter';\nimport { createCustomVariableAdapter } from './features/variables/custom/adapter';\nimport { createDataSourceVariableAdapter } from './features/variables/datasource/adapter';\nimport { getVariablesUrlParams } from './features/variables/getAllVariableValuesForUrl';\nimport { createIntervalVariableAdapter } from './features/variables/interval/adapter';\nimport { setVariableQueryRunner, VariableQueryRunner } from './features/variables/query/VariableQueryRunner';\nimport { createQueryVariableAdapter } from './features/variables/query/adapter';\nimport { createSystemVariableAdapter } from './features/variables/system/adapter';\nimport { createTextBoxVariableAdapter } from './features/variables/textbox/adapter';\nimport { configureStore } from './store/configureStore';\n\n// add move to lodash for backward compatabilty with plugins\n// @ts-ignore\n_.move = arrayMove;\n\n// import symlinked extensions\nconst extensionsIndex = require.context('.', true, /extensions\\/index.ts/);\nconst extensionsExports = extensionsIndex.keys().map((key) => {\n  return extensionsIndex(key);\n});\n\nif (process.env.NODE_ENV === 'development') {\n  initDevFeatures();\n}\n\nexport class GrafanaApp {\n  async init() {\n    try {\n      setBackendSrv(backendSrv);\n      initEchoSrv();\n      addClassIfNoOverlayScrollbar();\n      setLocale(config.bootData.user.locale);\n      setWeekStart(config.bootData.user.weekStart);\n      setPanelRenderer(PanelRenderer);\n      setPanelDataErrorView(PanelDataErrorView);\n      setLocationSrv(locationService);\n      setTimeZoneResolver(() => config.bootData.user.timezone);\n      // Important that extension reducers are initialized before store\n      addExtensionReducers();\n      configureStore();\n      initExtensions();\n\n      standardEditorsRegistry.setInit(getAllOptionEditors);\n      standardFieldConfigEditorRegistry.setInit(getAllStandardFieldConfigs);\n      standardTransformersRegistry.setInit(getStandardTransformers);\n      variableAdapters.setInit(() => [\n        createQueryVariableAdapter(),\n        createCustomVariableAdapter(),\n        createTextBoxVariableAdapter(),\n        createConstantVariableAdapter(),\n        createDataSourceVariableAdapter(),\n        createIntervalVariableAdapter(),\n        createAdHocVariableAdapter(),\n        createSystemVariableAdapter(),\n      ]);\n      monacoLanguageRegistry.setInit(getDefaultMonacoLanguages);\n\n      setQueryRunnerFactory(() => new QueryRunner());\n      setVariableQueryRunner(new VariableQueryRunner());\n\n      locationUtil.initialize({\n        config,\n        getTimeRangeForUrl: getTimeSrv().timeRangeForUrl,\n        getVariablesUrlParams: getVariablesUrlParams,\n      });\n\n      // intercept anchor clicks and forward it to custom history instead of relying on browser's history\n      document.addEventListener('click', interceptLinkClicks);\n\n      // Init DataSourceSrv\n      const dataSourceSrv = new DatasourceSrv();\n      dataSourceSrv.init(config.datasources, config.defaultDatasource);\n      setDataSourceSrv(dataSourceSrv);\n      initWindowRuntime();\n\n      // init modal manager\n      const modalManager = new ModalManager();\n      modalManager.init();\n\n      // Preload selected app plugins\n      await preloadPlugins(config.pluginsToPreload);\n\n      ReactDOM.render(\n        React.createElement(AppWrapper, {\n          app: this,\n        }),\n        document.getElementById('reactRoot')\n      );\n    } catch (error) {\n      console.error('Failed to start Grafana', error);\n      window.__grafana_load_failed();\n    }\n  }\n}\n\nfunction addExtensionReducers() {\n  if (extensionsExports.length > 0) {\n    extensionsExports[0].addExtensionReducers();\n  }\n}\n\nfunction initExtensions() {\n  if (extensionsExports.length > 0) {\n    extensionsExports[0].init();\n  }\n}\n\nfunction initEchoSrv() {\n  setEchoSrv(new Echo({ debug: process.env.NODE_ENV === 'development' }));\n\n  window.addEventListener('load', (e) => {\n    const loadMetricName = 'frontend_boot_load_time_seconds';\n    // Metrics below are marked in public/views/index-template.html\n    const jsLoadMetricName = 'frontend_boot_js_done_time_seconds';\n    const cssLoadMetricName = 'frontend_boot_css_time_seconds';\n\n    if (performance) {\n      performance.mark(loadMetricName);\n      reportMetricPerformanceMark('first-paint', 'frontend_boot_', '_time_seconds');\n      reportMetricPerformanceMark('first-contentful-paint', 'frontend_boot_', '_time_seconds');\n      reportMetricPerformanceMark(loadMetricName);\n      reportMetricPerformanceMark(jsLoadMetricName);\n      reportMetricPerformanceMark(cssLoadMetricName);\n    }\n  });\n\n  if (contextSrv.user.orgRole !== '') {\n    registerEchoBackend(new PerformanceBackend({}));\n  }\n\n  if (config.sentry.enabled) {\n    registerEchoBackend(\n      new SentryEchoBackend({\n        ...config.sentry,\n        user: config.bootData.user,\n        buildInfo: config.buildInfo,\n      })\n    );\n  }\n\n  if (config.googleAnalyticsId) {\n    registerEchoBackend(\n      new GAEchoBackend({\n        googleAnalyticsId: config.googleAnalyticsId,\n      })\n    );\n  }\n\n  if (config.rudderstackWriteKey && config.rudderstackDataPlaneUrl) {\n    registerEchoBackend(\n      new RudderstackBackend({\n        writeKey: config.rudderstackWriteKey,\n        dataPlaneUrl: config.rudderstackDataPlaneUrl,\n        user: config.bootData.user,\n        sdkUrl: config.rudderstackSdkUrl,\n        configUrl: config.rudderstackConfigUrl,\n      })\n    );\n  }\n\n  if (config.applicationInsightsConnectionString) {\n    registerEchoBackend(\n      new ApplicationInsightsBackend({\n        connectionString: config.applicationInsightsConnectionString,\n        endpointUrl: config.applicationInsightsEndpointUrl,\n      })\n    );\n  }\n}\n\nfunction addClassIfNoOverlayScrollbar() {\n  if (getScrollbarWidth() > 0) {\n    document.body.classList.add('no-overlay-scrollbar');\n  }\n}\n\n/**\n * Report when a metric of a given name was marked during the document lifecycle. Works for markers with no duration,\n * like PerformanceMark or PerformancePaintTiming (e.g. created with performance.mark, or first-contentful-paint)\n */\nfunction reportMetricPerformanceMark(metricName: string, prefix = '', suffix = ''): void {\n  const metric = _.first(performance.getEntriesByName(metricName));\n  if (metric) {\n    const metricName = metric.name.replace(/-/g, '_');\n    reportPerformance(`${prefix}${metricName}${suffix}`, Math.round(metric.startTime) / 1000);\n  }\n}\n\nexport default new GrafanaApp();\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}