{"ast":null,"code":"var _Label, _Icon;\n\nimport { css } from '@emotion/css';\nimport { debounce, uniqueId } from 'lodash';\nimport React, { useState } from 'react';\nimport { Stack } from '@grafana/experimental';\nimport { Label, Icon, Input, Tooltip, RadioButtonGroup, useStyles2, Button, Field } from '@grafana/ui';\nimport { useQueryParams } from 'app/core/hooks/useQueryParams';\nimport { SilenceState } from 'app/plugins/datasource/alertmanager/types';\nimport { parseMatchers } from '../../utils/alertmanager';\nimport { getSilenceFiltersFromUrlParams } from '../../utils/misc';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nconst stateOptions = Object.entries(SilenceState).map(([key, value]) => ({\n  label: key,\n  value\n}));\n\nconst getQueryStringKey = () => uniqueId('query-string-');\n\nexport const SilencesFilter = () => {\n  const [queryStringKey, setQueryStringKey] = useState(getQueryStringKey());\n  const [queryParams, setQueryParams] = useQueryParams();\n  const {\n    queryString,\n    silenceState\n  } = getSilenceFiltersFromUrlParams(queryParams);\n  const styles = useStyles2(getStyles);\n  const handleQueryStringChange = debounce(e => {\n    const target = e.target;\n    setQueryParams({\n      queryString: target.value || null\n    });\n  }, 400);\n\n  const handleSilenceStateChange = state => {\n    setQueryParams({\n      silenceState: state\n    });\n  };\n\n  const clearFilters = () => {\n    setQueryParams({\n      queryString: null,\n      silenceState: null\n    });\n    setTimeout(() => setQueryStringKey(getQueryStringKey()));\n  };\n\n  const inputInvalid = queryString && queryString.length > 3 ? parseMatchers(queryString).length === 0 : false;\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.flexRow,\n    children: [/*#__PURE__*/_jsx(Field, {\n      className: styles.rowChild,\n      label: _Label || (_Label = /*#__PURE__*/_jsx(Label, {\n        children: /*#__PURE__*/_jsxs(Stack, {\n          gap: 0.5,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            children: \"Search by matchers\"\n          }), /*#__PURE__*/_jsx(Tooltip, {\n            content: /*#__PURE__*/_jsxs(\"div\", {\n              children: [\"Filter silences by matchers using a comma separated list of matchers, ie:\", /*#__PURE__*/_jsx(\"pre\", {\n                children: `severity=critical, instance=~cluster-us-.+`\n              })]\n            }),\n            children: /*#__PURE__*/_jsx(Icon, {\n              name: \"info-circle\",\n              size: \"sm\"\n            })\n          })]\n        })\n      })),\n      invalid: inputInvalid,\n      error: inputInvalid ? 'Query must use valid matcher syntax' : null,\n      children: /*#__PURE__*/_jsx(Input, {\n        className: styles.searchInput,\n        prefix: _Icon || (_Icon = /*#__PURE__*/_jsx(Icon, {\n          name: \"search\"\n        })),\n        onChange: handleQueryStringChange,\n        defaultValue: queryString !== null && queryString !== void 0 ? queryString : '',\n        placeholder: \"Search\",\n        \"data-testid\": \"search-query-input\"\n      }, queryStringKey)\n    }), /*#__PURE__*/_jsx(Field, {\n      className: styles.rowChild,\n      label: \"State\",\n      children: /*#__PURE__*/_jsx(RadioButtonGroup, {\n        options: stateOptions,\n        value: silenceState,\n        onChange: handleSilenceStateChange\n      })\n    }), (queryString || silenceState) && /*#__PURE__*/_jsx(\"div\", {\n      className: styles.rowChild,\n      children: /*#__PURE__*/_jsx(Button, {\n        variant: \"secondary\",\n        icon: \"times\",\n        onClick: clearFilters,\n        children: \"Clear filters\"\n      })\n    })]\n  });\n};\n\nconst getStyles = theme => ({\n  searchInput: css`\n    width: 360px;\n  `,\n  flexRow: css`\n    display: flex;\n    flex-direction: row;\n    align-items: flex-end;\n    padding-bottom: ${theme.spacing(2)};\n    border-bottom: 1px solid ${theme.colors.border.strong};\n  `,\n  rowChild: css`\n    margin-right: ${theme.spacing(1)};\n    margin-bottom: 0;\n    max-height: 52px;\n  `,\n  fieldLabel: css`\n    font-size: 12px;\n    font-weight: 500;\n  `\n});","map":{"version":3,"names":["css","debounce","uniqueId","React","useState","Stack","Label","Icon","Input","Tooltip","RadioButtonGroup","useStyles2","Button","Field","useQueryParams","SilenceState","parseMatchers","getSilenceFiltersFromUrlParams","stateOptions","Object","entries","map","key","value","label","getQueryStringKey","SilencesFilter","queryStringKey","setQueryStringKey","queryParams","setQueryParams","queryString","silenceState","styles","getStyles","handleQueryStringChange","e","target","handleSilenceStateChange","state","clearFilters","setTimeout","inputInvalid","length","flexRow","rowChild","searchInput","theme","spacing","colors","border","strong","fieldLabel"],"sources":["/home/soula/grafana/public/app/features/alerting/unified/components/silences/SilencesFilter.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport { debounce, uniqueId } from 'lodash';\nimport React, { FormEvent, useState } from 'react';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Label, Icon, Input, Tooltip, RadioButtonGroup, useStyles2, Button, Field } from '@grafana/ui';\nimport { useQueryParams } from 'app/core/hooks/useQueryParams';\nimport { SilenceState } from 'app/plugins/datasource/alertmanager/types';\n\nimport { parseMatchers } from '../../utils/alertmanager';\nimport { getSilenceFiltersFromUrlParams } from '../../utils/misc';\n\nconst stateOptions: SelectableValue[] = Object.entries(SilenceState).map(([key, value]) => ({\n  label: key,\n  value,\n}));\n\nconst getQueryStringKey = () => uniqueId('query-string-');\n\nexport const SilencesFilter = () => {\n  const [queryStringKey, setQueryStringKey] = useState(getQueryStringKey());\n  const [queryParams, setQueryParams] = useQueryParams();\n  const { queryString, silenceState } = getSilenceFiltersFromUrlParams(queryParams);\n  const styles = useStyles2(getStyles);\n\n  const handleQueryStringChange = debounce((e: FormEvent<HTMLInputElement>) => {\n    const target = e.target as HTMLInputElement;\n    setQueryParams({ queryString: target.value || null });\n  }, 400);\n\n  const handleSilenceStateChange = (state: string) => {\n    setQueryParams({ silenceState: state });\n  };\n\n  const clearFilters = () => {\n    setQueryParams({\n      queryString: null,\n      silenceState: null,\n    });\n    setTimeout(() => setQueryStringKey(getQueryStringKey()));\n  };\n\n  const inputInvalid = queryString && queryString.length > 3 ? parseMatchers(queryString).length === 0 : false;\n\n  return (\n    <div className={styles.flexRow}>\n      <Field\n        className={styles.rowChild}\n        label={\n          <Label>\n            <Stack gap={0.5}>\n              <span>Search by matchers</span>\n              <Tooltip\n                content={\n                  <div>\n                    Filter silences by matchers using a comma separated list of matchers, ie:\n                    <pre>{`severity=critical, instance=~cluster-us-.+`}</pre>\n                  </div>\n                }\n              >\n                <Icon name=\"info-circle\" size=\"sm\" />\n              </Tooltip>\n            </Stack>\n          </Label>\n        }\n        invalid={inputInvalid}\n        error={inputInvalid ? 'Query must use valid matcher syntax' : null}\n      >\n        <Input\n          key={queryStringKey}\n          className={styles.searchInput}\n          prefix={<Icon name=\"search\" />}\n          onChange={handleQueryStringChange}\n          defaultValue={queryString ?? ''}\n          placeholder=\"Search\"\n          data-testid=\"search-query-input\"\n        />\n      </Field>\n      <Field className={styles.rowChild} label=\"State\">\n        <RadioButtonGroup options={stateOptions} value={silenceState} onChange={handleSilenceStateChange} />\n      </Field>\n      {(queryString || silenceState) && (\n        <div className={styles.rowChild}>\n          <Button variant=\"secondary\" icon=\"times\" onClick={clearFilters}>\n            Clear filters\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  searchInput: css`\n    width: 360px;\n  `,\n  flexRow: css`\n    display: flex;\n    flex-direction: row;\n    align-items: flex-end;\n    padding-bottom: ${theme.spacing(2)};\n    border-bottom: 1px solid ${theme.colors.border.strong};\n  `,\n  rowChild: css`\n    margin-right: ${theme.spacing(1)};\n    margin-bottom: 0;\n    max-height: 52px;\n  `,\n  fieldLabel: css`\n    font-size: 12px;\n    font-weight: 500;\n  `,\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}